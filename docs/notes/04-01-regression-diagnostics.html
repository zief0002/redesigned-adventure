<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-08-05">

<title>EPsy 8264 - üìù Regression Diagnostics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../site_libs/kePrint/kePrint.js"></script>
<link href="../site_libs/lightable/lightable.css" rel="stylesheet">
<link href="../site_libs/pagedtable/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable/js/pagedtable.js"></script>
<script src="https://kit.fontawesome.com/e5da75ca36.js" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../assets/sticky-notes.css">
<link rel="stylesheet" href="../assets/style.css">
<link rel="stylesheet" href="../assets/notes.css">
<link rel="stylesheet" href="../assets/table-styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">EPsy 8264</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html" rel="" target="">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../assignments.html" rel="" target="">
 <span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../data.html" rel="" target="">
 <span class="menu-text">Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Instructor &amp; TA</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../mission-statements.html" rel="" target="">
 <span class="menu-text">Mission Statements</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../umn-policies.html" rel="" target="">
 <span class="menu-text">University Policies</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#effect-of-female-education-level" id="toc-effect-of-female-education-level" class="nav-link active" data-scroll-target="#effect-of-female-education-level">Effect of Female Education Level</a></li>
  <li><a href="#identifying-extreme-observations" id="toc-identifying-extreme-observations" class="nav-link" data-scroll-target="#identifying-extreme-observations">Identifying Extreme Observations</a></li>
  <li><a href="#measuring-leverage" id="toc-measuring-leverage" class="nav-link" data-scroll-target="#measuring-leverage">Measuring Leverage</a>
  <ul class="collapse">
  <li><a href="#identifying-high-leverage-observations-in-the-contraception-example" id="toc-identifying-high-leverage-observations-in-the-contraception-example" class="nav-link" data-scroll-target="#identifying-high-leverage-observations-in-the-contraception-example">Identifying High Leverage Observations in the Contraception Example</a></li>
  </ul></li>
  <li><a href="#measuring-outlyingness" id="toc-measuring-outlyingness" class="nav-link" data-scroll-target="#measuring-outlyingness">Measuring Outlyingness</a>
  <ul class="collapse">
  <li><a href="#statistical-test-for-identifying-observations-with-large-residuals" id="toc-statistical-test-for-identifying-observations-with-large-residuals" class="nav-link" data-scroll-target="#statistical-test-for-identifying-observations-with-large-residuals">Statistical Test for Identifying Observations with Large Residuals</a>
  <ul class="collapse">
  <li><a href="#computing-the-studentized-residual" id="toc-computing-the-studentized-residual" class="nav-link" data-scroll-target="#computing-the-studentized-residual">Computing the Studentized Residual</a></li>
  <li><a href="#testing-observations-for-outlyingness" id="toc-testing-observations-for-outlyingness" class="nav-link" data-scroll-target="#testing-observations-for-outlyingness">Testing Observations for Outlyingness</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#measuring-influence" id="toc-measuring-influence" class="nav-link" data-scroll-target="#measuring-influence">Measuring Influence</a>
  <ul class="collapse">
  <li><a href="#dfbetas" id="toc-dfbetas" class="nav-link" data-scroll-target="#dfbetas">DFBETAS</a></li>
  <li><a href="#cooks-distance" id="toc-cooks-distance" class="nav-link" data-scroll-target="#cooks-distance">Cook‚Äôs Distance</a></li>
  </ul></li>
  <li><a href="#one-last-diagnostic-plot" id="toc-one-last-diagnostic-plot" class="nav-link" data-scroll-target="#one-last-diagnostic-plot">One Last Diagnostic Plot</a></li>
  <li><a href="#removing-observations" id="toc-removing-observations" class="nav-link" data-scroll-target="#removing-observations">Removing Observations</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">üìù Regression Diagnostics</h1>
<p class="subtitle lead">Identifying Extreme Observations</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 5, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>In this set of notes, we will give a brief introduction to empirical diagnostics to detect extreme observations. We will use the <a href="https://raw.githubusercontent.com/zief0002/redesigned-adventure/main/data/contraception.csv">contraception.csv</a> data to evaluate the effect of female education level on contraception rates.</p>
<ul>
<li><a href="https://raw.githubusercontent.com/zief0002/redesigned-adventure/main/data/contraception.csv">[CSV]</a></li>
<li><a href="../codebooks/contraception.html">[Codebook]</a></li>
</ul>
<p>A script file for the analyses in these notes is also available:</p>
<ul>
<li><a href="https://raw.githubusercontent.com/zief0002/redesigned-adventure/main/scripts/04-01-regression-diagnostics.R">[R Script File]</a></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>contraception <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/redesigned-adventure/main/data/contraception.csv"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>contraception</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["contraceptive"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["gni"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Algeria","2":"Middle East and North Africa","3":"57","4":"5.9","5":"High"},{"1":"Austria","2":"Europe and Central Asia","3":"66","4":"8.9","5":"High"},{"1":"Azerbaijan","2":"Europe and Central Asia","3":"55","4":"10.5","5":"High"},{"1":"Bangladesh","2":"South Asia","3":"62","4":"4.6","5":"Low"},{"1":"Belgium","2":"Europe and Central Asia","3":"67","4":"10.5","5":"High"},{"1":"Belize","2":"Latin America and the Caribbean","3":"51","4":"9.2","5":"High"},{"1":"Benin","2":"Sub-Saharan Africa","3":"16","4":"2.0","5":"Low"},{"1":"Bolivia","2":"Latin America and the Caribbean","3":"67","4":"8.4","5":"Low"},{"1":"Bosnia and Herzegovina","2":"Europe and Central Asia","3":"46","4":"7.2","5":"High"},{"1":"Botswana","2":"Sub-Saharan Africa","3":"53","4":"8.7","5":"High"},{"1":"Bulgaria","2":"Europe and Central Asia","3":"69","4":"10.6","5":"High"},{"1":"Burkina Faso","2":"Sub-Saharan Africa","3":"32","4":"1.9","5":"Low"},{"1":"Burundi","2":"Sub-Saharan Africa","3":"29","4":"2.2","5":"Low"},{"1":"Cambodia","2":"East Asia and Pacific","3":"56","4":"3.2","5":"Low"},{"1":"Cameroon","2":"Sub-Saharan Africa","3":"34","4":"5.1","5":"Low"},{"1":"Canada","2":"North America","3":"85","4":"12.3","5":"High"},{"1":"Chad","2":"Sub-Saharan Africa","3":"6","4":"0.6","5":"Low"},{"1":"Chile","2":"Latin America and the Caribbean","3":"76","4":"9.6","5":"High"},{"1":"Colombia","2":"Latin America and the Caribbean","3":"81","4":"7.0","5":"High"},{"1":"Congo, Democratic Republic","2":"Sub-Saharan Africa","3":"20","4":"2.1","5":"Low"},{"1":"Costa Rica","2":"Latin America and the Caribbean","3":"78","4":"8.4","5":"High"},{"1":"Croatia","2":"Europe and Central Asia","3":"69","4":"10.5","5":"High"},{"1":"Czech Republic","2":"Europe and Central Asia","3":"86","4":"12.1","5":"High"},{"1":"Dominican Republic","2":"Latin America and the Caribbean","3":"70","4":"7.7","5":"High"},{"1":"Ecuador","2":"Latin America and the Caribbean","3":"80","4":"7.4","5":"High"},{"1":"Egypt, Arab Republic","2":"Middle East and North Africa","3":"59","4":"5.3","5":"Low"},{"1":"El Salvador","2":"Latin America and the Caribbean","3":"72","4":"6.1","5":"Low"},{"1":"Ethiopia","2":"Sub-Saharan Africa","3":"40","4":"1.4","5":"Low"},{"1":"France","2":"Europe and Central Asia","3":"78","4":"10.9","5":"High"},{"1":"Ghana","2":"Sub-Saharan Africa","3":"31","4":"5.9","5":"Low"},{"1":"Greece","2":"Europe and Central Asia","3":"76","4":"9.9","5":"High"},{"1":"Guinea","2":"Sub-Saharan Africa","3":"9","4":"0.8","5":"Low"},{"1":"Haiti","2":"Latin America and the Caribbean","3":"34","4":"3.2","5":"Low"},{"1":"Honduras","2":"Latin America and the Caribbean","3":"73","4":"5.3","5":"Low"},{"1":"Hungary","2":"Europe and Central Asia","3":"62","4":"11.2","5":"High"},{"1":"India","2":"South Asia","3":"54","4":"3.2","5":"Low"},{"1":"Indonesia","2":"East Asia and Pacific","3":"61","4":"6.9","5":"Low"},{"1":"Iraq","2":"Middle East and North Africa","3":"53","4":"4.4","5":"High"},{"1":"Italy","2":"Europe and Central Asia","3":"65","4":"9.7","5":"High"},{"1":"Jamaica","2":"Latin America and the Caribbean","3":"73","4":"9.8","5":"High"},{"1":"Japan","2":"East Asia and Pacific","3":"40","4":"11.2","5":"High"},{"1":"Jordan","2":"Middle East and North Africa","3":"52","4":"9.4","5":"High"},{"1":"Kazakhstan","2":"Europe and Central Asia","3":"55","4":"10.2","5":"High"},{"1":"Kenya","2":"Sub-Saharan Africa","3":"61","4":"5.4","5":"Low"},{"1":"Korea, Republic","2":"East Asia and Pacific","3":"80","4":"11.1","5":"High"},{"1":"Lao PDR","2":"East Asia and Pacific","3":"54","4":"3.8","5":"Low"},{"1":"Lebanon","2":"Middle East and North Africa","3":"55","4":"7.6","5":"High"},{"1":"Lesotho","2":"Sub-Saharan Africa","3":"60","4":"6.8","5":"Low"},{"1":"Liberia","2":"Sub-Saharan Africa","3":"31","4":"2.3","5":"Low"},{"1":"Madagascar","2":"Sub-Saharan Africa","3":"48","4":"4.8","5":"Low"},{"1":"Malawi","2":"Sub-Saharan Africa","3":"59","4":"3.4","5":"Low"},{"1":"Malaysia","2":"East Asia and Pacific","3":"52","4":"9.2","5":"High"},{"1":"Maldives","2":"South Asia","3":"19","4":"5.4","5":"High"},{"1":"Mali","2":"Sub-Saharan Africa","3":"16","4":"1.4","5":"Low"},{"1":"Malta","2":"Middle East and North Africa","3":"86","4":"9.5","5":"High"},{"1":"Mauritius","2":"Sub-Saharan Africa","3":"64","4":"8.0","5":"High"},{"1":"Mexico","2":"Latin America and the Caribbean","3":"67","4":"8.1","5":"High"},{"1":"Moldova","2":"Europe and Central Asia","3":"60","4":"9.6","5":"Low"},{"1":"Mongolia","2":"East Asia and Pacific","3":"55","4":"8.5","5":"Low"},{"1":"Morocco","2":"Middle East and North Africa","3":"71","4":"3.2","5":"Low"},{"1":"Mozambique","2":"Sub-Saharan Africa","3":"27","4":"0.8","5":"Low"},{"1":"Namibia","2":"Sub-Saharan Africa","3":"56","4":"6.3","5":"High"},{"1":"Nepal","2":"South Asia","3":"53","4":"2.4","5":"Low"},{"1":"Nicaragua","2":"Latin America and the Caribbean","3":"80","4":"4.8","5":"Low"},{"1":"Niger","2":"Sub-Saharan Africa","3":"11","4":"0.8","5":"Low"},{"1":"Nigeria","2":"Sub-Saharan Africa","3":"28","4":"4.2","5":"Low"},{"1":"Pakistan","2":"South Asia","3":"34","4":"3.3","5":"Low"},{"1":"Panama","2":"Latin America and the Caribbean","3":"63","4":"9.6","5":"High"},{"1":"Paraguay","2":"Latin America and the Caribbean","3":"68","4":"7.5","5":"High"},{"1":"Philippines","2":"East Asia and Pacific","3":"54","4":"8.8","5":"Low"},{"1":"Portugal","2":"Europe and Central Asia","3":"74","4":"8.0","5":"High"},{"1":"Romania","2":"Europe and Central Asia","3":"70","4":"10.4","5":"High"},{"1":"Rwanda","2":"Sub-Saharan Africa","3":"53","4":"3.1","5":"Low"},{"1":"Sao Tome and Principe","2":"Sub-Saharan Africa","3":"41","4":"4.0","5":"Low"},{"1":"Senegal","2":"Sub-Saharan Africa","3":"28","4":"3.4","5":"Low"},{"1":"Serbia","2":"Europe and Central Asia","3":"58","4":"9.2","5":"High"},{"1":"Sierra Leone","2":"Sub-Saharan Africa","3":"23","4":"2.0","5":"Low"},{"1":"Slovak Republic","2":"Europe and Central Asia","3":"80","4":"11.6","5":"High"},{"1":"Slovenia","2":"Europe and Central Asia","3":"79","4":"11.8","5":"High"},{"1":"South Africa","2":"Sub-Saharan Africa","3":"55","4":"9.8","5":"High"},{"1":"Spain","2":"Europe and Central Asia","3":"71","4":"9.5","5":"High"},{"1":"Suriname","2":"Latin America and the Caribbean","3":"48","4":"7.3","5":"High"},{"1":"Swaziland","2":"Sub-Saharan Africa","3":"66","4":"7.4","5":"Low"},{"1":"Tajikistan","2":"Europe and Central Asia","3":"29","4":"10.0","5":"Low"},{"1":"Tanzania","2":"Sub-Saharan Africa","3":"38","4":"4.5","5":"Low"},{"1":"Thailand","2":"East Asia and Pacific","3":"78","4":"7.0","5":"High"},{"1":"Togo","2":"Sub-Saharan Africa","3":"20","4":"3.3","5":"Low"},{"1":"Tunisia","2":"Middle East and North Africa","3":"63","4":"5.5","5":"Low"},{"1":"Uganda","2":"Sub-Saharan Africa","3":"42","4":"4.3","5":"Low"},{"1":"Ukraine","2":"Europe and Central Asia","3":"65","4":"11.2","5":"Low"},{"1":"United Kingdom","2":"Europe and Central Asia","3":"84","4":"12.8","5":"High"},{"1":"Uruguay","2":"Latin America and the Caribbean","3":"80","4":"8.7","5":"High"},{"1":"Venezuela, RB","2":"Latin America and the Caribbean","3":"75","4":"8.7","5":"High"},{"1":"Vietnam","2":"East Asia and Pacific","3":"76","4":"5.2","5":"Low"},{"1":"Yemen, Republic","2":"Middle East and North Africa","3":"34","4":"1.2","5":"Low"},{"1":"Zambia","2":"Sub-Saharan Africa","3":"49","4":"5.8","5":"Low"},{"1":"Zimbabwe","2":"Sub-Saharan Africa","3":"67","4":"6.7","5":"Low"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><br></p>
<section id="effect-of-female-education-level" class="level1">
<h1>Effect of Female Education Level</h1>
<p>To evaluate the effect of female education level on contraception rates, we need to fit a model that includes that effect. Since we know that a country‚Äôs wealth also has an impact on contraception rates, we also want to include that effect, which is measured by GNI, in the model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dummy variable for GNI indicator and single letter variable</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>contraception <span class="ot">=</span> contraception <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">high_gni =</span> <span class="fu">if_else</span>(gni <span class="sc">==</span> <span class="st">"High"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">gni2 =</span> <span class="fu">str_sub</span>(contraception<span class="sc">$</span>gni, <span class="at">start =</span> 1L, <span class="at">end =</span> 1L)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will then examine a scatterplot of the data to determine whether we should fit a main effects or interaction model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> contraception, <span class="fu">aes</span>(<span class="at">x =</span> educ_female, <span class="at">y =</span> contraceptive, <span class="at">color =</span> gni2)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> gni2)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Female education level"</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Contraceptive rate"</span>) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  ggsci<span class="sc">::</span><span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>This plot suggests that the effect of female education level may differ for low and high wealth countries. This suggests that we may want to fit an intewraction model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit interaction model</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(contraceptive <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> educ_female <span class="sc">+</span> high_gni <span class="sc">+</span> educ_female<span class="sc">:</span>high_gni, <span class="at">data =</span> contraception)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level information</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0.4966554","2":"0.4804185","3":"14.40447","4":"30.58803","5":"7.568139e-14","6":"3","7":"-394.3459","8":"798.6917","9":"811.5653","10":"19296.45","11":"93","12":"97"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level information</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm<span class="fl">.1</span>, <span class="at">conf.int =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"25.093822","3":"4.0606266","4":"6.1797904","5":"0.00000001683065","6":"17.030222","7":"33.157422"},{"1":"educ_female","2":"4.526619","3":"0.7979735","4":"5.6726438","5":"0.00000015791484","6":"2.942002","7":"6.111236"},{"1":"high_gni","2":"11.703076","3":"11.3855645","4":"1.0278872","5":"0.30666890740928","6":"-10.906399","7":"34.312551"},{"1":"educ_female:high_gni","2":"-1.329906","3":"1.3906549","4":"-0.9563162","5":"0.34139185290995","6":"-4.091471","7":"1.431659"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The model explains 49.7% of the variation in contraception rates, <span class="math inline">\(F(3, 97) = 30.6\)</span>, <span class="math inline">\(p&lt;.001\)</span>. Examining the coefficient-level output, the interaction term is not statistically significant, <span class="math inline">\(p=0.341\)</span>, indicating that there may not be an interaction between female education level and wealth on contraception.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Augment model</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>out_1 <span class="ot">=</span> <span class="fu">augment</span>(lm<span class="fl">.1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View augmented data</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>out_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"57","2":"5.9","3":"1","4":"55.65751","5":"1.34249276","6":"0.08752664","7":"14.48180","8":"0.00022828080037","9":"0.09756739"},{"1":"66","2":"8.9","3":"1","4":"65.24765","5":"0.75235237","6":"0.02168413","7":"14.48232","8":"0.00001545155047","9":"0.05280616"},{"1":"55","2":"10.5","3":"1","4":"70.36239","5":"-15.36238917","6":"0.03258073","7":"14.39070","8":"0.00989907365212","9":"-1.08431187"},{"1":"62","2":"4.6","3":"0","4":"45.91627","5":"16.08372937","6":"0.02012031","7":"14.38313","8":"0.00653143149216","9":"1.12798466"},{"1":"67","2":"10.5","3":"1","4":"70.36239","5":"-3.36238917","6":"0.03258073","7":"14.47815","8":"0.00047421248672","9":"-0.23732496"},{"1":"51","2":"9.2","3":"1","4":"66.20666","5":"-15.20666167","6":"0.02128908","7":"14.39360","8":"0.00619243355779","9":"-1.06711071"},{"1":"16","2":"2.0","3":"0","4":"34.14706","5":"-18.14706039","6":"0.03770633","7":"14.35354","8":"0.01615686917694","9":"-1.28426688"},{"1":"67","2":"8.4","3":"0","4":"63.11742","5":"3.88257596","6":"0.06905329","7":"14.47646","8":"0.00144717241198","9":"0.27935752"},{"1":"46","2":"7.2","3":"1","4":"59.81323","5":"-13.81323474","6":"0.04517860","7":"14.40735","8":"0.01139265369220","9":"-0.98137984"},{"1":"53","2":"8.7","3":"1","4":"64.60830","5":"-11.60830493","6":"0.02257267","7":"14.43071","8":"0.00383616506057","9":"-0.81513470"},{"1":"69","2":"10.6","3":"1","4":"70.68206","5":"-1.68206051","6":"0.03432456","7":"14.48144","8":"0.00012547913178","9":"-0.11883075"},{"1":"32","2":"1.9","3":"0","4":"33.69440","5":"-1.69439846","6":"0.03921132","7":"14.48142","8":"0.00014693742085","9":"-0.12000640"},{"1":"29","2":"2.2","3":"0","4":"35.05238","5":"-6.05238426","6":"0.03488049","7":"14.46829","8":"0.00165279496671","9":"-0.42769952"},{"1":"56","2":"3.2","3":"0","4":"39.57900","5":"16.42099642","6":"0.02443396","7":"14.37844","8":"0.00834113411826","9":"1.15418117"},{"1":"34","2":"5.1","3":"0","4":"48.17958","5":"-14.17958029","6":"0.02149518","7":"14.40523","8":"0.00543860514842","9":"-0.99514120"},{"1":"85","2":"12.3","3":"1","4":"76.11647","5":"8.88352660","6":"0.08309989","7":"14.45021","8":"0.00939880980238","9":"0.64406131"},{"1":"6","2":"0.6","3":"0","4":"27.80979","5":"-21.80979335","6":"0.06436156","7":"14.29049","8":"0.04213656736991","9":"-1.56530991"},{"1":"76","2":"9.6","3":"1","4":"67.48535","5":"8.51465295","6":"0.02251282","7":"14.45468","8":"0.00205819830913","9":"0.59788028"},{"1":"81","2":"7.0","3":"1","4":"59.17389","5":"21.82610795","6":"0.05031831","7":"14.29306","8":"0.03202344910366","9":"1.55485566"},{"1":"20","2":"2.1","3":"0","4":"34.59972","5":"-14.59972233","6":"0.03626272","7":"14.39930","8":"0.01002715861298","9":"-1.03244775"},{"1":"78","2":"8.4","3":"1","4":"63.64929","5":"14.35070910","6":"0.02484324","7":"14.40307","8":"0.00648263772796","9":"1.00887871"},{"1":"69","2":"10.5","3":"1","4":"70.36239","5":"-1.36238917","6":"0.03258073","7":"14.48182","8":"0.00007785372425","9":"-0.09616048"},{"1":"86","2":"12.1","3":"1","4":"75.47713","5":"10.52286930","6":"0.07548610","7":"14.43752","8":"0.01178295211681","9":"0.75976672"},{"1":"70","2":"7.7","3":"1","4":"61.41159","5":"8.58840853","6":"0.03451743","7":"14.45384","8":"0.00329094527618","9":"0.60679681"},{"1":"80","2":"7.4","3":"1","4":"60.45258","5":"19.54742257","6":"0.04053903","7":"14.33231","8":"0.02027418356292","9":"1.38541109"},{"1":"59","2":"5.3","3":"0","4":"49.08490","5":"9.91509585","6":"0.02247477","7":"14.44475","8":"0.00278598528738","9":"0.69620276"},{"1":"72","2":"6.1","3":"0","4":"52.70620","5":"19.29380040","6":"0.02884826","7":"14.33798","8":"0.01371913246726","9":"1.35918023"},{"1":"40","2":"1.4","3":"0","4":"31.43109","5":"8.56891120","6":"0.04765693","7":"14.45358","8":"0.00464874899240","9":"0.60958145"},{"1":"78","2":"10.9","3":"1","4":"71.64107","5":"6.35892545","6":"0.04030625","7":"14.46672","8":"0.00213216206873","9":"0.45063012"},{"1":"31","2":"5.9","3":"0","4":"51.80088","5":"-20.80087574","6":"0.02688662","7":"14.31471","8":"0.01480192536888","9":"-1.46387068"},{"1":"76","2":"9.9","3":"1","4":"68.44436","5":"7.55563891","6":"0.02474348","7":"14.46056","8":"0.00178941505069","9":"0.53114681"},{"1":"9","2":"0.8","3":"0","4":"28.71512","5":"-19.71511721","6":"0.05981713","7":"14.32656","8":"0.03169168064474","9":"-1.41154917"},{"1":"34","2":"3.2","3":"0","4":"39.57900","5":"-5.57900358","6":"0.02443396","7":"14.47056","8":"0.00096280729288","9":"-0.39213095"},{"1":"73","2":"5.3","3":"0","4":"49.08490","5":"23.91509585","6":"0.02247477","7":"14.26129","8":"0.01620799284848","9":"1.67923297"},{"1":"62","2":"11.2","3":"1","4":"72.60009","5":"-10.60008859","6":"0.04741325","7":"14.43821","8":"0.00707384144150","9":"-0.75398037"},{"1":"54","2":"3.2","3":"0","4":"39.57900","5":"14.42099642","6":"0.02443396","7":"14.40232","8":"0.00643304559603","9":"1.01360734"},{"1":"61","2":"6.9","3":"0","4":"56.32750","5":"4.67250494","6":"0.03914994","7":"14.47401","8":"0.00111548832238","9":"0.33092134"},{"1":"53","2":"4.4","3":"1","4":"50.86244","5":"2.13756295","6":"0.16264695","7":"14.48049","8":"0.00127706254622","9":"0.16216884"},{"1":"65","2":"9.7","3":"1","4":"67.80502","5":"-2.80501840","6":"0.02313134","7":"14.47952","8":"0.00022979757128","9":"-0.19702459"},{"1":"73","2":"9.8","3":"1","4":"68.12469","5":"4.87531026","6":"0.02387489","7":"14.47340","8":"0.00071759695643","9":"0.34257237"},{"1":"40","2":"11.2","3":"1","4":"72.60009","5":"-32.60008859","6":"0.04741325","7":"14.05764","8":"0.06690735966056","9":"-2.31883222"},{"1":"52","2":"9.4","3":"1","4":"66.84600","5":"-14.84600436","6":"0.02165088","7":"14.39775","8":"0.00600693030058","9":"-1.04199460"},{"1":"55","2":"10.2","3":"1","4":"69.40338","5":"-14.40337513","6":"0.02809945","7":"14.40222","8":"0.00743581179799","9":"-1.01427605"},{"1":"61","2":"5.4","3":"0","4":"49.53757","5":"11.46243392","6":"0.02305664","7":"14.43198","8":"0.00382433987328","9":"0.80509099"},{"1":"80","2":"11.1","3":"1","4":"72.28042","5":"7.71958276","6":"0.04491922","7":"14.45911","8":"0.00353578041483","9":"0.54837366"},{"1":"54","2":"3.8","3":"0","4":"42.29498","5":"11.70502483","6":"0.02111218","7":"14.42992","8":"0.00363711949810","9":"0.82131299"},{"1":"55","2":"7.6","3":"1","4":"61.09192","5":"-6.09192013","6":"0.03639960","7":"14.46808","8":"0.00175289818200","9":"-0.43083257"},{"1":"60","2":"6.8","3":"0","4":"55.87483","5":"4.12516687","6":"0.03764741","7":"14.47590","8":"0.00083348023442","9":"0.29192899"},{"1":"31","2":"2.3","3":"0","4":"35.50505","5":"-4.50504619","6":"0.03355963","7":"14.47466","8":"0.00087864051525","9":"-0.31813726"},{"1":"48","2":"4.8","3":"0","4":"46.82159","5":"1.17840551","6":"0.02048613","7":"14.48201","8":"0.00003572513002","9":"0.08265941"},{"1":"59","2":"3.4","3":"0","4":"40.48433","5":"18.51567256","6":"0.02308119","7":"14.35024","8":"0.00999000725509","9":"1.30050812"},{"1":"52","2":"9.2","3":"1","4":"66.20666","5":"-14.20666167","6":"0.02128908","7":"14.40495","8":"0.00540477556255","9":"-0.99693682"},{"1":"19","2":"5.4","3":"1","4":"54.05915","5":"-35.05915051","6":"0.10944088","7":"13.95499","8":"0.20436310851133","9":"-2.57912758"},{"1":"16","2":"1.4","3":"0","4":"31.43109","5":"-15.43108880","6":"0.04765693","7":"14.38841","8":"0.01507571622679","9":"-1.09774804"},{"1":"86","2":"9.5","3":"1","4":"67.16568","5":"18.83432430","6":"0.02201933","7":"14.34578","8":"0.00983986812606","9":"1.32217129"},{"1":"64","2":"8.0","3":"1","4":"62.37061","5":"1.62939449","6":"0.02962115","7":"14.48151","8":"0.00010062765093","9":"0.11483080"},{"1":"67","2":"8.1","3":"1","4":"62.69028","5":"4.30972314","6":"0.02823912","7":"14.47537","8":"0.00066923199307","9":"0.30350963"},{"1":"60","2":"9.6","3":"0","4":"68.54937","5":"-8.54936722","6":"0.10291920","7":"14.45193","8":"0.01126281231586","9":"-0.62664417"},{"1":"55","2":"8.5","3":"0","4":"63.57009","5":"-8.57008597","6":"0.07153787","7":"14.45282","8":"0.00734384659740","9":"-0.61745583"},{"1":"71","2":"3.2","3":"0","4":"39.57900","5":"31.42099642","6":"0.02443396","7":"14.09766","8":"0.03053978659046","9":"2.20848488"},{"1":"27","2":"0.8","3":"0","4":"28.71512","5":"-1.71511721","6":"0.05981713","7":"14.48137","8":"0.00023984692449","9":"-0.12279776"},{"1":"56","2":"6.3","3":"1","4":"56.93619","5":"-0.93619263","6":"0.07224585","7":"14.48219","8":"0.00008863866274","9":"-0.06747635"},{"1":"53","2":"2.4","3":"0","4":"35.95771","5":"17.04229188","6":"0.03230016","7":"14.36947","8":"0.01207049109980","9":"1.20270877"},{"1":"80","2":"4.8","3":"0","4":"46.82159","5":"33.17840551","6":"0.02048613","7":"14.05448","8":"0.02832013440911","9":"2.32730353"},{"1":"11","2":"0.8","3":"0","4":"28.71512","5":"-17.71511721","6":"0.05981713","7":"14.35673","8":"0.02558789762288","9":"-1.26835457"},{"1":"28","2":"4.2","3":"0","4":"44.10562","5":"-16.10562290","6":"0.02012522","7":"14.38286","8":"0.00655088899947","9":"-1.12952293"},{"1":"34","2":"3.3","3":"0","4":"40.03167","5":"-6.03166551","6":"0.02372688","7":"14.46855","8":"0.00109123467663","9":"-0.42379360"},{"1":"63","2":"9.6","3":"1","4":"67.48535","5":"-4.48534705","6":"0.02251282","7":"14.47481","8":"0.00057114373643","9":"-0.31495125"},{"1":"68","2":"7.5","3":"1","4":"60.77225","5":"7.22775122","6":"0.03840680","7":"14.46214","8":"0.00261443202998","9":"0.51169399"},{"1":"54","2":"8.8","3":"0","4":"64.92807","5":"-10.92807177","6":"0.07935988","7":"14.43378","8":"0.01347267713365","9":"-0.79068118"},{"1":"74","2":"8.0","3":"1","4":"62.37061","5":"11.62939449","6":"0.02962115","7":"14.43014","8":"0.00512600533948","9":"0.81957604"},{"1":"70","2":"10.4","3":"1","4":"70.04272","5":"-0.04271782","6":"0.03096194","7":"14.48254","8":"0.00000007249537","9":"-0.00301260"},{"1":"53","2":"3.1","3":"0","4":"39.12634","5":"13.87365835","6":"0.02520241","7":"14.40825","8":"0.00615093010969","9":"0.97552092"},{"1":"41","2":"4.0","3":"0","4":"43.20030","5":"-2.20029903","6":"0.02049595","7":"14.48069","8":"0.00012461334433","9":"-0.15434103"},{"1":"28","2":"3.4","3":"0","4":"40.48433","5":"-12.48432744","6":"0.02308119","7":"14.42255","8":"0.00454168617516","9":"-0.87687710"},{"1":"58","2":"9.2","3":"1","4":"66.20666","5":"-8.20666167","6":"0.02128908","7":"14.45669","8":"0.00180354360596","9":"-0.57589343"},{"1":"23","2":"2.0","3":"0","4":"34.14706","5":"-11.14706039","6":"0.03770633","7":"14.43400","8":"0.00609628620135","9":"-0.78887711"},{"1":"80","2":"11.6","3":"1","4":"73.87877","5":"6.12122603","6":"0.05863973","7":"14.46760","8":"0.00298746435564","9":"0.43798910"},{"1":"79","2":"11.8","3":"1","4":"74.51812","5":"4.48188334","6":"0.06500318","7":"14.47448","8":"0.00179962103197","9":"0.32177944"},{"1":"55","2":"9.8","3":"1","4":"68.12469","5":"-13.12468974","6":"0.02387489","7":"14.41617","8":"0.00520060850698","9":"-0.92222973"},{"1":"71","2":"9.5","3":"1","4":"67.16568","5":"3.83432430","6":"0.02201933","7":"14.47690","8":"0.00040781845317","9":"0.26916992"},{"1":"48","2":"7.3","3":"1","4":"60.13291","5":"-12.13290609","6":"0.04279630","7":"14.42471","8":"0.00828462341030","9":"-0.86092529"},{"1":"66","2":"7.4","3":"0","4":"58.59080","5":"7.40919528","6":"0.04758327","7":"14.46089","8":"0.00346966865618","9":"0.52706035"},{"1":"29","2":"10.0","3":"0","4":"70.36001","5":"-41.36001495","6":"0.11617193","7":"13.73703","8":"0.30652975079693","9":"-3.05421500"},{"1":"38","2":"4.5","3":"0","4":"45.46361","5":"-7.46360869","6":"0.02002947","7":"14.46119","8":"0.00139986730463","9":"-0.52341380"},{"1":"78","2":"7.0","3":"1","4":"59.17389","5":"18.82610795","6":"0.05031831","7":"14.34181","8":"0.02382520233611","9":"1.34114065"},{"1":"20","2":"3.3","3":"0","4":"40.03167","5":"-20.03166551","6":"0.02372688","7":"14.32747","8":"0.01203587805388","9":"-1.40745400"},{"1":"63","2":"5.5","3":"0","4":"49.99023","5":"13.00977199","6":"0.02369988","7":"14.41734","8":"0.00507065893877","9":"0.91407289"},{"1":"42","2":"4.3","3":"0","4":"44.55828","5":"-2.55828483","6":"0.02003193","7":"14.48003","8":"0.00016449107696","9":"-0.17940963"},{"1":"65","2":"11.2","3":"0","4":"75.79196","5":"-10.79195814","6":"0.16182241","7":"14.43030","8":"0.03232307841633","9":"-0.81834238"},{"1":"84","2":"12.8","3":"1","4":"77.71483","5":"6.28516987","6":"0.10432246","7":"14.46598","8":"0.00618947954389","9":"0.46104572"},{"1":"80","2":"8.7","3":"1","4":"64.60830","5":"15.39169507","6":"0.02257267","7":"14.39130","8":"0.00674423308034","9":"1.08080421"},{"1":"75","2":"8.7","3":"1","4":"64.60830","5":"10.39169507","6":"0.02257267","7":"14.44102","8":"0.00307420240687","9":"0.72970441"},{"1":"76","2":"5.2","3":"0","4":"48.63224","5":"27.36775778","6":"0.02195429","7":"14.19225","8":"0.02071214603456","9":"1.92115522"},{"1":"34","2":"1.2","3":"0","4":"30.52576","5":"3.47423506","6":"0.05146482","7":"14.47776","8":"0.00083189318997","9":"0.24764827"},{"1":"49","2":"5.8","3":"0","4":"51.34821","5":"-2.34821381","6":"0.02599787","7":"14.48042","8":"0.00018207018207","9":"-0.16518115"},{"1":"67","2":"6.7","3":"0","4":"55.42217","5":"11.57782880","6":"0.03620625","7":"14.43025","8":"0.00629528280894","9":"0.81872469"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual Plots</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> out_1, <span class="fu">aes</span>(<span class="at">x =</span> .resid)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  educate<span class="sc">::</span><span class="fu">stat_density_confidence</span>(<span class="at">model =</span> <span class="st">"normal"</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Residuals"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> out_1, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Fitted values"</span>) <span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Residuals"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The model‚Äôs residuals do not seem to be consistent with the assumption of normality. Moreover, the assumption of homoskedasticity also seems to be violated, with the plot of the residuals versus the fitted values indicating increased variation in the residuals at higher fitted values. One question is whether the assumption violation is due to one or more extreme observations. For example, the three observations (54.1, -35.1), (70.4, -41.4) and (72.6, -32.6) all have extreme negative residuals. There are also a couple of observations that may have extreme positive residuals.</p>
<p><br></p>
</section>
<section id="identifying-extreme-observations" class="level1">
<h1>Identifying Extreme Observations</h1>
<p>In a regression analysis, there are several ways in which an observation may be extreme. The figure below shows three different ways in which an observation may be extreme.</p>
<div class="cell" data-layout-align="center" data-hash="04-01-regression-diagnostics_cache/html/unnamed-chunk-7_e793c7dab20536f33f6ceccbda17a55d">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Three different ways in which an observation may be extreme. The greenish observation is the extreme observation. The regression line is also displayed for the observations.</figcaption>
</figure>
</div>
</div>
</div>
<p>In Panel (a), the extreme observation has a large residual, but it‚Äôs <em>x</em>-value is similar to the <em>x</em>-values of the other observations. In Panel (b), the extreme observation has a large <em>x</em>-value relative to the other observations‚Äô <em>x</em>-values, but it does not have a large residual. In Panel (c), the extreme observation has both a large <em>x</em>-value relative to the other observations‚Äô <em>x</em>-values, and a large residual.</p>
<p>When an observation has a large residual relative to the other observations we call it a <em>regression outlier</em>. That is, a regression outlier has an unusual outcome value given its predictor values. As such, we might identify the extreme observation in Panels (a) and (c) as regression outliers, while the extreme observations in Panel (b) would likely not be identified as a regression outlier. We identify extreme observations in the <em>x</em>-direction as having <em>high leverage</em>. Leverage is simply a measure of how far away an observation is from from the mean value in the predictor space. So the extreme observations in Panels (b) and (c) would have high leverage, whereas the extreme observation in Panel (a) would have low leverage.</p>
<p>With extreme observations, we worry about whether the regression coefficients, and thus the line, will be impacted. You can see how the regression line changes for each of these three types of extreme observation in the plot below.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-8-1.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Three different ways in which an observation may be extreme. The greenish observation is the extreme observation. The regression line is also displayed for the observations. The animation shows how the regression line changes as a result of removing the extreme observation.</figcaption>
</figure>
</div>
</div>
</div>
<p>In Panels (a) and (b) removing the extreme observation did not have much of an effect on the regression line. In contrast, removing the extreme observation from Panel (c) resulted in a big change in the regression line. We would say that the extreme observation in Panel (c) is an <em>influential</em> observation‚Äîit influenced the location of the regression line (i.e., it influenced the coefficients). The extreme observations in Panels (a) and (b), on the other hand, are not influential observations. Importantly, observations can be extreme without impacting the regression coefficients. It is the influential observations that are problematic, since they can have a large impact on understanding the effects of the different predictors.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Properties of the extreme observations in terms of whether they are a regression outlier, the amount of leverage, and whether they influence the regression coefficients. </caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Panel</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Regression Outlier</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Leverage</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Influential</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(a)</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Low</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">(b)</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">High</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(c)</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">High</td>
<td style="text-align: left;">Yes</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>From this table, we can see that it is the combination of leverage with being a regression outlier that produces influence on the regression coefficients. Heuristically,</p>
<p><span class="math display">\[
\mathrm{Influence} = \mathrm{Leverage} \times \mathrm{Outlyingness}
\]</span></p>
<p>In the next sections, we will look at different measures used by statisticians and applied scientists to quantify these properties for the observations in a data set.</p>
<p><br></p>
</section>
<section id="measuring-leverage" class="level1">
<h1>Measuring Leverage</h1>
<p>Leverage is simply a measure of how far away an observation is from from the mean value in the predictor space.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To measure the leverage of an observation, we compute $h_{ii}, which is referred to as a <em>hat-value</em>. The hat-values are the diagonal elements of the <strong>H</strong> matrix where,</p>
<p><span class="math display">\[
\mathbf{H} = \mathbf{X}(\mathbf{X}^\intercal\mathbf{X})^{-1}\mathbf{X}^\intercal
\]</span></p>
<p>Recall that this matrix was referred to as the hat-matrix since we could express the predicted values (<span class="math inline">\(\hat{y}_i\)</span>) as a function of the hat-matrix, namely,</p>
<p><span class="math display">\[
\hat{\mathbf{Y}} = \mathbf{HY}
\]</span></p>
<p>Writing this out,</p>
<p><span class="math display">\[
\begin{bmatrix} \hat{y}_1 \\ \hat{y}_2 \\\hat{y}_3 \\ \vdots \\ \hat{y}_n \end{bmatrix} = \begin{bmatrix} \hat{h}_{11} &amp; \hat{h}_{12} &amp; \hat{h}_{13} &amp; \ldots &amp; \hat{h}_{1n}\\ \hat{h}_{21} &amp; \hat{h}_{22} &amp; \hat{h}_{23} &amp; \ldots &amp; \hat{h}_{2n} \\ \hat{h}_{31} &amp; \hat{h}_{32} &amp; \hat{h}_{33} &amp; \ldots &amp; \hat{h}_{3n} \\ \vdots \\ \hat{h}_{n1} &amp; \hat{h}_{n2} &amp; \hat{h}_{n3} &amp; \ldots &amp; \hat{h}_{nn} \end{bmatrix} \begin{bmatrix} y_1 \\ y_2 \\ y_3 \\ \vdots \\ y_n \end{bmatrix}
\]</span></p>
<p>This means we can compute the fitted value for the <em>i</em>th observation, <span class="math inline">\(\hat{y}_i\)</span>, as:</p>
<p><span class="math display">\[
\hat{y}_i = h_{i1}(y_1) + h_{i2}(y_2) + h_{i3}(y_3) + \ldots + h_{in}(y_n)
\]</span></p>
<p>Each fitted value is a weighted combination of the outcome values, where the weights are the <span class="math inline">\(h_{ij}\)</span> values. That is, the weight is a measure of how much each outcome value is contributing to the fitted value. For example if <span class="math inline">\(h_{ij}\)</span> is large, it would indicate that <span class="math inline">\(y_i\)</span> has a large impact on the value of <span class="math inline">\(\hat{y}_i\)</span>. It turns out that mathematically,</p>
<p><span class="math display">\[
h_{ii} = \sum_{j=1}^n h_{ij}^2
\]</span></p>
<p>That is, the values on the diagonal of the hat-matrix (the hat-values) are a summary of the contribution of all the outcome values on <span class="math inline">\(y_i\)</span>. Because of this, we can use <span class="math inline">\(h_{ii}\)</span> as a measure of leverage for the <em>i</em>th observation. Below, we the data from the observations used in the earlier Panel (b) to compute leverage values.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.00","2":"2.0"},{"1":"2.00","2":"1.8"},{"1":"2.04","2":"2.9"},{"1":"3.00","2":"2.2"},{"1":"3.03","2":"3.6"},{"1":"4.00","2":"3.0"},{"1":"15.00","2":"7.0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create X-matrix</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="dv">1</span>, <span class="fl">2.0</span>, <span class="fl">2.04</span>, <span class="fl">3.0</span>, <span class="fl">3.03</span>, <span class="dv">4</span>, <span class="dv">15</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">7</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and view H-matrix</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>H <span class="ot">=</span> X <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>H</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]        [,2]        [,3]       [,4]       [,5]      [,6]
[1,]  0.2209034  0.19722229  0.19627505 0.17354115 0.17283071 0.1498600
[2,]  0.1972223  0.18072658  0.18006675 0.16423087 0.16373600 0.1477352
[3,]  0.1962750  0.18006675  0.17941842 0.16385846 0.16337221 0.1476502
[4,]  0.1735411  0.16423087  0.16385846 0.15492060 0.15464129 0.1456103
[5,]  0.1728307  0.16373600  0.16337221 0.15464129 0.15436845 0.1455466
[6,]  0.1498600  0.14773516  0.14765017 0.14561032 0.14554658 0.1434855
[7,] -0.1106326 -0.03371767 -0.03064107 0.04319731 0.04550476 0.1201123
            [,7]
[1,] -0.11063264
[2,] -0.03371767
[3,] -0.03064107
[4,]  0.04319731
[5,]  0.04550476
[6,]  0.12011229
[7,]  0.96617702</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show that h_ii = sum(h_ij^2)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute sum of all the squared values in row 1</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(H[<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>] <span class="sc">^</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2209034</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the h_ii element in row 1</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>H[<span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2209034</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the hat-values</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(H)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2209034 0.1807266 0.1794184 0.1549206 0.1543684 0.1434855 0.9661770</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["h_ii"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.00","2":"2.0","3":"0.2209034"},{"1":"2.00","2":"1.8","3":"0.1807266"},{"1":"2.04","2":"2.9","3":"0.1794184"},{"1":"3.00","2":"2.2","3":"0.1549206"},{"1":"3.03","2":"3.6","3":"0.1543684"},{"1":"4.00","2":"3.0","3":"0.1434855"},{"1":"15.00","2":"7.0","3":"0.9661770"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>From these values we can see that the first six observations have pretty similar hat-values while the 7th observation (the extreme observation) has a large hat value compared to the others. This is reasonably easy to see when there are only seven observations, but becomes difficult to identify when looking at the hat-values in larger data sets. One tool for identifying large hat-values is to create an <em>index plot</em> of the leverage values. An index plot simply graphs some measure (in this case the hat-values) versus the case value of each observation. Below is the syntax and resulting index plot of the hat-values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data to plot from</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">case =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">h_ii =</span> <span class="fu">diag</span>(H)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View d</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">

<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["case"],"name":[1],"type":["int"],"align":["right"]},{"label":["h_ii"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0.2209034"},{"1":"2","2":"0.1807266"},{"1":"3","2":"0.1794184"},{"1":"4","2":"0.1549206"},{"1":"5","2":"0.1543684"},{"1":"6","2":"0.1434855"},{"1":"7","2":"0.9661770"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Index plot of the leverage values for the 7 cases displayed in Panel (b).</p>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create index plot</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> case, <span class="at">y =</span> h_ii)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Observation number"</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Leverage value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Index plot of the leverage values for the 7 cases displayed in Panel (b).</figcaption>
</figure>
</div>
</div>
</div>
<p>From this plot, it is easy to spot unusually high leverage values.</p>
<p><br></p>
<section id="identifying-high-leverage-observations-in-the-contraception-example" class="level2">
<h2 class="anchored" data-anchor-id="identifying-high-leverage-observations-in-the-contraception-example">Identifying High Leverage Observations in the Contraception Example</h2>
<p>In practice, we can use the <code>augment()</code> function from the <code>{broom}</code> package to obtain the leverage values for each observation for a fitted model. These values are provided in the <code>.hat</code> column. Previously, we had assigned the augment output for <code>lm.1</code> to an object called <code>out_1</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View augmented data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>out_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"57","2":"5.9","3":"1","4":"55.65751","5":"1.34249276","6":"0.08752664","7":"14.48180","8":"0.00022828080037","9":"0.09756739"},{"1":"66","2":"8.9","3":"1","4":"65.24765","5":"0.75235237","6":"0.02168413","7":"14.48232","8":"0.00001545155047","9":"0.05280616"},{"1":"55","2":"10.5","3":"1","4":"70.36239","5":"-15.36238917","6":"0.03258073","7":"14.39070","8":"0.00989907365212","9":"-1.08431187"},{"1":"62","2":"4.6","3":"0","4":"45.91627","5":"16.08372937","6":"0.02012031","7":"14.38313","8":"0.00653143149216","9":"1.12798466"},{"1":"67","2":"10.5","3":"1","4":"70.36239","5":"-3.36238917","6":"0.03258073","7":"14.47815","8":"0.00047421248672","9":"-0.23732496"},{"1":"51","2":"9.2","3":"1","4":"66.20666","5":"-15.20666167","6":"0.02128908","7":"14.39360","8":"0.00619243355779","9":"-1.06711071"},{"1":"16","2":"2.0","3":"0","4":"34.14706","5":"-18.14706039","6":"0.03770633","7":"14.35354","8":"0.01615686917694","9":"-1.28426688"},{"1":"67","2":"8.4","3":"0","4":"63.11742","5":"3.88257596","6":"0.06905329","7":"14.47646","8":"0.00144717241198","9":"0.27935752"},{"1":"46","2":"7.2","3":"1","4":"59.81323","5":"-13.81323474","6":"0.04517860","7":"14.40735","8":"0.01139265369220","9":"-0.98137984"},{"1":"53","2":"8.7","3":"1","4":"64.60830","5":"-11.60830493","6":"0.02257267","7":"14.43071","8":"0.00383616506057","9":"-0.81513470"},{"1":"69","2":"10.6","3":"1","4":"70.68206","5":"-1.68206051","6":"0.03432456","7":"14.48144","8":"0.00012547913178","9":"-0.11883075"},{"1":"32","2":"1.9","3":"0","4":"33.69440","5":"-1.69439846","6":"0.03921132","7":"14.48142","8":"0.00014693742085","9":"-0.12000640"},{"1":"29","2":"2.2","3":"0","4":"35.05238","5":"-6.05238426","6":"0.03488049","7":"14.46829","8":"0.00165279496671","9":"-0.42769952"},{"1":"56","2":"3.2","3":"0","4":"39.57900","5":"16.42099642","6":"0.02443396","7":"14.37844","8":"0.00834113411826","9":"1.15418117"},{"1":"34","2":"5.1","3":"0","4":"48.17958","5":"-14.17958029","6":"0.02149518","7":"14.40523","8":"0.00543860514842","9":"-0.99514120"},{"1":"85","2":"12.3","3":"1","4":"76.11647","5":"8.88352660","6":"0.08309989","7":"14.45021","8":"0.00939880980238","9":"0.64406131"},{"1":"6","2":"0.6","3":"0","4":"27.80979","5":"-21.80979335","6":"0.06436156","7":"14.29049","8":"0.04213656736991","9":"-1.56530991"},{"1":"76","2":"9.6","3":"1","4":"67.48535","5":"8.51465295","6":"0.02251282","7":"14.45468","8":"0.00205819830913","9":"0.59788028"},{"1":"81","2":"7.0","3":"1","4":"59.17389","5":"21.82610795","6":"0.05031831","7":"14.29306","8":"0.03202344910366","9":"1.55485566"},{"1":"20","2":"2.1","3":"0","4":"34.59972","5":"-14.59972233","6":"0.03626272","7":"14.39930","8":"0.01002715861298","9":"-1.03244775"},{"1":"78","2":"8.4","3":"1","4":"63.64929","5":"14.35070910","6":"0.02484324","7":"14.40307","8":"0.00648263772796","9":"1.00887871"},{"1":"69","2":"10.5","3":"1","4":"70.36239","5":"-1.36238917","6":"0.03258073","7":"14.48182","8":"0.00007785372425","9":"-0.09616048"},{"1":"86","2":"12.1","3":"1","4":"75.47713","5":"10.52286930","6":"0.07548610","7":"14.43752","8":"0.01178295211681","9":"0.75976672"},{"1":"70","2":"7.7","3":"1","4":"61.41159","5":"8.58840853","6":"0.03451743","7":"14.45384","8":"0.00329094527618","9":"0.60679681"},{"1":"80","2":"7.4","3":"1","4":"60.45258","5":"19.54742257","6":"0.04053903","7":"14.33231","8":"0.02027418356292","9":"1.38541109"},{"1":"59","2":"5.3","3":"0","4":"49.08490","5":"9.91509585","6":"0.02247477","7":"14.44475","8":"0.00278598528738","9":"0.69620276"},{"1":"72","2":"6.1","3":"0","4":"52.70620","5":"19.29380040","6":"0.02884826","7":"14.33798","8":"0.01371913246726","9":"1.35918023"},{"1":"40","2":"1.4","3":"0","4":"31.43109","5":"8.56891120","6":"0.04765693","7":"14.45358","8":"0.00464874899240","9":"0.60958145"},{"1":"78","2":"10.9","3":"1","4":"71.64107","5":"6.35892545","6":"0.04030625","7":"14.46672","8":"0.00213216206873","9":"0.45063012"},{"1":"31","2":"5.9","3":"0","4":"51.80088","5":"-20.80087574","6":"0.02688662","7":"14.31471","8":"0.01480192536888","9":"-1.46387068"},{"1":"76","2":"9.9","3":"1","4":"68.44436","5":"7.55563891","6":"0.02474348","7":"14.46056","8":"0.00178941505069","9":"0.53114681"},{"1":"9","2":"0.8","3":"0","4":"28.71512","5":"-19.71511721","6":"0.05981713","7":"14.32656","8":"0.03169168064474","9":"-1.41154917"},{"1":"34","2":"3.2","3":"0","4":"39.57900","5":"-5.57900358","6":"0.02443396","7":"14.47056","8":"0.00096280729288","9":"-0.39213095"},{"1":"73","2":"5.3","3":"0","4":"49.08490","5":"23.91509585","6":"0.02247477","7":"14.26129","8":"0.01620799284848","9":"1.67923297"},{"1":"62","2":"11.2","3":"1","4":"72.60009","5":"-10.60008859","6":"0.04741325","7":"14.43821","8":"0.00707384144150","9":"-0.75398037"},{"1":"54","2":"3.2","3":"0","4":"39.57900","5":"14.42099642","6":"0.02443396","7":"14.40232","8":"0.00643304559603","9":"1.01360734"},{"1":"61","2":"6.9","3":"0","4":"56.32750","5":"4.67250494","6":"0.03914994","7":"14.47401","8":"0.00111548832238","9":"0.33092134"},{"1":"53","2":"4.4","3":"1","4":"50.86244","5":"2.13756295","6":"0.16264695","7":"14.48049","8":"0.00127706254622","9":"0.16216884"},{"1":"65","2":"9.7","3":"1","4":"67.80502","5":"-2.80501840","6":"0.02313134","7":"14.47952","8":"0.00022979757128","9":"-0.19702459"},{"1":"73","2":"9.8","3":"1","4":"68.12469","5":"4.87531026","6":"0.02387489","7":"14.47340","8":"0.00071759695643","9":"0.34257237"},{"1":"40","2":"11.2","3":"1","4":"72.60009","5":"-32.60008859","6":"0.04741325","7":"14.05764","8":"0.06690735966056","9":"-2.31883222"},{"1":"52","2":"9.4","3":"1","4":"66.84600","5":"-14.84600436","6":"0.02165088","7":"14.39775","8":"0.00600693030058","9":"-1.04199460"},{"1":"55","2":"10.2","3":"1","4":"69.40338","5":"-14.40337513","6":"0.02809945","7":"14.40222","8":"0.00743581179799","9":"-1.01427605"},{"1":"61","2":"5.4","3":"0","4":"49.53757","5":"11.46243392","6":"0.02305664","7":"14.43198","8":"0.00382433987328","9":"0.80509099"},{"1":"80","2":"11.1","3":"1","4":"72.28042","5":"7.71958276","6":"0.04491922","7":"14.45911","8":"0.00353578041483","9":"0.54837366"},{"1":"54","2":"3.8","3":"0","4":"42.29498","5":"11.70502483","6":"0.02111218","7":"14.42992","8":"0.00363711949810","9":"0.82131299"},{"1":"55","2":"7.6","3":"1","4":"61.09192","5":"-6.09192013","6":"0.03639960","7":"14.46808","8":"0.00175289818200","9":"-0.43083257"},{"1":"60","2":"6.8","3":"0","4":"55.87483","5":"4.12516687","6":"0.03764741","7":"14.47590","8":"0.00083348023442","9":"0.29192899"},{"1":"31","2":"2.3","3":"0","4":"35.50505","5":"-4.50504619","6":"0.03355963","7":"14.47466","8":"0.00087864051525","9":"-0.31813726"},{"1":"48","2":"4.8","3":"0","4":"46.82159","5":"1.17840551","6":"0.02048613","7":"14.48201","8":"0.00003572513002","9":"0.08265941"},{"1":"59","2":"3.4","3":"0","4":"40.48433","5":"18.51567256","6":"0.02308119","7":"14.35024","8":"0.00999000725509","9":"1.30050812"},{"1":"52","2":"9.2","3":"1","4":"66.20666","5":"-14.20666167","6":"0.02128908","7":"14.40495","8":"0.00540477556255","9":"-0.99693682"},{"1":"19","2":"5.4","3":"1","4":"54.05915","5":"-35.05915051","6":"0.10944088","7":"13.95499","8":"0.20436310851133","9":"-2.57912758"},{"1":"16","2":"1.4","3":"0","4":"31.43109","5":"-15.43108880","6":"0.04765693","7":"14.38841","8":"0.01507571622679","9":"-1.09774804"},{"1":"86","2":"9.5","3":"1","4":"67.16568","5":"18.83432430","6":"0.02201933","7":"14.34578","8":"0.00983986812606","9":"1.32217129"},{"1":"64","2":"8.0","3":"1","4":"62.37061","5":"1.62939449","6":"0.02962115","7":"14.48151","8":"0.00010062765093","9":"0.11483080"},{"1":"67","2":"8.1","3":"1","4":"62.69028","5":"4.30972314","6":"0.02823912","7":"14.47537","8":"0.00066923199307","9":"0.30350963"},{"1":"60","2":"9.6","3":"0","4":"68.54937","5":"-8.54936722","6":"0.10291920","7":"14.45193","8":"0.01126281231586","9":"-0.62664417"},{"1":"55","2":"8.5","3":"0","4":"63.57009","5":"-8.57008597","6":"0.07153787","7":"14.45282","8":"0.00734384659740","9":"-0.61745583"},{"1":"71","2":"3.2","3":"0","4":"39.57900","5":"31.42099642","6":"0.02443396","7":"14.09766","8":"0.03053978659046","9":"2.20848488"},{"1":"27","2":"0.8","3":"0","4":"28.71512","5":"-1.71511721","6":"0.05981713","7":"14.48137","8":"0.00023984692449","9":"-0.12279776"},{"1":"56","2":"6.3","3":"1","4":"56.93619","5":"-0.93619263","6":"0.07224585","7":"14.48219","8":"0.00008863866274","9":"-0.06747635"},{"1":"53","2":"2.4","3":"0","4":"35.95771","5":"17.04229188","6":"0.03230016","7":"14.36947","8":"0.01207049109980","9":"1.20270877"},{"1":"80","2":"4.8","3":"0","4":"46.82159","5":"33.17840551","6":"0.02048613","7":"14.05448","8":"0.02832013440911","9":"2.32730353"},{"1":"11","2":"0.8","3":"0","4":"28.71512","5":"-17.71511721","6":"0.05981713","7":"14.35673","8":"0.02558789762288","9":"-1.26835457"},{"1":"28","2":"4.2","3":"0","4":"44.10562","5":"-16.10562290","6":"0.02012522","7":"14.38286","8":"0.00655088899947","9":"-1.12952293"},{"1":"34","2":"3.3","3":"0","4":"40.03167","5":"-6.03166551","6":"0.02372688","7":"14.46855","8":"0.00109123467663","9":"-0.42379360"},{"1":"63","2":"9.6","3":"1","4":"67.48535","5":"-4.48534705","6":"0.02251282","7":"14.47481","8":"0.00057114373643","9":"-0.31495125"},{"1":"68","2":"7.5","3":"1","4":"60.77225","5":"7.22775122","6":"0.03840680","7":"14.46214","8":"0.00261443202998","9":"0.51169399"},{"1":"54","2":"8.8","3":"0","4":"64.92807","5":"-10.92807177","6":"0.07935988","7":"14.43378","8":"0.01347267713365","9":"-0.79068118"},{"1":"74","2":"8.0","3":"1","4":"62.37061","5":"11.62939449","6":"0.02962115","7":"14.43014","8":"0.00512600533948","9":"0.81957604"},{"1":"70","2":"10.4","3":"1","4":"70.04272","5":"-0.04271782","6":"0.03096194","7":"14.48254","8":"0.00000007249537","9":"-0.00301260"},{"1":"53","2":"3.1","3":"0","4":"39.12634","5":"13.87365835","6":"0.02520241","7":"14.40825","8":"0.00615093010969","9":"0.97552092"},{"1":"41","2":"4.0","3":"0","4":"43.20030","5":"-2.20029903","6":"0.02049595","7":"14.48069","8":"0.00012461334433","9":"-0.15434103"},{"1":"28","2":"3.4","3":"0","4":"40.48433","5":"-12.48432744","6":"0.02308119","7":"14.42255","8":"0.00454168617516","9":"-0.87687710"},{"1":"58","2":"9.2","3":"1","4":"66.20666","5":"-8.20666167","6":"0.02128908","7":"14.45669","8":"0.00180354360596","9":"-0.57589343"},{"1":"23","2":"2.0","3":"0","4":"34.14706","5":"-11.14706039","6":"0.03770633","7":"14.43400","8":"0.00609628620135","9":"-0.78887711"},{"1":"80","2":"11.6","3":"1","4":"73.87877","5":"6.12122603","6":"0.05863973","7":"14.46760","8":"0.00298746435564","9":"0.43798910"},{"1":"79","2":"11.8","3":"1","4":"74.51812","5":"4.48188334","6":"0.06500318","7":"14.47448","8":"0.00179962103197","9":"0.32177944"},{"1":"55","2":"9.8","3":"1","4":"68.12469","5":"-13.12468974","6":"0.02387489","7":"14.41617","8":"0.00520060850698","9":"-0.92222973"},{"1":"71","2":"9.5","3":"1","4":"67.16568","5":"3.83432430","6":"0.02201933","7":"14.47690","8":"0.00040781845317","9":"0.26916992"},{"1":"48","2":"7.3","3":"1","4":"60.13291","5":"-12.13290609","6":"0.04279630","7":"14.42471","8":"0.00828462341030","9":"-0.86092529"},{"1":"66","2":"7.4","3":"0","4":"58.59080","5":"7.40919528","6":"0.04758327","7":"14.46089","8":"0.00346966865618","9":"0.52706035"},{"1":"29","2":"10.0","3":"0","4":"70.36001","5":"-41.36001495","6":"0.11617193","7":"13.73703","8":"0.30652975079693","9":"-3.05421500"},{"1":"38","2":"4.5","3":"0","4":"45.46361","5":"-7.46360869","6":"0.02002947","7":"14.46119","8":"0.00139986730463","9":"-0.52341380"},{"1":"78","2":"7.0","3":"1","4":"59.17389","5":"18.82610795","6":"0.05031831","7":"14.34181","8":"0.02382520233611","9":"1.34114065"},{"1":"20","2":"3.3","3":"0","4":"40.03167","5":"-20.03166551","6":"0.02372688","7":"14.32747","8":"0.01203587805388","9":"-1.40745400"},{"1":"63","2":"5.5","3":"0","4":"49.99023","5":"13.00977199","6":"0.02369988","7":"14.41734","8":"0.00507065893877","9":"0.91407289"},{"1":"42","2":"4.3","3":"0","4":"44.55828","5":"-2.55828483","6":"0.02003193","7":"14.48003","8":"0.00016449107696","9":"-0.17940963"},{"1":"65","2":"11.2","3":"0","4":"75.79196","5":"-10.79195814","6":"0.16182241","7":"14.43030","8":"0.03232307841633","9":"-0.81834238"},{"1":"84","2":"12.8","3":"1","4":"77.71483","5":"6.28516987","6":"0.10432246","7":"14.46598","8":"0.00618947954389","9":"0.46104572"},{"1":"80","2":"8.7","3":"1","4":"64.60830","5":"15.39169507","6":"0.02257267","7":"14.39130","8":"0.00674423308034","9":"1.08080421"},{"1":"75","2":"8.7","3":"1","4":"64.60830","5":"10.39169507","6":"0.02257267","7":"14.44102","8":"0.00307420240687","9":"0.72970441"},{"1":"76","2":"5.2","3":"0","4":"48.63224","5":"27.36775778","6":"0.02195429","7":"14.19225","8":"0.02071214603456","9":"1.92115522"},{"1":"34","2":"1.2","3":"0","4":"30.52576","5":"3.47423506","6":"0.05146482","7":"14.47776","8":"0.00083189318997","9":"0.24764827"},{"1":"49","2":"5.8","3":"0","4":"51.34821","5":"-2.34821381","6":"0.02599787","7":"14.48042","8":"0.00018207018207","9":"-0.16518115"},{"1":"67","2":"6.7","3":"0","4":"55.42217","5":"11.57782880","6":"0.03620625","7":"14.43025","8":"0.00629528280894","9":"0.81872469"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Here, for example, we can see that the leverage value for the first observation is 0.0875. To determine which observations have high leverage, we will create an index plot of the leverage values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add case number to the augmented data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>out_1 <span class="ot">=</span> out_1 <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">case =</span> <span class="fu">row_number</span>()</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View augmented data</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>out_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["case"],"name":[10],"type":["int"],"align":["right"]}],"data":[{"1":"57","2":"5.9","3":"1","4":"55.65751","5":"1.34249276","6":"0.08752664","7":"14.48180","8":"0.00022828080037","9":"0.09756739","10":"1"},{"1":"66","2":"8.9","3":"1","4":"65.24765","5":"0.75235237","6":"0.02168413","7":"14.48232","8":"0.00001545155047","9":"0.05280616","10":"2"},{"1":"55","2":"10.5","3":"1","4":"70.36239","5":"-15.36238917","6":"0.03258073","7":"14.39070","8":"0.00989907365212","9":"-1.08431187","10":"3"},{"1":"62","2":"4.6","3":"0","4":"45.91627","5":"16.08372937","6":"0.02012031","7":"14.38313","8":"0.00653143149216","9":"1.12798466","10":"4"},{"1":"67","2":"10.5","3":"1","4":"70.36239","5":"-3.36238917","6":"0.03258073","7":"14.47815","8":"0.00047421248672","9":"-0.23732496","10":"5"},{"1":"51","2":"9.2","3":"1","4":"66.20666","5":"-15.20666167","6":"0.02128908","7":"14.39360","8":"0.00619243355779","9":"-1.06711071","10":"6"},{"1":"16","2":"2.0","3":"0","4":"34.14706","5":"-18.14706039","6":"0.03770633","7":"14.35354","8":"0.01615686917694","9":"-1.28426688","10":"7"},{"1":"67","2":"8.4","3":"0","4":"63.11742","5":"3.88257596","6":"0.06905329","7":"14.47646","8":"0.00144717241198","9":"0.27935752","10":"8"},{"1":"46","2":"7.2","3":"1","4":"59.81323","5":"-13.81323474","6":"0.04517860","7":"14.40735","8":"0.01139265369220","9":"-0.98137984","10":"9"},{"1":"53","2":"8.7","3":"1","4":"64.60830","5":"-11.60830493","6":"0.02257267","7":"14.43071","8":"0.00383616506057","9":"-0.81513470","10":"10"},{"1":"69","2":"10.6","3":"1","4":"70.68206","5":"-1.68206051","6":"0.03432456","7":"14.48144","8":"0.00012547913178","9":"-0.11883075","10":"11"},{"1":"32","2":"1.9","3":"0","4":"33.69440","5":"-1.69439846","6":"0.03921132","7":"14.48142","8":"0.00014693742085","9":"-0.12000640","10":"12"},{"1":"29","2":"2.2","3":"0","4":"35.05238","5":"-6.05238426","6":"0.03488049","7":"14.46829","8":"0.00165279496671","9":"-0.42769952","10":"13"},{"1":"56","2":"3.2","3":"0","4":"39.57900","5":"16.42099642","6":"0.02443396","7":"14.37844","8":"0.00834113411826","9":"1.15418117","10":"14"},{"1":"34","2":"5.1","3":"0","4":"48.17958","5":"-14.17958029","6":"0.02149518","7":"14.40523","8":"0.00543860514842","9":"-0.99514120","10":"15"},{"1":"85","2":"12.3","3":"1","4":"76.11647","5":"8.88352660","6":"0.08309989","7":"14.45021","8":"0.00939880980238","9":"0.64406131","10":"16"},{"1":"6","2":"0.6","3":"0","4":"27.80979","5":"-21.80979335","6":"0.06436156","7":"14.29049","8":"0.04213656736991","9":"-1.56530991","10":"17"},{"1":"76","2":"9.6","3":"1","4":"67.48535","5":"8.51465295","6":"0.02251282","7":"14.45468","8":"0.00205819830913","9":"0.59788028","10":"18"},{"1":"81","2":"7.0","3":"1","4":"59.17389","5":"21.82610795","6":"0.05031831","7":"14.29306","8":"0.03202344910366","9":"1.55485566","10":"19"},{"1":"20","2":"2.1","3":"0","4":"34.59972","5":"-14.59972233","6":"0.03626272","7":"14.39930","8":"0.01002715861298","9":"-1.03244775","10":"20"},{"1":"78","2":"8.4","3":"1","4":"63.64929","5":"14.35070910","6":"0.02484324","7":"14.40307","8":"0.00648263772796","9":"1.00887871","10":"21"},{"1":"69","2":"10.5","3":"1","4":"70.36239","5":"-1.36238917","6":"0.03258073","7":"14.48182","8":"0.00007785372425","9":"-0.09616048","10":"22"},{"1":"86","2":"12.1","3":"1","4":"75.47713","5":"10.52286930","6":"0.07548610","7":"14.43752","8":"0.01178295211681","9":"0.75976672","10":"23"},{"1":"70","2":"7.7","3":"1","4":"61.41159","5":"8.58840853","6":"0.03451743","7":"14.45384","8":"0.00329094527618","9":"0.60679681","10":"24"},{"1":"80","2":"7.4","3":"1","4":"60.45258","5":"19.54742257","6":"0.04053903","7":"14.33231","8":"0.02027418356292","9":"1.38541109","10":"25"},{"1":"59","2":"5.3","3":"0","4":"49.08490","5":"9.91509585","6":"0.02247477","7":"14.44475","8":"0.00278598528738","9":"0.69620276","10":"26"},{"1":"72","2":"6.1","3":"0","4":"52.70620","5":"19.29380040","6":"0.02884826","7":"14.33798","8":"0.01371913246726","9":"1.35918023","10":"27"},{"1":"40","2":"1.4","3":"0","4":"31.43109","5":"8.56891120","6":"0.04765693","7":"14.45358","8":"0.00464874899240","9":"0.60958145","10":"28"},{"1":"78","2":"10.9","3":"1","4":"71.64107","5":"6.35892545","6":"0.04030625","7":"14.46672","8":"0.00213216206873","9":"0.45063012","10":"29"},{"1":"31","2":"5.9","3":"0","4":"51.80088","5":"-20.80087574","6":"0.02688662","7":"14.31471","8":"0.01480192536888","9":"-1.46387068","10":"30"},{"1":"76","2":"9.9","3":"1","4":"68.44436","5":"7.55563891","6":"0.02474348","7":"14.46056","8":"0.00178941505069","9":"0.53114681","10":"31"},{"1":"9","2":"0.8","3":"0","4":"28.71512","5":"-19.71511721","6":"0.05981713","7":"14.32656","8":"0.03169168064474","9":"-1.41154917","10":"32"},{"1":"34","2":"3.2","3":"0","4":"39.57900","5":"-5.57900358","6":"0.02443396","7":"14.47056","8":"0.00096280729288","9":"-0.39213095","10":"33"},{"1":"73","2":"5.3","3":"0","4":"49.08490","5":"23.91509585","6":"0.02247477","7":"14.26129","8":"0.01620799284848","9":"1.67923297","10":"34"},{"1":"62","2":"11.2","3":"1","4":"72.60009","5":"-10.60008859","6":"0.04741325","7":"14.43821","8":"0.00707384144150","9":"-0.75398037","10":"35"},{"1":"54","2":"3.2","3":"0","4":"39.57900","5":"14.42099642","6":"0.02443396","7":"14.40232","8":"0.00643304559603","9":"1.01360734","10":"36"},{"1":"61","2":"6.9","3":"0","4":"56.32750","5":"4.67250494","6":"0.03914994","7":"14.47401","8":"0.00111548832238","9":"0.33092134","10":"37"},{"1":"53","2":"4.4","3":"1","4":"50.86244","5":"2.13756295","6":"0.16264695","7":"14.48049","8":"0.00127706254622","9":"0.16216884","10":"38"},{"1":"65","2":"9.7","3":"1","4":"67.80502","5":"-2.80501840","6":"0.02313134","7":"14.47952","8":"0.00022979757128","9":"-0.19702459","10":"39"},{"1":"73","2":"9.8","3":"1","4":"68.12469","5":"4.87531026","6":"0.02387489","7":"14.47340","8":"0.00071759695643","9":"0.34257237","10":"40"},{"1":"40","2":"11.2","3":"1","4":"72.60009","5":"-32.60008859","6":"0.04741325","7":"14.05764","8":"0.06690735966056","9":"-2.31883222","10":"41"},{"1":"52","2":"9.4","3":"1","4":"66.84600","5":"-14.84600436","6":"0.02165088","7":"14.39775","8":"0.00600693030058","9":"-1.04199460","10":"42"},{"1":"55","2":"10.2","3":"1","4":"69.40338","5":"-14.40337513","6":"0.02809945","7":"14.40222","8":"0.00743581179799","9":"-1.01427605","10":"43"},{"1":"61","2":"5.4","3":"0","4":"49.53757","5":"11.46243392","6":"0.02305664","7":"14.43198","8":"0.00382433987328","9":"0.80509099","10":"44"},{"1":"80","2":"11.1","3":"1","4":"72.28042","5":"7.71958276","6":"0.04491922","7":"14.45911","8":"0.00353578041483","9":"0.54837366","10":"45"},{"1":"54","2":"3.8","3":"0","4":"42.29498","5":"11.70502483","6":"0.02111218","7":"14.42992","8":"0.00363711949810","9":"0.82131299","10":"46"},{"1":"55","2":"7.6","3":"1","4":"61.09192","5":"-6.09192013","6":"0.03639960","7":"14.46808","8":"0.00175289818200","9":"-0.43083257","10":"47"},{"1":"60","2":"6.8","3":"0","4":"55.87483","5":"4.12516687","6":"0.03764741","7":"14.47590","8":"0.00083348023442","9":"0.29192899","10":"48"},{"1":"31","2":"2.3","3":"0","4":"35.50505","5":"-4.50504619","6":"0.03355963","7":"14.47466","8":"0.00087864051525","9":"-0.31813726","10":"49"},{"1":"48","2":"4.8","3":"0","4":"46.82159","5":"1.17840551","6":"0.02048613","7":"14.48201","8":"0.00003572513002","9":"0.08265941","10":"50"},{"1":"59","2":"3.4","3":"0","4":"40.48433","5":"18.51567256","6":"0.02308119","7":"14.35024","8":"0.00999000725509","9":"1.30050812","10":"51"},{"1":"52","2":"9.2","3":"1","4":"66.20666","5":"-14.20666167","6":"0.02128908","7":"14.40495","8":"0.00540477556255","9":"-0.99693682","10":"52"},{"1":"19","2":"5.4","3":"1","4":"54.05915","5":"-35.05915051","6":"0.10944088","7":"13.95499","8":"0.20436310851133","9":"-2.57912758","10":"53"},{"1":"16","2":"1.4","3":"0","4":"31.43109","5":"-15.43108880","6":"0.04765693","7":"14.38841","8":"0.01507571622679","9":"-1.09774804","10":"54"},{"1":"86","2":"9.5","3":"1","4":"67.16568","5":"18.83432430","6":"0.02201933","7":"14.34578","8":"0.00983986812606","9":"1.32217129","10":"55"},{"1":"64","2":"8.0","3":"1","4":"62.37061","5":"1.62939449","6":"0.02962115","7":"14.48151","8":"0.00010062765093","9":"0.11483080","10":"56"},{"1":"67","2":"8.1","3":"1","4":"62.69028","5":"4.30972314","6":"0.02823912","7":"14.47537","8":"0.00066923199307","9":"0.30350963","10":"57"},{"1":"60","2":"9.6","3":"0","4":"68.54937","5":"-8.54936722","6":"0.10291920","7":"14.45193","8":"0.01126281231586","9":"-0.62664417","10":"58"},{"1":"55","2":"8.5","3":"0","4":"63.57009","5":"-8.57008597","6":"0.07153787","7":"14.45282","8":"0.00734384659740","9":"-0.61745583","10":"59"},{"1":"71","2":"3.2","3":"0","4":"39.57900","5":"31.42099642","6":"0.02443396","7":"14.09766","8":"0.03053978659046","9":"2.20848488","10":"60"},{"1":"27","2":"0.8","3":"0","4":"28.71512","5":"-1.71511721","6":"0.05981713","7":"14.48137","8":"0.00023984692449","9":"-0.12279776","10":"61"},{"1":"56","2":"6.3","3":"1","4":"56.93619","5":"-0.93619263","6":"0.07224585","7":"14.48219","8":"0.00008863866274","9":"-0.06747635","10":"62"},{"1":"53","2":"2.4","3":"0","4":"35.95771","5":"17.04229188","6":"0.03230016","7":"14.36947","8":"0.01207049109980","9":"1.20270877","10":"63"},{"1":"80","2":"4.8","3":"0","4":"46.82159","5":"33.17840551","6":"0.02048613","7":"14.05448","8":"0.02832013440911","9":"2.32730353","10":"64"},{"1":"11","2":"0.8","3":"0","4":"28.71512","5":"-17.71511721","6":"0.05981713","7":"14.35673","8":"0.02558789762288","9":"-1.26835457","10":"65"},{"1":"28","2":"4.2","3":"0","4":"44.10562","5":"-16.10562290","6":"0.02012522","7":"14.38286","8":"0.00655088899947","9":"-1.12952293","10":"66"},{"1":"34","2":"3.3","3":"0","4":"40.03167","5":"-6.03166551","6":"0.02372688","7":"14.46855","8":"0.00109123467663","9":"-0.42379360","10":"67"},{"1":"63","2":"9.6","3":"1","4":"67.48535","5":"-4.48534705","6":"0.02251282","7":"14.47481","8":"0.00057114373643","9":"-0.31495125","10":"68"},{"1":"68","2":"7.5","3":"1","4":"60.77225","5":"7.22775122","6":"0.03840680","7":"14.46214","8":"0.00261443202998","9":"0.51169399","10":"69"},{"1":"54","2":"8.8","3":"0","4":"64.92807","5":"-10.92807177","6":"0.07935988","7":"14.43378","8":"0.01347267713365","9":"-0.79068118","10":"70"},{"1":"74","2":"8.0","3":"1","4":"62.37061","5":"11.62939449","6":"0.02962115","7":"14.43014","8":"0.00512600533948","9":"0.81957604","10":"71"},{"1":"70","2":"10.4","3":"1","4":"70.04272","5":"-0.04271782","6":"0.03096194","7":"14.48254","8":"0.00000007249537","9":"-0.00301260","10":"72"},{"1":"53","2":"3.1","3":"0","4":"39.12634","5":"13.87365835","6":"0.02520241","7":"14.40825","8":"0.00615093010969","9":"0.97552092","10":"73"},{"1":"41","2":"4.0","3":"0","4":"43.20030","5":"-2.20029903","6":"0.02049595","7":"14.48069","8":"0.00012461334433","9":"-0.15434103","10":"74"},{"1":"28","2":"3.4","3":"0","4":"40.48433","5":"-12.48432744","6":"0.02308119","7":"14.42255","8":"0.00454168617516","9":"-0.87687710","10":"75"},{"1":"58","2":"9.2","3":"1","4":"66.20666","5":"-8.20666167","6":"0.02128908","7":"14.45669","8":"0.00180354360596","9":"-0.57589343","10":"76"},{"1":"23","2":"2.0","3":"0","4":"34.14706","5":"-11.14706039","6":"0.03770633","7":"14.43400","8":"0.00609628620135","9":"-0.78887711","10":"77"},{"1":"80","2":"11.6","3":"1","4":"73.87877","5":"6.12122603","6":"0.05863973","7":"14.46760","8":"0.00298746435564","9":"0.43798910","10":"78"},{"1":"79","2":"11.8","3":"1","4":"74.51812","5":"4.48188334","6":"0.06500318","7":"14.47448","8":"0.00179962103197","9":"0.32177944","10":"79"},{"1":"55","2":"9.8","3":"1","4":"68.12469","5":"-13.12468974","6":"0.02387489","7":"14.41617","8":"0.00520060850698","9":"-0.92222973","10":"80"},{"1":"71","2":"9.5","3":"1","4":"67.16568","5":"3.83432430","6":"0.02201933","7":"14.47690","8":"0.00040781845317","9":"0.26916992","10":"81"},{"1":"48","2":"7.3","3":"1","4":"60.13291","5":"-12.13290609","6":"0.04279630","7":"14.42471","8":"0.00828462341030","9":"-0.86092529","10":"82"},{"1":"66","2":"7.4","3":"0","4":"58.59080","5":"7.40919528","6":"0.04758327","7":"14.46089","8":"0.00346966865618","9":"0.52706035","10":"83"},{"1":"29","2":"10.0","3":"0","4":"70.36001","5":"-41.36001495","6":"0.11617193","7":"13.73703","8":"0.30652975079693","9":"-3.05421500","10":"84"},{"1":"38","2":"4.5","3":"0","4":"45.46361","5":"-7.46360869","6":"0.02002947","7":"14.46119","8":"0.00139986730463","9":"-0.52341380","10":"85"},{"1":"78","2":"7.0","3":"1","4":"59.17389","5":"18.82610795","6":"0.05031831","7":"14.34181","8":"0.02382520233611","9":"1.34114065","10":"86"},{"1":"20","2":"3.3","3":"0","4":"40.03167","5":"-20.03166551","6":"0.02372688","7":"14.32747","8":"0.01203587805388","9":"-1.40745400","10":"87"},{"1":"63","2":"5.5","3":"0","4":"49.99023","5":"13.00977199","6":"0.02369988","7":"14.41734","8":"0.00507065893877","9":"0.91407289","10":"88"},{"1":"42","2":"4.3","3":"0","4":"44.55828","5":"-2.55828483","6":"0.02003193","7":"14.48003","8":"0.00016449107696","9":"-0.17940963","10":"89"},{"1":"65","2":"11.2","3":"0","4":"75.79196","5":"-10.79195814","6":"0.16182241","7":"14.43030","8":"0.03232307841633","9":"-0.81834238","10":"90"},{"1":"84","2":"12.8","3":"1","4":"77.71483","5":"6.28516987","6":"0.10432246","7":"14.46598","8":"0.00618947954389","9":"0.46104572","10":"91"},{"1":"80","2":"8.7","3":"1","4":"64.60830","5":"15.39169507","6":"0.02257267","7":"14.39130","8":"0.00674423308034","9":"1.08080421","10":"92"},{"1":"75","2":"8.7","3":"1","4":"64.60830","5":"10.39169507","6":"0.02257267","7":"14.44102","8":"0.00307420240687","9":"0.72970441","10":"93"},{"1":"76","2":"5.2","3":"0","4":"48.63224","5":"27.36775778","6":"0.02195429","7":"14.19225","8":"0.02071214603456","9":"1.92115522","10":"94"},{"1":"34","2":"1.2","3":"0","4":"30.52576","5":"3.47423506","6":"0.05146482","7":"14.47776","8":"0.00083189318997","9":"0.24764827","10":"95"},{"1":"49","2":"5.8","3":"0","4":"51.34821","5":"-2.34821381","6":"0.02599787","7":"14.48042","8":"0.00018207018207","9":"-0.16518115","10":"96"},{"1":"67","2":"6.7","3":"0","4":"55.42217","5":"11.57782880","6":"0.03620625","7":"14.43025","8":"0.00629528280894","9":"0.81872469","10":"97"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create index plot</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> out_1, <span class="fu">aes</span>(<span class="at">x =</span> case, <span class="at">y =</span> .hat)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Observation number"</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Leverage value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>While it seems we may be able to identify observations with high leverage in this plot, sometimes this can be difficult depending on the data. For example, the two highest observations seem like they probably have high leverage relative to the others, but what about the four observations with leverage values between 0.10 and 0.12?</p>
<p>One criterion that applied researchers use is that an observation has high leverage if:</p>
<p><span class="math display">\[
h_{ii} &gt; \frac{2p}{n}
\]</span></p>
<p>where <em>p</em> is the trace of <strong>H</strong>, which also happens to be the sum of the <span class="math inline">\(h_{ii}\)</span> values. This implies that,</p>
<p><span class="math display">\[
\begin{split}
h_{ii} &amp;&gt; \frac{2p}{n} \\[1em]
&amp;&gt; \frac{2\sum h_{ii}}{n} \\[1em]
&amp;&gt; 2 \bar{h}
\end{split}
\]</span></p>
<p>where <span class="math inline">\(\bar{h}\)</span> is the average leverage value. Thus, we are identifying observations with a leverage value greater than twice the average value, and those are the observations we are saying have high leverage. It is often useful to draw a horizontal line in the index plot at this value. Below we add in this line, and also plot the observations‚Äô case value rather than plotting points. This helps us identify the cases with high leverage.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cutoff</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">mean</span>(out_1<span class="sc">$</span>.hat)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>cutoff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08247423</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create index plot</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> out_1, <span class="fu">aes</span>(<span class="at">x =</span> case, <span class="at">y =</span> .hat)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> case)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> cutoff, <span class="at">color =</span> <span class="st">"#cc79a7"</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Observation number"</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Leverage value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Index plot of the leverage values from Model 1. Observations are identified by their case value. The reddish-purple line demarcates observations with a leverage value greater than two times the average leverage value.</figcaption>
</figure>
</div>
</div>
</div>
<p>Based on this criterion, there are several observations that have high leverage values in this model. Since these observations represent countries, and we have country names in the original data, we could also create this index plot using country names to label the observations instead of case numbers.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add country names to augmented data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>out_1 <span class="ot">=</span> out_1 <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">country =</span> contraception<span class="sc">$</span>country</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>out_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">

<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["case"],"name":[10],"type":["int"],"align":["right"]},{"label":["country"],"name":[11],"type":["chr"],"align":["left"]}],"data":[{"1":"57","2":"5.9","3":"1","4":"55.65751","5":"1.34249276","6":"0.08752664","7":"14.48180","8":"0.00022828080037","9":"0.09756739","10":"1","11":"Algeria"},{"1":"66","2":"8.9","3":"1","4":"65.24765","5":"0.75235237","6":"0.02168413","7":"14.48232","8":"0.00001545155047","9":"0.05280616","10":"2","11":"Austria"},{"1":"55","2":"10.5","3":"1","4":"70.36239","5":"-15.36238917","6":"0.03258073","7":"14.39070","8":"0.00989907365212","9":"-1.08431187","10":"3","11":"Azerbaijan"},{"1":"62","2":"4.6","3":"0","4":"45.91627","5":"16.08372937","6":"0.02012031","7":"14.38313","8":"0.00653143149216","9":"1.12798466","10":"4","11":"Bangladesh"},{"1":"67","2":"10.5","3":"1","4":"70.36239","5":"-3.36238917","6":"0.03258073","7":"14.47815","8":"0.00047421248672","9":"-0.23732496","10":"5","11":"Belgium"},{"1":"51","2":"9.2","3":"1","4":"66.20666","5":"-15.20666167","6":"0.02128908","7":"14.39360","8":"0.00619243355779","9":"-1.06711071","10":"6","11":"Belize"},{"1":"16","2":"2.0","3":"0","4":"34.14706","5":"-18.14706039","6":"0.03770633","7":"14.35354","8":"0.01615686917694","9":"-1.28426688","10":"7","11":"Benin"},{"1":"67","2":"8.4","3":"0","4":"63.11742","5":"3.88257596","6":"0.06905329","7":"14.47646","8":"0.00144717241198","9":"0.27935752","10":"8","11":"Bolivia"},{"1":"46","2":"7.2","3":"1","4":"59.81323","5":"-13.81323474","6":"0.04517860","7":"14.40735","8":"0.01139265369220","9":"-0.98137984","10":"9","11":"Bosnia and Herzegovina"},{"1":"53","2":"8.7","3":"1","4":"64.60830","5":"-11.60830493","6":"0.02257267","7":"14.43071","8":"0.00383616506057","9":"-0.81513470","10":"10","11":"Botswana"},{"1":"69","2":"10.6","3":"1","4":"70.68206","5":"-1.68206051","6":"0.03432456","7":"14.48144","8":"0.00012547913178","9":"-0.11883075","10":"11","11":"Bulgaria"},{"1":"32","2":"1.9","3":"0","4":"33.69440","5":"-1.69439846","6":"0.03921132","7":"14.48142","8":"0.00014693742085","9":"-0.12000640","10":"12","11":"Burkina Faso"},{"1":"29","2":"2.2","3":"0","4":"35.05238","5":"-6.05238426","6":"0.03488049","7":"14.46829","8":"0.00165279496671","9":"-0.42769952","10":"13","11":"Burundi"},{"1":"56","2":"3.2","3":"0","4":"39.57900","5":"16.42099642","6":"0.02443396","7":"14.37844","8":"0.00834113411826","9":"1.15418117","10":"14","11":"Cambodia"},{"1":"34","2":"5.1","3":"0","4":"48.17958","5":"-14.17958029","6":"0.02149518","7":"14.40523","8":"0.00543860514842","9":"-0.99514120","10":"15","11":"Cameroon"},{"1":"85","2":"12.3","3":"1","4":"76.11647","5":"8.88352660","6":"0.08309989","7":"14.45021","8":"0.00939880980238","9":"0.64406131","10":"16","11":"Canada"},{"1":"6","2":"0.6","3":"0","4":"27.80979","5":"-21.80979335","6":"0.06436156","7":"14.29049","8":"0.04213656736991","9":"-1.56530991","10":"17","11":"Chad"},{"1":"76","2":"9.6","3":"1","4":"67.48535","5":"8.51465295","6":"0.02251282","7":"14.45468","8":"0.00205819830913","9":"0.59788028","10":"18","11":"Chile"},{"1":"81","2":"7.0","3":"1","4":"59.17389","5":"21.82610795","6":"0.05031831","7":"14.29306","8":"0.03202344910366","9":"1.55485566","10":"19","11":"Colombia"},{"1":"20","2":"2.1","3":"0","4":"34.59972","5":"-14.59972233","6":"0.03626272","7":"14.39930","8":"0.01002715861298","9":"-1.03244775","10":"20","11":"Congo, Democratic Republic"},{"1":"78","2":"8.4","3":"1","4":"63.64929","5":"14.35070910","6":"0.02484324","7":"14.40307","8":"0.00648263772796","9":"1.00887871","10":"21","11":"Costa Rica"},{"1":"69","2":"10.5","3":"1","4":"70.36239","5":"-1.36238917","6":"0.03258073","7":"14.48182","8":"0.00007785372425","9":"-0.09616048","10":"22","11":"Croatia"},{"1":"86","2":"12.1","3":"1","4":"75.47713","5":"10.52286930","6":"0.07548610","7":"14.43752","8":"0.01178295211681","9":"0.75976672","10":"23","11":"Czech Republic"},{"1":"70","2":"7.7","3":"1","4":"61.41159","5":"8.58840853","6":"0.03451743","7":"14.45384","8":"0.00329094527618","9":"0.60679681","10":"24","11":"Dominican Republic"},{"1":"80","2":"7.4","3":"1","4":"60.45258","5":"19.54742257","6":"0.04053903","7":"14.33231","8":"0.02027418356292","9":"1.38541109","10":"25","11":"Ecuador"},{"1":"59","2":"5.3","3":"0","4":"49.08490","5":"9.91509585","6":"0.02247477","7":"14.44475","8":"0.00278598528738","9":"0.69620276","10":"26","11":"Egypt, Arab Republic"},{"1":"72","2":"6.1","3":"0","4":"52.70620","5":"19.29380040","6":"0.02884826","7":"14.33798","8":"0.01371913246726","9":"1.35918023","10":"27","11":"El Salvador"},{"1":"40","2":"1.4","3":"0","4":"31.43109","5":"8.56891120","6":"0.04765693","7":"14.45358","8":"0.00464874899240","9":"0.60958145","10":"28","11":"Ethiopia"},{"1":"78","2":"10.9","3":"1","4":"71.64107","5":"6.35892545","6":"0.04030625","7":"14.46672","8":"0.00213216206873","9":"0.45063012","10":"29","11":"France"},{"1":"31","2":"5.9","3":"0","4":"51.80088","5":"-20.80087574","6":"0.02688662","7":"14.31471","8":"0.01480192536888","9":"-1.46387068","10":"30","11":"Ghana"},{"1":"76","2":"9.9","3":"1","4":"68.44436","5":"7.55563891","6":"0.02474348","7":"14.46056","8":"0.00178941505069","9":"0.53114681","10":"31","11":"Greece"},{"1":"9","2":"0.8","3":"0","4":"28.71512","5":"-19.71511721","6":"0.05981713","7":"14.32656","8":"0.03169168064474","9":"-1.41154917","10":"32","11":"Guinea"},{"1":"34","2":"3.2","3":"0","4":"39.57900","5":"-5.57900358","6":"0.02443396","7":"14.47056","8":"0.00096280729288","9":"-0.39213095","10":"33","11":"Haiti"},{"1":"73","2":"5.3","3":"0","4":"49.08490","5":"23.91509585","6":"0.02247477","7":"14.26129","8":"0.01620799284848","9":"1.67923297","10":"34","11":"Honduras"},{"1":"62","2":"11.2","3":"1","4":"72.60009","5":"-10.60008859","6":"0.04741325","7":"14.43821","8":"0.00707384144150","9":"-0.75398037","10":"35","11":"Hungary"},{"1":"54","2":"3.2","3":"0","4":"39.57900","5":"14.42099642","6":"0.02443396","7":"14.40232","8":"0.00643304559603","9":"1.01360734","10":"36","11":"India"},{"1":"61","2":"6.9","3":"0","4":"56.32750","5":"4.67250494","6":"0.03914994","7":"14.47401","8":"0.00111548832238","9":"0.33092134","10":"37","11":"Indonesia"},{"1":"53","2":"4.4","3":"1","4":"50.86244","5":"2.13756295","6":"0.16264695","7":"14.48049","8":"0.00127706254622","9":"0.16216884","10":"38","11":"Iraq"},{"1":"65","2":"9.7","3":"1","4":"67.80502","5":"-2.80501840","6":"0.02313134","7":"14.47952","8":"0.00022979757128","9":"-0.19702459","10":"39","11":"Italy"},{"1":"73","2":"9.8","3":"1","4":"68.12469","5":"4.87531026","6":"0.02387489","7":"14.47340","8":"0.00071759695643","9":"0.34257237","10":"40","11":"Jamaica"},{"1":"40","2":"11.2","3":"1","4":"72.60009","5":"-32.60008859","6":"0.04741325","7":"14.05764","8":"0.06690735966056","9":"-2.31883222","10":"41","11":"Japan"},{"1":"52","2":"9.4","3":"1","4":"66.84600","5":"-14.84600436","6":"0.02165088","7":"14.39775","8":"0.00600693030058","9":"-1.04199460","10":"42","11":"Jordan"},{"1":"55","2":"10.2","3":"1","4":"69.40338","5":"-14.40337513","6":"0.02809945","7":"14.40222","8":"0.00743581179799","9":"-1.01427605","10":"43","11":"Kazakhstan"},{"1":"61","2":"5.4","3":"0","4":"49.53757","5":"11.46243392","6":"0.02305664","7":"14.43198","8":"0.00382433987328","9":"0.80509099","10":"44","11":"Kenya"},{"1":"80","2":"11.1","3":"1","4":"72.28042","5":"7.71958276","6":"0.04491922","7":"14.45911","8":"0.00353578041483","9":"0.54837366","10":"45","11":"Korea, Republic"},{"1":"54","2":"3.8","3":"0","4":"42.29498","5":"11.70502483","6":"0.02111218","7":"14.42992","8":"0.00363711949810","9":"0.82131299","10":"46","11":"Lao PDR"},{"1":"55","2":"7.6","3":"1","4":"61.09192","5":"-6.09192013","6":"0.03639960","7":"14.46808","8":"0.00175289818200","9":"-0.43083257","10":"47","11":"Lebanon"},{"1":"60","2":"6.8","3":"0","4":"55.87483","5":"4.12516687","6":"0.03764741","7":"14.47590","8":"0.00083348023442","9":"0.29192899","10":"48","11":"Lesotho"},{"1":"31","2":"2.3","3":"0","4":"35.50505","5":"-4.50504619","6":"0.03355963","7":"14.47466","8":"0.00087864051525","9":"-0.31813726","10":"49","11":"Liberia"},{"1":"48","2":"4.8","3":"0","4":"46.82159","5":"1.17840551","6":"0.02048613","7":"14.48201","8":"0.00003572513002","9":"0.08265941","10":"50","11":"Madagascar"},{"1":"59","2":"3.4","3":"0","4":"40.48433","5":"18.51567256","6":"0.02308119","7":"14.35024","8":"0.00999000725509","9":"1.30050812","10":"51","11":"Malawi"},{"1":"52","2":"9.2","3":"1","4":"66.20666","5":"-14.20666167","6":"0.02128908","7":"14.40495","8":"0.00540477556255","9":"-0.99693682","10":"52","11":"Malaysia"},{"1":"19","2":"5.4","3":"1","4":"54.05915","5":"-35.05915051","6":"0.10944088","7":"13.95499","8":"0.20436310851133","9":"-2.57912758","10":"53","11":"Maldives"},{"1":"16","2":"1.4","3":"0","4":"31.43109","5":"-15.43108880","6":"0.04765693","7":"14.38841","8":"0.01507571622679","9":"-1.09774804","10":"54","11":"Mali"},{"1":"86","2":"9.5","3":"1","4":"67.16568","5":"18.83432430","6":"0.02201933","7":"14.34578","8":"0.00983986812606","9":"1.32217129","10":"55","11":"Malta"},{"1":"64","2":"8.0","3":"1","4":"62.37061","5":"1.62939449","6":"0.02962115","7":"14.48151","8":"0.00010062765093","9":"0.11483080","10":"56","11":"Mauritius"},{"1":"67","2":"8.1","3":"1","4":"62.69028","5":"4.30972314","6":"0.02823912","7":"14.47537","8":"0.00066923199307","9":"0.30350963","10":"57","11":"Mexico"},{"1":"60","2":"9.6","3":"0","4":"68.54937","5":"-8.54936722","6":"0.10291920","7":"14.45193","8":"0.01126281231586","9":"-0.62664417","10":"58","11":"Moldova"},{"1":"55","2":"8.5","3":"0","4":"63.57009","5":"-8.57008597","6":"0.07153787","7":"14.45282","8":"0.00734384659740","9":"-0.61745583","10":"59","11":"Mongolia"},{"1":"71","2":"3.2","3":"0","4":"39.57900","5":"31.42099642","6":"0.02443396","7":"14.09766","8":"0.03053978659046","9":"2.20848488","10":"60","11":"Morocco"},{"1":"27","2":"0.8","3":"0","4":"28.71512","5":"-1.71511721","6":"0.05981713","7":"14.48137","8":"0.00023984692449","9":"-0.12279776","10":"61","11":"Mozambique"},{"1":"56","2":"6.3","3":"1","4":"56.93619","5":"-0.93619263","6":"0.07224585","7":"14.48219","8":"0.00008863866274","9":"-0.06747635","10":"62","11":"Namibia"},{"1":"53","2":"2.4","3":"0","4":"35.95771","5":"17.04229188","6":"0.03230016","7":"14.36947","8":"0.01207049109980","9":"1.20270877","10":"63","11":"Nepal"},{"1":"80","2":"4.8","3":"0","4":"46.82159","5":"33.17840551","6":"0.02048613","7":"14.05448","8":"0.02832013440911","9":"2.32730353","10":"64","11":"Nicaragua"},{"1":"11","2":"0.8","3":"0","4":"28.71512","5":"-17.71511721","6":"0.05981713","7":"14.35673","8":"0.02558789762288","9":"-1.26835457","10":"65","11":"Niger"},{"1":"28","2":"4.2","3":"0","4":"44.10562","5":"-16.10562290","6":"0.02012522","7":"14.38286","8":"0.00655088899947","9":"-1.12952293","10":"66","11":"Nigeria"},{"1":"34","2":"3.3","3":"0","4":"40.03167","5":"-6.03166551","6":"0.02372688","7":"14.46855","8":"0.00109123467663","9":"-0.42379360","10":"67","11":"Pakistan"},{"1":"63","2":"9.6","3":"1","4":"67.48535","5":"-4.48534705","6":"0.02251282","7":"14.47481","8":"0.00057114373643","9":"-0.31495125","10":"68","11":"Panama"},{"1":"68","2":"7.5","3":"1","4":"60.77225","5":"7.22775122","6":"0.03840680","7":"14.46214","8":"0.00261443202998","9":"0.51169399","10":"69","11":"Paraguay"},{"1":"54","2":"8.8","3":"0","4":"64.92807","5":"-10.92807177","6":"0.07935988","7":"14.43378","8":"0.01347267713365","9":"-0.79068118","10":"70","11":"Philippines"},{"1":"74","2":"8.0","3":"1","4":"62.37061","5":"11.62939449","6":"0.02962115","7":"14.43014","8":"0.00512600533948","9":"0.81957604","10":"71","11":"Portugal"},{"1":"70","2":"10.4","3":"1","4":"70.04272","5":"-0.04271782","6":"0.03096194","7":"14.48254","8":"0.00000007249537","9":"-0.00301260","10":"72","11":"Romania"},{"1":"53","2":"3.1","3":"0","4":"39.12634","5":"13.87365835","6":"0.02520241","7":"14.40825","8":"0.00615093010969","9":"0.97552092","10":"73","11":"Rwanda"},{"1":"41","2":"4.0","3":"0","4":"43.20030","5":"-2.20029903","6":"0.02049595","7":"14.48069","8":"0.00012461334433","9":"-0.15434103","10":"74","11":"Sao Tome and Principe"},{"1":"28","2":"3.4","3":"0","4":"40.48433","5":"-12.48432744","6":"0.02308119","7":"14.42255","8":"0.00454168617516","9":"-0.87687710","10":"75","11":"Senegal"},{"1":"58","2":"9.2","3":"1","4":"66.20666","5":"-8.20666167","6":"0.02128908","7":"14.45669","8":"0.00180354360596","9":"-0.57589343","10":"76","11":"Serbia"},{"1":"23","2":"2.0","3":"0","4":"34.14706","5":"-11.14706039","6":"0.03770633","7":"14.43400","8":"0.00609628620135","9":"-0.78887711","10":"77","11":"Sierra Leone"},{"1":"80","2":"11.6","3":"1","4":"73.87877","5":"6.12122603","6":"0.05863973","7":"14.46760","8":"0.00298746435564","9":"0.43798910","10":"78","11":"Slovak Republic"},{"1":"79","2":"11.8","3":"1","4":"74.51812","5":"4.48188334","6":"0.06500318","7":"14.47448","8":"0.00179962103197","9":"0.32177944","10":"79","11":"Slovenia"},{"1":"55","2":"9.8","3":"1","4":"68.12469","5":"-13.12468974","6":"0.02387489","7":"14.41617","8":"0.00520060850698","9":"-0.92222973","10":"80","11":"South Africa"},{"1":"71","2":"9.5","3":"1","4":"67.16568","5":"3.83432430","6":"0.02201933","7":"14.47690","8":"0.00040781845317","9":"0.26916992","10":"81","11":"Spain"},{"1":"48","2":"7.3","3":"1","4":"60.13291","5":"-12.13290609","6":"0.04279630","7":"14.42471","8":"0.00828462341030","9":"-0.86092529","10":"82","11":"Suriname"},{"1":"66","2":"7.4","3":"0","4":"58.59080","5":"7.40919528","6":"0.04758327","7":"14.46089","8":"0.00346966865618","9":"0.52706035","10":"83","11":"Swaziland"},{"1":"29","2":"10.0","3":"0","4":"70.36001","5":"-41.36001495","6":"0.11617193","7":"13.73703","8":"0.30652975079693","9":"-3.05421500","10":"84","11":"Tajikistan"},{"1":"38","2":"4.5","3":"0","4":"45.46361","5":"-7.46360869","6":"0.02002947","7":"14.46119","8":"0.00139986730463","9":"-0.52341380","10":"85","11":"Tanzania"},{"1":"78","2":"7.0","3":"1","4":"59.17389","5":"18.82610795","6":"0.05031831","7":"14.34181","8":"0.02382520233611","9":"1.34114065","10":"86","11":"Thailand"},{"1":"20","2":"3.3","3":"0","4":"40.03167","5":"-20.03166551","6":"0.02372688","7":"14.32747","8":"0.01203587805388","9":"-1.40745400","10":"87","11":"Togo"},{"1":"63","2":"5.5","3":"0","4":"49.99023","5":"13.00977199","6":"0.02369988","7":"14.41734","8":"0.00507065893877","9":"0.91407289","10":"88","11":"Tunisia"},{"1":"42","2":"4.3","3":"0","4":"44.55828","5":"-2.55828483","6":"0.02003193","7":"14.48003","8":"0.00016449107696","9":"-0.17940963","10":"89","11":"Uganda"},{"1":"65","2":"11.2","3":"0","4":"75.79196","5":"-10.79195814","6":"0.16182241","7":"14.43030","8":"0.03232307841633","9":"-0.81834238","10":"90","11":"Ukraine"},{"1":"84","2":"12.8","3":"1","4":"77.71483","5":"6.28516987","6":"0.10432246","7":"14.46598","8":"0.00618947954389","9":"0.46104572","10":"91","11":"United Kingdom"},{"1":"80","2":"8.7","3":"1","4":"64.60830","5":"15.39169507","6":"0.02257267","7":"14.39130","8":"0.00674423308034","9":"1.08080421","10":"92","11":"Uruguay"},{"1":"75","2":"8.7","3":"1","4":"64.60830","5":"10.39169507","6":"0.02257267","7":"14.44102","8":"0.00307420240687","9":"0.72970441","10":"93","11":"Venezuela, RB"},{"1":"76","2":"5.2","3":"0","4":"48.63224","5":"27.36775778","6":"0.02195429","7":"14.19225","8":"0.02071214603456","9":"1.92115522","10":"94","11":"Vietnam"},{"1":"34","2":"1.2","3":"0","4":"30.52576","5":"3.47423506","6":"0.05146482","7":"14.47776","8":"0.00083189318997","9":"0.24764827","10":"95","11":"Yemen, Republic"},{"1":"49","2":"5.8","3":"0","4":"51.34821","5":"-2.34821381","6":"0.02599787","7":"14.48042","8":"0.00018207018207","9":"-0.16518115","10":"96","11":"Zambia"},{"1":"67","2":"6.7","3":"0","4":"55.42217","5":"11.57782880","6":"0.03620625","7":"14.43025","8":"0.00629528280894","9":"0.81872469","10":"97","11":"Zimbabwe"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Index plot of the leverage values from Model 1. Observations are identified by their country name. The reddish-purple line demarcates observations with a leverage value greater than two times the average leverage value.</p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create index plot</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> out_1, <span class="fu">aes</span>(<span class="at">x =</span> case, <span class="at">y =</span> .hat)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> cutoff, <span class="at">color =</span> <span class="st">"#cc79a7"</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Observation number"</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Leverage value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Index plot of the leverage values from Model 1. Observations are identified by their country name. The reddish-purple line demarcates observations with a leverage value greater than two times the average leverage value.</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="measuring-outlyingness" class="level1">
<h1>Measuring Outlyingness</h1>
<p>A regression outlier is an observation that has an unusual outcome value given its predictor values; that is, it has a large residual in the regression model. The residuals for each observation are provided in the <code>.resid</code> column of the <code>augment()</code> output. Unfortunately, because the residuals are in the same metric as the outcome variable (in our case contraception rates), it can be hard to judge what ‚Äúlarge‚Äù is. One suggestion is to standardize the residuals so we can better evaluate which observations have large residuals.</p>
<p>To standardize a residual, we divide each residual by its standard error (SE), where the SE of a residual is computed as:</p>
<p><span class="math display">\[
\mathrm{SE}(e_i) = \sqrt{s^2_e (1 - h_{ii})}
\]</span> and <span class="math inline">\(s^2_e\)</span> is the error variance estimated by the model and <span class="math inline">\(h_{ii}\)</span> is the <em>i</em>th observation‚Äôs leverage value. Then, the standardized residual<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> for the <em>i</em>th observation is simply,</p>
<p><span class="math display">\[
e^*_i = \frac{e_i}{\sqrt{s^2_e (1 - h_{ii})}}
\]</span> To compute these values for the fitted contraception model, we obtain the estimated error variance by squaring the <code>sigma</code> value from the <code>glance()</code> output. Then we can compute the standardized residuals using the information in the <code>augment()</code> output.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain estimate of error variance</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>s2e <span class="ot">=</span> <span class="fu">glance</span>(lm<span class="fl">.1</span>)<span class="sc">$</span>sigma <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>s2e</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 207.4887</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute standardized residuals</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>out_1 <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">standardized_resid =</span> .resid <span class="sc">/</span> (<span class="fu">sqrt</span>(s2e <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> .hat)))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["case"],"name":[10],"type":["int"],"align":["right"]},{"label":["country"],"name":[11],"type":["chr"],"align":["left"]},{"label":["standardized_resid"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"57","2":"5.9","3":"1","4":"55.65751","5":"1.34249276","6":"0.08752664","7":"14.48180","8":"0.00022828080037","9":"0.09756739","10":"1","11":"Algeria","12":"0.09756739"},{"1":"66","2":"8.9","3":"1","4":"65.24765","5":"0.75235237","6":"0.02168413","7":"14.48232","8":"0.00001545155047","9":"0.05280616","10":"2","11":"Austria","12":"0.05280616"},{"1":"55","2":"10.5","3":"1","4":"70.36239","5":"-15.36238917","6":"0.03258073","7":"14.39070","8":"0.00989907365212","9":"-1.08431187","10":"3","11":"Azerbaijan","12":"-1.08431187"},{"1":"62","2":"4.6","3":"0","4":"45.91627","5":"16.08372937","6":"0.02012031","7":"14.38313","8":"0.00653143149216","9":"1.12798466","10":"4","11":"Bangladesh","12":"1.12798466"},{"1":"67","2":"10.5","3":"1","4":"70.36239","5":"-3.36238917","6":"0.03258073","7":"14.47815","8":"0.00047421248672","9":"-0.23732496","10":"5","11":"Belgium","12":"-0.23732496"},{"1":"51","2":"9.2","3":"1","4":"66.20666","5":"-15.20666167","6":"0.02128908","7":"14.39360","8":"0.00619243355779","9":"-1.06711071","10":"6","11":"Belize","12":"-1.06711071"},{"1":"16","2":"2.0","3":"0","4":"34.14706","5":"-18.14706039","6":"0.03770633","7":"14.35354","8":"0.01615686917694","9":"-1.28426688","10":"7","11":"Benin","12":"-1.28426688"},{"1":"67","2":"8.4","3":"0","4":"63.11742","5":"3.88257596","6":"0.06905329","7":"14.47646","8":"0.00144717241198","9":"0.27935752","10":"8","11":"Bolivia","12":"0.27935752"},{"1":"46","2":"7.2","3":"1","4":"59.81323","5":"-13.81323474","6":"0.04517860","7":"14.40735","8":"0.01139265369220","9":"-0.98137984","10":"9","11":"Bosnia and Herzegovina","12":"-0.98137984"},{"1":"53","2":"8.7","3":"1","4":"64.60830","5":"-11.60830493","6":"0.02257267","7":"14.43071","8":"0.00383616506057","9":"-0.81513470","10":"10","11":"Botswana","12":"-0.81513470"},{"1":"69","2":"10.6","3":"1","4":"70.68206","5":"-1.68206051","6":"0.03432456","7":"14.48144","8":"0.00012547913178","9":"-0.11883075","10":"11","11":"Bulgaria","12":"-0.11883075"},{"1":"32","2":"1.9","3":"0","4":"33.69440","5":"-1.69439846","6":"0.03921132","7":"14.48142","8":"0.00014693742085","9":"-0.12000640","10":"12","11":"Burkina Faso","12":"-0.12000640"},{"1":"29","2":"2.2","3":"0","4":"35.05238","5":"-6.05238426","6":"0.03488049","7":"14.46829","8":"0.00165279496671","9":"-0.42769952","10":"13","11":"Burundi","12":"-0.42769952"},{"1":"56","2":"3.2","3":"0","4":"39.57900","5":"16.42099642","6":"0.02443396","7":"14.37844","8":"0.00834113411826","9":"1.15418117","10":"14","11":"Cambodia","12":"1.15418117"},{"1":"34","2":"5.1","3":"0","4":"48.17958","5":"-14.17958029","6":"0.02149518","7":"14.40523","8":"0.00543860514842","9":"-0.99514120","10":"15","11":"Cameroon","12":"-0.99514120"},{"1":"85","2":"12.3","3":"1","4":"76.11647","5":"8.88352660","6":"0.08309989","7":"14.45021","8":"0.00939880980238","9":"0.64406131","10":"16","11":"Canada","12":"0.64406131"},{"1":"6","2":"0.6","3":"0","4":"27.80979","5":"-21.80979335","6":"0.06436156","7":"14.29049","8":"0.04213656736991","9":"-1.56530991","10":"17","11":"Chad","12":"-1.56530991"},{"1":"76","2":"9.6","3":"1","4":"67.48535","5":"8.51465295","6":"0.02251282","7":"14.45468","8":"0.00205819830913","9":"0.59788028","10":"18","11":"Chile","12":"0.59788028"},{"1":"81","2":"7.0","3":"1","4":"59.17389","5":"21.82610795","6":"0.05031831","7":"14.29306","8":"0.03202344910366","9":"1.55485566","10":"19","11":"Colombia","12":"1.55485566"},{"1":"20","2":"2.1","3":"0","4":"34.59972","5":"-14.59972233","6":"0.03626272","7":"14.39930","8":"0.01002715861298","9":"-1.03244775","10":"20","11":"Congo, Democratic Republic","12":"-1.03244775"},{"1":"78","2":"8.4","3":"1","4":"63.64929","5":"14.35070910","6":"0.02484324","7":"14.40307","8":"0.00648263772796","9":"1.00887871","10":"21","11":"Costa Rica","12":"1.00887871"},{"1":"69","2":"10.5","3":"1","4":"70.36239","5":"-1.36238917","6":"0.03258073","7":"14.48182","8":"0.00007785372425","9":"-0.09616048","10":"22","11":"Croatia","12":"-0.09616048"},{"1":"86","2":"12.1","3":"1","4":"75.47713","5":"10.52286930","6":"0.07548610","7":"14.43752","8":"0.01178295211681","9":"0.75976672","10":"23","11":"Czech Republic","12":"0.75976672"},{"1":"70","2":"7.7","3":"1","4":"61.41159","5":"8.58840853","6":"0.03451743","7":"14.45384","8":"0.00329094527618","9":"0.60679681","10":"24","11":"Dominican Republic","12":"0.60679681"},{"1":"80","2":"7.4","3":"1","4":"60.45258","5":"19.54742257","6":"0.04053903","7":"14.33231","8":"0.02027418356292","9":"1.38541109","10":"25","11":"Ecuador","12":"1.38541109"},{"1":"59","2":"5.3","3":"0","4":"49.08490","5":"9.91509585","6":"0.02247477","7":"14.44475","8":"0.00278598528738","9":"0.69620276","10":"26","11":"Egypt, Arab Republic","12":"0.69620276"},{"1":"72","2":"6.1","3":"0","4":"52.70620","5":"19.29380040","6":"0.02884826","7":"14.33798","8":"0.01371913246726","9":"1.35918023","10":"27","11":"El Salvador","12":"1.35918023"},{"1":"40","2":"1.4","3":"0","4":"31.43109","5":"8.56891120","6":"0.04765693","7":"14.45358","8":"0.00464874899240","9":"0.60958145","10":"28","11":"Ethiopia","12":"0.60958145"},{"1":"78","2":"10.9","3":"1","4":"71.64107","5":"6.35892545","6":"0.04030625","7":"14.46672","8":"0.00213216206873","9":"0.45063012","10":"29","11":"France","12":"0.45063012"},{"1":"31","2":"5.9","3":"0","4":"51.80088","5":"-20.80087574","6":"0.02688662","7":"14.31471","8":"0.01480192536888","9":"-1.46387068","10":"30","11":"Ghana","12":"-1.46387068"},{"1":"76","2":"9.9","3":"1","4":"68.44436","5":"7.55563891","6":"0.02474348","7":"14.46056","8":"0.00178941505069","9":"0.53114681","10":"31","11":"Greece","12":"0.53114681"},{"1":"9","2":"0.8","3":"0","4":"28.71512","5":"-19.71511721","6":"0.05981713","7":"14.32656","8":"0.03169168064474","9":"-1.41154917","10":"32","11":"Guinea","12":"-1.41154917"},{"1":"34","2":"3.2","3":"0","4":"39.57900","5":"-5.57900358","6":"0.02443396","7":"14.47056","8":"0.00096280729288","9":"-0.39213095","10":"33","11":"Haiti","12":"-0.39213095"},{"1":"73","2":"5.3","3":"0","4":"49.08490","5":"23.91509585","6":"0.02247477","7":"14.26129","8":"0.01620799284848","9":"1.67923297","10":"34","11":"Honduras","12":"1.67923297"},{"1":"62","2":"11.2","3":"1","4":"72.60009","5":"-10.60008859","6":"0.04741325","7":"14.43821","8":"0.00707384144150","9":"-0.75398037","10":"35","11":"Hungary","12":"-0.75398037"},{"1":"54","2":"3.2","3":"0","4":"39.57900","5":"14.42099642","6":"0.02443396","7":"14.40232","8":"0.00643304559603","9":"1.01360734","10":"36","11":"India","12":"1.01360734"},{"1":"61","2":"6.9","3":"0","4":"56.32750","5":"4.67250494","6":"0.03914994","7":"14.47401","8":"0.00111548832238","9":"0.33092134","10":"37","11":"Indonesia","12":"0.33092134"},{"1":"53","2":"4.4","3":"1","4":"50.86244","5":"2.13756295","6":"0.16264695","7":"14.48049","8":"0.00127706254622","9":"0.16216884","10":"38","11":"Iraq","12":"0.16216884"},{"1":"65","2":"9.7","3":"1","4":"67.80502","5":"-2.80501840","6":"0.02313134","7":"14.47952","8":"0.00022979757128","9":"-0.19702459","10":"39","11":"Italy","12":"-0.19702459"},{"1":"73","2":"9.8","3":"1","4":"68.12469","5":"4.87531026","6":"0.02387489","7":"14.47340","8":"0.00071759695643","9":"0.34257237","10":"40","11":"Jamaica","12":"0.34257237"},{"1":"40","2":"11.2","3":"1","4":"72.60009","5":"-32.60008859","6":"0.04741325","7":"14.05764","8":"0.06690735966056","9":"-2.31883222","10":"41","11":"Japan","12":"-2.31883222"},{"1":"52","2":"9.4","3":"1","4":"66.84600","5":"-14.84600436","6":"0.02165088","7":"14.39775","8":"0.00600693030058","9":"-1.04199460","10":"42","11":"Jordan","12":"-1.04199460"},{"1":"55","2":"10.2","3":"1","4":"69.40338","5":"-14.40337513","6":"0.02809945","7":"14.40222","8":"0.00743581179799","9":"-1.01427605","10":"43","11":"Kazakhstan","12":"-1.01427605"},{"1":"61","2":"5.4","3":"0","4":"49.53757","5":"11.46243392","6":"0.02305664","7":"14.43198","8":"0.00382433987328","9":"0.80509099","10":"44","11":"Kenya","12":"0.80509099"},{"1":"80","2":"11.1","3":"1","4":"72.28042","5":"7.71958276","6":"0.04491922","7":"14.45911","8":"0.00353578041483","9":"0.54837366","10":"45","11":"Korea, Republic","12":"0.54837366"},{"1":"54","2":"3.8","3":"0","4":"42.29498","5":"11.70502483","6":"0.02111218","7":"14.42992","8":"0.00363711949810","9":"0.82131299","10":"46","11":"Lao PDR","12":"0.82131299"},{"1":"55","2":"7.6","3":"1","4":"61.09192","5":"-6.09192013","6":"0.03639960","7":"14.46808","8":"0.00175289818200","9":"-0.43083257","10":"47","11":"Lebanon","12":"-0.43083257"},{"1":"60","2":"6.8","3":"0","4":"55.87483","5":"4.12516687","6":"0.03764741","7":"14.47590","8":"0.00083348023442","9":"0.29192899","10":"48","11":"Lesotho","12":"0.29192899"},{"1":"31","2":"2.3","3":"0","4":"35.50505","5":"-4.50504619","6":"0.03355963","7":"14.47466","8":"0.00087864051525","9":"-0.31813726","10":"49","11":"Liberia","12":"-0.31813726"},{"1":"48","2":"4.8","3":"0","4":"46.82159","5":"1.17840551","6":"0.02048613","7":"14.48201","8":"0.00003572513002","9":"0.08265941","10":"50","11":"Madagascar","12":"0.08265941"},{"1":"59","2":"3.4","3":"0","4":"40.48433","5":"18.51567256","6":"0.02308119","7":"14.35024","8":"0.00999000725509","9":"1.30050812","10":"51","11":"Malawi","12":"1.30050812"},{"1":"52","2":"9.2","3":"1","4":"66.20666","5":"-14.20666167","6":"0.02128908","7":"14.40495","8":"0.00540477556255","9":"-0.99693682","10":"52","11":"Malaysia","12":"-0.99693682"},{"1":"19","2":"5.4","3":"1","4":"54.05915","5":"-35.05915051","6":"0.10944088","7":"13.95499","8":"0.20436310851133","9":"-2.57912758","10":"53","11":"Maldives","12":"-2.57912758"},{"1":"16","2":"1.4","3":"0","4":"31.43109","5":"-15.43108880","6":"0.04765693","7":"14.38841","8":"0.01507571622679","9":"-1.09774804","10":"54","11":"Mali","12":"-1.09774804"},{"1":"86","2":"9.5","3":"1","4":"67.16568","5":"18.83432430","6":"0.02201933","7":"14.34578","8":"0.00983986812606","9":"1.32217129","10":"55","11":"Malta","12":"1.32217129"},{"1":"64","2":"8.0","3":"1","4":"62.37061","5":"1.62939449","6":"0.02962115","7":"14.48151","8":"0.00010062765093","9":"0.11483080","10":"56","11":"Mauritius","12":"0.11483080"},{"1":"67","2":"8.1","3":"1","4":"62.69028","5":"4.30972314","6":"0.02823912","7":"14.47537","8":"0.00066923199307","9":"0.30350963","10":"57","11":"Mexico","12":"0.30350963"},{"1":"60","2":"9.6","3":"0","4":"68.54937","5":"-8.54936722","6":"0.10291920","7":"14.45193","8":"0.01126281231586","9":"-0.62664417","10":"58","11":"Moldova","12":"-0.62664417"},{"1":"55","2":"8.5","3":"0","4":"63.57009","5":"-8.57008597","6":"0.07153787","7":"14.45282","8":"0.00734384659740","9":"-0.61745583","10":"59","11":"Mongolia","12":"-0.61745583"},{"1":"71","2":"3.2","3":"0","4":"39.57900","5":"31.42099642","6":"0.02443396","7":"14.09766","8":"0.03053978659046","9":"2.20848488","10":"60","11":"Morocco","12":"2.20848488"},{"1":"27","2":"0.8","3":"0","4":"28.71512","5":"-1.71511721","6":"0.05981713","7":"14.48137","8":"0.00023984692449","9":"-0.12279776","10":"61","11":"Mozambique","12":"-0.12279776"},{"1":"56","2":"6.3","3":"1","4":"56.93619","5":"-0.93619263","6":"0.07224585","7":"14.48219","8":"0.00008863866274","9":"-0.06747635","10":"62","11":"Namibia","12":"-0.06747635"},{"1":"53","2":"2.4","3":"0","4":"35.95771","5":"17.04229188","6":"0.03230016","7":"14.36947","8":"0.01207049109980","9":"1.20270877","10":"63","11":"Nepal","12":"1.20270877"},{"1":"80","2":"4.8","3":"0","4":"46.82159","5":"33.17840551","6":"0.02048613","7":"14.05448","8":"0.02832013440911","9":"2.32730353","10":"64","11":"Nicaragua","12":"2.32730353"},{"1":"11","2":"0.8","3":"0","4":"28.71512","5":"-17.71511721","6":"0.05981713","7":"14.35673","8":"0.02558789762288","9":"-1.26835457","10":"65","11":"Niger","12":"-1.26835457"},{"1":"28","2":"4.2","3":"0","4":"44.10562","5":"-16.10562290","6":"0.02012522","7":"14.38286","8":"0.00655088899947","9":"-1.12952293","10":"66","11":"Nigeria","12":"-1.12952293"},{"1":"34","2":"3.3","3":"0","4":"40.03167","5":"-6.03166551","6":"0.02372688","7":"14.46855","8":"0.00109123467663","9":"-0.42379360","10":"67","11":"Pakistan","12":"-0.42379360"},{"1":"63","2":"9.6","3":"1","4":"67.48535","5":"-4.48534705","6":"0.02251282","7":"14.47481","8":"0.00057114373643","9":"-0.31495125","10":"68","11":"Panama","12":"-0.31495125"},{"1":"68","2":"7.5","3":"1","4":"60.77225","5":"7.22775122","6":"0.03840680","7":"14.46214","8":"0.00261443202998","9":"0.51169399","10":"69","11":"Paraguay","12":"0.51169399"},{"1":"54","2":"8.8","3":"0","4":"64.92807","5":"-10.92807177","6":"0.07935988","7":"14.43378","8":"0.01347267713365","9":"-0.79068118","10":"70","11":"Philippines","12":"-0.79068118"},{"1":"74","2":"8.0","3":"1","4":"62.37061","5":"11.62939449","6":"0.02962115","7":"14.43014","8":"0.00512600533948","9":"0.81957604","10":"71","11":"Portugal","12":"0.81957604"},{"1":"70","2":"10.4","3":"1","4":"70.04272","5":"-0.04271782","6":"0.03096194","7":"14.48254","8":"0.00000007249537","9":"-0.00301260","10":"72","11":"Romania","12":"-0.00301260"},{"1":"53","2":"3.1","3":"0","4":"39.12634","5":"13.87365835","6":"0.02520241","7":"14.40825","8":"0.00615093010969","9":"0.97552092","10":"73","11":"Rwanda","12":"0.97552092"},{"1":"41","2":"4.0","3":"0","4":"43.20030","5":"-2.20029903","6":"0.02049595","7":"14.48069","8":"0.00012461334433","9":"-0.15434103","10":"74","11":"Sao Tome and Principe","12":"-0.15434103"},{"1":"28","2":"3.4","3":"0","4":"40.48433","5":"-12.48432744","6":"0.02308119","7":"14.42255","8":"0.00454168617516","9":"-0.87687710","10":"75","11":"Senegal","12":"-0.87687710"},{"1":"58","2":"9.2","3":"1","4":"66.20666","5":"-8.20666167","6":"0.02128908","7":"14.45669","8":"0.00180354360596","9":"-0.57589343","10":"76","11":"Serbia","12":"-0.57589343"},{"1":"23","2":"2.0","3":"0","4":"34.14706","5":"-11.14706039","6":"0.03770633","7":"14.43400","8":"0.00609628620135","9":"-0.78887711","10":"77","11":"Sierra Leone","12":"-0.78887711"},{"1":"80","2":"11.6","3":"1","4":"73.87877","5":"6.12122603","6":"0.05863973","7":"14.46760","8":"0.00298746435564","9":"0.43798910","10":"78","11":"Slovak Republic","12":"0.43798910"},{"1":"79","2":"11.8","3":"1","4":"74.51812","5":"4.48188334","6":"0.06500318","7":"14.47448","8":"0.00179962103197","9":"0.32177944","10":"79","11":"Slovenia","12":"0.32177944"},{"1":"55","2":"9.8","3":"1","4":"68.12469","5":"-13.12468974","6":"0.02387489","7":"14.41617","8":"0.00520060850698","9":"-0.92222973","10":"80","11":"South Africa","12":"-0.92222973"},{"1":"71","2":"9.5","3":"1","4":"67.16568","5":"3.83432430","6":"0.02201933","7":"14.47690","8":"0.00040781845317","9":"0.26916992","10":"81","11":"Spain","12":"0.26916992"},{"1":"48","2":"7.3","3":"1","4":"60.13291","5":"-12.13290609","6":"0.04279630","7":"14.42471","8":"0.00828462341030","9":"-0.86092529","10":"82","11":"Suriname","12":"-0.86092529"},{"1":"66","2":"7.4","3":"0","4":"58.59080","5":"7.40919528","6":"0.04758327","7":"14.46089","8":"0.00346966865618","9":"0.52706035","10":"83","11":"Swaziland","12":"0.52706035"},{"1":"29","2":"10.0","3":"0","4":"70.36001","5":"-41.36001495","6":"0.11617193","7":"13.73703","8":"0.30652975079693","9":"-3.05421500","10":"84","11":"Tajikistan","12":"-3.05421500"},{"1":"38","2":"4.5","3":"0","4":"45.46361","5":"-7.46360869","6":"0.02002947","7":"14.46119","8":"0.00139986730463","9":"-0.52341380","10":"85","11":"Tanzania","12":"-0.52341380"},{"1":"78","2":"7.0","3":"1","4":"59.17389","5":"18.82610795","6":"0.05031831","7":"14.34181","8":"0.02382520233611","9":"1.34114065","10":"86","11":"Thailand","12":"1.34114065"},{"1":"20","2":"3.3","3":"0","4":"40.03167","5":"-20.03166551","6":"0.02372688","7":"14.32747","8":"0.01203587805388","9":"-1.40745400","10":"87","11":"Togo","12":"-1.40745400"},{"1":"63","2":"5.5","3":"0","4":"49.99023","5":"13.00977199","6":"0.02369988","7":"14.41734","8":"0.00507065893877","9":"0.91407289","10":"88","11":"Tunisia","12":"0.91407289"},{"1":"42","2":"4.3","3":"0","4":"44.55828","5":"-2.55828483","6":"0.02003193","7":"14.48003","8":"0.00016449107696","9":"-0.17940963","10":"89","11":"Uganda","12":"-0.17940963"},{"1":"65","2":"11.2","3":"0","4":"75.79196","5":"-10.79195814","6":"0.16182241","7":"14.43030","8":"0.03232307841633","9":"-0.81834238","10":"90","11":"Ukraine","12":"-0.81834238"},{"1":"84","2":"12.8","3":"1","4":"77.71483","5":"6.28516987","6":"0.10432246","7":"14.46598","8":"0.00618947954389","9":"0.46104572","10":"91","11":"United Kingdom","12":"0.46104572"},{"1":"80","2":"8.7","3":"1","4":"64.60830","5":"15.39169507","6":"0.02257267","7":"14.39130","8":"0.00674423308034","9":"1.08080421","10":"92","11":"Uruguay","12":"1.08080421"},{"1":"75","2":"8.7","3":"1","4":"64.60830","5":"10.39169507","6":"0.02257267","7":"14.44102","8":"0.00307420240687","9":"0.72970441","10":"93","11":"Venezuela, RB","12":"0.72970441"},{"1":"76","2":"5.2","3":"0","4":"48.63224","5":"27.36775778","6":"0.02195429","7":"14.19225","8":"0.02071214603456","9":"1.92115522","10":"94","11":"Vietnam","12":"1.92115522"},{"1":"34","2":"1.2","3":"0","4":"30.52576","5":"3.47423506","6":"0.05146482","7":"14.47776","8":"0.00083189318997","9":"0.24764827","10":"95","11":"Yemen, Republic","12":"0.24764827"},{"1":"49","2":"5.8","3":"0","4":"51.34821","5":"-2.34821381","6":"0.02599787","7":"14.48042","8":"0.00018207018207","9":"-0.16518115","10":"96","11":"Zambia","12":"-0.16518115"},{"1":"67","2":"6.7","3":"0","4":"55.42217","5":"11.57782880","6":"0.03620625","7":"14.43025","8":"0.00629528280894","9":"0.81872469","10":"97","11":"Zimbabwe","12":"0.81872469"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Notice that these values are the same as those in the <code>.std.resid</code> column which is created from the <code>augment()</code> function. To evaluate which observations have a large standardized residual (and thus a large residual), we can create a plot of the standardized residuals versus the fitted values similar to that we created earlier to evaluate the model assumptions.</p>
<p>Since one of the assumptions of the regression model is that the residuals are normally distributed, we can make use of the empirical rule (which indicates that 95% of the residuals should be within two standard errors of the mean residual of zero) to identify observations with ‚Äúhigh‚Äù values. Using this heuristic, we would say that an observation that has a standardized residual more than 2 SEs from zero is a regression outlier.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Below we create the index plot of the standardized residuals, and add guides at <span class="math inline">\(\pm2\)</span> SEs.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot of standardized residuals versus</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> out_1, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .std.resid)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">color =</span> <span class="st">"#cc79a7"</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Fitted values"</span>) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Plot of the standardized residuals versus the fitted values from Model 1. Observations are identified by their country names. The reddish-purple line demarcates observations with a standardized residual more than two standard errors from zero.</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<section id="statistical-test-for-identifying-observations-with-large-residuals" class="level2">
<h2 class="anchored" data-anchor-id="statistical-test-for-identifying-observations-with-large-residuals">Statistical Test for Identifying Observations with Large Residuals</h2>
<p>Some educational scientists evaluate whether a particular observation is a regression outlier, by using a hypothesis test to determine whether its residual differs statistically from 0. To do this, we can use a <em>t</em>-test where we evaluate the standardized residual,</p>
<p><span class="math display">\[
e^*_i = \frac{e_i}{\mathrm{SE}(e_i)}
\]</span></p>
<p>This is evaluated in a <em>t</em>-distribution with <em>df</em> equivalent to the residual degrees-of-freedom from the model. The <em>t</em>-value here looks a lot like the formula we used to compute the standardized residual.</p>
<p>Unfortunately, we cannot use the standardized residual here since, if we do, the numerator and denominator are not independent (the term <span class="math inline">\(s^2_e\)</span> in the denominator is a function of <span class="math inline">\(e_i\)</span>.). This would mean that the resulting statistic is not <em>t</em>-distributed. To fix this problem, we can compute an estimate of <span class="math inline">\(s^2_e\)</span> that is computed based on the regression deleting the <em>i</em>th observation. That is,</p>
<p><span class="math display">\[
t_i = \frac{e_i}{\sqrt{s^2_{e(-i)} (1 - h_{ii})}}
\]</span> To differentiate this change in the standard error, sometimes statisticians refer to this value as a <em>studentized residual</em> rather than a standardized residual.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p><br></p>
<section id="computing-the-studentized-residual" class="level3">
<h3 class="anchored" data-anchor-id="computing-the-studentized-residual">Computing the Studentized Residual</h3>
<p>All of the components to compute the stuentized residuals are provided in the <code>augment()</code> output.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View augmented output</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>out_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["case"],"name":[10],"type":["int"],"align":["right"]},{"label":["country"],"name":[11],"type":["chr"],"align":["left"]}],"data":[{"1":"57","2":"5.9","3":"1","4":"55.65751","5":"1.34249276","6":"0.08752664","7":"14.48180","8":"0.00022828080037","9":"0.09756739","10":"1","11":"Algeria"},{"1":"66","2":"8.9","3":"1","4":"65.24765","5":"0.75235237","6":"0.02168413","7":"14.48232","8":"0.00001545155047","9":"0.05280616","10":"2","11":"Austria"},{"1":"55","2":"10.5","3":"1","4":"70.36239","5":"-15.36238917","6":"0.03258073","7":"14.39070","8":"0.00989907365212","9":"-1.08431187","10":"3","11":"Azerbaijan"},{"1":"62","2":"4.6","3":"0","4":"45.91627","5":"16.08372937","6":"0.02012031","7":"14.38313","8":"0.00653143149216","9":"1.12798466","10":"4","11":"Bangladesh"},{"1":"67","2":"10.5","3":"1","4":"70.36239","5":"-3.36238917","6":"0.03258073","7":"14.47815","8":"0.00047421248672","9":"-0.23732496","10":"5","11":"Belgium"},{"1":"51","2":"9.2","3":"1","4":"66.20666","5":"-15.20666167","6":"0.02128908","7":"14.39360","8":"0.00619243355779","9":"-1.06711071","10":"6","11":"Belize"},{"1":"16","2":"2.0","3":"0","4":"34.14706","5":"-18.14706039","6":"0.03770633","7":"14.35354","8":"0.01615686917694","9":"-1.28426688","10":"7","11":"Benin"},{"1":"67","2":"8.4","3":"0","4":"63.11742","5":"3.88257596","6":"0.06905329","7":"14.47646","8":"0.00144717241198","9":"0.27935752","10":"8","11":"Bolivia"},{"1":"46","2":"7.2","3":"1","4":"59.81323","5":"-13.81323474","6":"0.04517860","7":"14.40735","8":"0.01139265369220","9":"-0.98137984","10":"9","11":"Bosnia and Herzegovina"},{"1":"53","2":"8.7","3":"1","4":"64.60830","5":"-11.60830493","6":"0.02257267","7":"14.43071","8":"0.00383616506057","9":"-0.81513470","10":"10","11":"Botswana"},{"1":"69","2":"10.6","3":"1","4":"70.68206","5":"-1.68206051","6":"0.03432456","7":"14.48144","8":"0.00012547913178","9":"-0.11883075","10":"11","11":"Bulgaria"},{"1":"32","2":"1.9","3":"0","4":"33.69440","5":"-1.69439846","6":"0.03921132","7":"14.48142","8":"0.00014693742085","9":"-0.12000640","10":"12","11":"Burkina Faso"},{"1":"29","2":"2.2","3":"0","4":"35.05238","5":"-6.05238426","6":"0.03488049","7":"14.46829","8":"0.00165279496671","9":"-0.42769952","10":"13","11":"Burundi"},{"1":"56","2":"3.2","3":"0","4":"39.57900","5":"16.42099642","6":"0.02443396","7":"14.37844","8":"0.00834113411826","9":"1.15418117","10":"14","11":"Cambodia"},{"1":"34","2":"5.1","3":"0","4":"48.17958","5":"-14.17958029","6":"0.02149518","7":"14.40523","8":"0.00543860514842","9":"-0.99514120","10":"15","11":"Cameroon"},{"1":"85","2":"12.3","3":"1","4":"76.11647","5":"8.88352660","6":"0.08309989","7":"14.45021","8":"0.00939880980238","9":"0.64406131","10":"16","11":"Canada"},{"1":"6","2":"0.6","3":"0","4":"27.80979","5":"-21.80979335","6":"0.06436156","7":"14.29049","8":"0.04213656736991","9":"-1.56530991","10":"17","11":"Chad"},{"1":"76","2":"9.6","3":"1","4":"67.48535","5":"8.51465295","6":"0.02251282","7":"14.45468","8":"0.00205819830913","9":"0.59788028","10":"18","11":"Chile"},{"1":"81","2":"7.0","3":"1","4":"59.17389","5":"21.82610795","6":"0.05031831","7":"14.29306","8":"0.03202344910366","9":"1.55485566","10":"19","11":"Colombia"},{"1":"20","2":"2.1","3":"0","4":"34.59972","5":"-14.59972233","6":"0.03626272","7":"14.39930","8":"0.01002715861298","9":"-1.03244775","10":"20","11":"Congo, Democratic Republic"},{"1":"78","2":"8.4","3":"1","4":"63.64929","5":"14.35070910","6":"0.02484324","7":"14.40307","8":"0.00648263772796","9":"1.00887871","10":"21","11":"Costa Rica"},{"1":"69","2":"10.5","3":"1","4":"70.36239","5":"-1.36238917","6":"0.03258073","7":"14.48182","8":"0.00007785372425","9":"-0.09616048","10":"22","11":"Croatia"},{"1":"86","2":"12.1","3":"1","4":"75.47713","5":"10.52286930","6":"0.07548610","7":"14.43752","8":"0.01178295211681","9":"0.75976672","10":"23","11":"Czech Republic"},{"1":"70","2":"7.7","3":"1","4":"61.41159","5":"8.58840853","6":"0.03451743","7":"14.45384","8":"0.00329094527618","9":"0.60679681","10":"24","11":"Dominican Republic"},{"1":"80","2":"7.4","3":"1","4":"60.45258","5":"19.54742257","6":"0.04053903","7":"14.33231","8":"0.02027418356292","9":"1.38541109","10":"25","11":"Ecuador"},{"1":"59","2":"5.3","3":"0","4":"49.08490","5":"9.91509585","6":"0.02247477","7":"14.44475","8":"0.00278598528738","9":"0.69620276","10":"26","11":"Egypt, Arab Republic"},{"1":"72","2":"6.1","3":"0","4":"52.70620","5":"19.29380040","6":"0.02884826","7":"14.33798","8":"0.01371913246726","9":"1.35918023","10":"27","11":"El Salvador"},{"1":"40","2":"1.4","3":"0","4":"31.43109","5":"8.56891120","6":"0.04765693","7":"14.45358","8":"0.00464874899240","9":"0.60958145","10":"28","11":"Ethiopia"},{"1":"78","2":"10.9","3":"1","4":"71.64107","5":"6.35892545","6":"0.04030625","7":"14.46672","8":"0.00213216206873","9":"0.45063012","10":"29","11":"France"},{"1":"31","2":"5.9","3":"0","4":"51.80088","5":"-20.80087574","6":"0.02688662","7":"14.31471","8":"0.01480192536888","9":"-1.46387068","10":"30","11":"Ghana"},{"1":"76","2":"9.9","3":"1","4":"68.44436","5":"7.55563891","6":"0.02474348","7":"14.46056","8":"0.00178941505069","9":"0.53114681","10":"31","11":"Greece"},{"1":"9","2":"0.8","3":"0","4":"28.71512","5":"-19.71511721","6":"0.05981713","7":"14.32656","8":"0.03169168064474","9":"-1.41154917","10":"32","11":"Guinea"},{"1":"34","2":"3.2","3":"0","4":"39.57900","5":"-5.57900358","6":"0.02443396","7":"14.47056","8":"0.00096280729288","9":"-0.39213095","10":"33","11":"Haiti"},{"1":"73","2":"5.3","3":"0","4":"49.08490","5":"23.91509585","6":"0.02247477","7":"14.26129","8":"0.01620799284848","9":"1.67923297","10":"34","11":"Honduras"},{"1":"62","2":"11.2","3":"1","4":"72.60009","5":"-10.60008859","6":"0.04741325","7":"14.43821","8":"0.00707384144150","9":"-0.75398037","10":"35","11":"Hungary"},{"1":"54","2":"3.2","3":"0","4":"39.57900","5":"14.42099642","6":"0.02443396","7":"14.40232","8":"0.00643304559603","9":"1.01360734","10":"36","11":"India"},{"1":"61","2":"6.9","3":"0","4":"56.32750","5":"4.67250494","6":"0.03914994","7":"14.47401","8":"0.00111548832238","9":"0.33092134","10":"37","11":"Indonesia"},{"1":"53","2":"4.4","3":"1","4":"50.86244","5":"2.13756295","6":"0.16264695","7":"14.48049","8":"0.00127706254622","9":"0.16216884","10":"38","11":"Iraq"},{"1":"65","2":"9.7","3":"1","4":"67.80502","5":"-2.80501840","6":"0.02313134","7":"14.47952","8":"0.00022979757128","9":"-0.19702459","10":"39","11":"Italy"},{"1":"73","2":"9.8","3":"1","4":"68.12469","5":"4.87531026","6":"0.02387489","7":"14.47340","8":"0.00071759695643","9":"0.34257237","10":"40","11":"Jamaica"},{"1":"40","2":"11.2","3":"1","4":"72.60009","5":"-32.60008859","6":"0.04741325","7":"14.05764","8":"0.06690735966056","9":"-2.31883222","10":"41","11":"Japan"},{"1":"52","2":"9.4","3":"1","4":"66.84600","5":"-14.84600436","6":"0.02165088","7":"14.39775","8":"0.00600693030058","9":"-1.04199460","10":"42","11":"Jordan"},{"1":"55","2":"10.2","3":"1","4":"69.40338","5":"-14.40337513","6":"0.02809945","7":"14.40222","8":"0.00743581179799","9":"-1.01427605","10":"43","11":"Kazakhstan"},{"1":"61","2":"5.4","3":"0","4":"49.53757","5":"11.46243392","6":"0.02305664","7":"14.43198","8":"0.00382433987328","9":"0.80509099","10":"44","11":"Kenya"},{"1":"80","2":"11.1","3":"1","4":"72.28042","5":"7.71958276","6":"0.04491922","7":"14.45911","8":"0.00353578041483","9":"0.54837366","10":"45","11":"Korea, Republic"},{"1":"54","2":"3.8","3":"0","4":"42.29498","5":"11.70502483","6":"0.02111218","7":"14.42992","8":"0.00363711949810","9":"0.82131299","10":"46","11":"Lao PDR"},{"1":"55","2":"7.6","3":"1","4":"61.09192","5":"-6.09192013","6":"0.03639960","7":"14.46808","8":"0.00175289818200","9":"-0.43083257","10":"47","11":"Lebanon"},{"1":"60","2":"6.8","3":"0","4":"55.87483","5":"4.12516687","6":"0.03764741","7":"14.47590","8":"0.00083348023442","9":"0.29192899","10":"48","11":"Lesotho"},{"1":"31","2":"2.3","3":"0","4":"35.50505","5":"-4.50504619","6":"0.03355963","7":"14.47466","8":"0.00087864051525","9":"-0.31813726","10":"49","11":"Liberia"},{"1":"48","2":"4.8","3":"0","4":"46.82159","5":"1.17840551","6":"0.02048613","7":"14.48201","8":"0.00003572513002","9":"0.08265941","10":"50","11":"Madagascar"},{"1":"59","2":"3.4","3":"0","4":"40.48433","5":"18.51567256","6":"0.02308119","7":"14.35024","8":"0.00999000725509","9":"1.30050812","10":"51","11":"Malawi"},{"1":"52","2":"9.2","3":"1","4":"66.20666","5":"-14.20666167","6":"0.02128908","7":"14.40495","8":"0.00540477556255","9":"-0.99693682","10":"52","11":"Malaysia"},{"1":"19","2":"5.4","3":"1","4":"54.05915","5":"-35.05915051","6":"0.10944088","7":"13.95499","8":"0.20436310851133","9":"-2.57912758","10":"53","11":"Maldives"},{"1":"16","2":"1.4","3":"0","4":"31.43109","5":"-15.43108880","6":"0.04765693","7":"14.38841","8":"0.01507571622679","9":"-1.09774804","10":"54","11":"Mali"},{"1":"86","2":"9.5","3":"1","4":"67.16568","5":"18.83432430","6":"0.02201933","7":"14.34578","8":"0.00983986812606","9":"1.32217129","10":"55","11":"Malta"},{"1":"64","2":"8.0","3":"1","4":"62.37061","5":"1.62939449","6":"0.02962115","7":"14.48151","8":"0.00010062765093","9":"0.11483080","10":"56","11":"Mauritius"},{"1":"67","2":"8.1","3":"1","4":"62.69028","5":"4.30972314","6":"0.02823912","7":"14.47537","8":"0.00066923199307","9":"0.30350963","10":"57","11":"Mexico"},{"1":"60","2":"9.6","3":"0","4":"68.54937","5":"-8.54936722","6":"0.10291920","7":"14.45193","8":"0.01126281231586","9":"-0.62664417","10":"58","11":"Moldova"},{"1":"55","2":"8.5","3":"0","4":"63.57009","5":"-8.57008597","6":"0.07153787","7":"14.45282","8":"0.00734384659740","9":"-0.61745583","10":"59","11":"Mongolia"},{"1":"71","2":"3.2","3":"0","4":"39.57900","5":"31.42099642","6":"0.02443396","7":"14.09766","8":"0.03053978659046","9":"2.20848488","10":"60","11":"Morocco"},{"1":"27","2":"0.8","3":"0","4":"28.71512","5":"-1.71511721","6":"0.05981713","7":"14.48137","8":"0.00023984692449","9":"-0.12279776","10":"61","11":"Mozambique"},{"1":"56","2":"6.3","3":"1","4":"56.93619","5":"-0.93619263","6":"0.07224585","7":"14.48219","8":"0.00008863866274","9":"-0.06747635","10":"62","11":"Namibia"},{"1":"53","2":"2.4","3":"0","4":"35.95771","5":"17.04229188","6":"0.03230016","7":"14.36947","8":"0.01207049109980","9":"1.20270877","10":"63","11":"Nepal"},{"1":"80","2":"4.8","3":"0","4":"46.82159","5":"33.17840551","6":"0.02048613","7":"14.05448","8":"0.02832013440911","9":"2.32730353","10":"64","11":"Nicaragua"},{"1":"11","2":"0.8","3":"0","4":"28.71512","5":"-17.71511721","6":"0.05981713","7":"14.35673","8":"0.02558789762288","9":"-1.26835457","10":"65","11":"Niger"},{"1":"28","2":"4.2","3":"0","4":"44.10562","5":"-16.10562290","6":"0.02012522","7":"14.38286","8":"0.00655088899947","9":"-1.12952293","10":"66","11":"Nigeria"},{"1":"34","2":"3.3","3":"0","4":"40.03167","5":"-6.03166551","6":"0.02372688","7":"14.46855","8":"0.00109123467663","9":"-0.42379360","10":"67","11":"Pakistan"},{"1":"63","2":"9.6","3":"1","4":"67.48535","5":"-4.48534705","6":"0.02251282","7":"14.47481","8":"0.00057114373643","9":"-0.31495125","10":"68","11":"Panama"},{"1":"68","2":"7.5","3":"1","4":"60.77225","5":"7.22775122","6":"0.03840680","7":"14.46214","8":"0.00261443202998","9":"0.51169399","10":"69","11":"Paraguay"},{"1":"54","2":"8.8","3":"0","4":"64.92807","5":"-10.92807177","6":"0.07935988","7":"14.43378","8":"0.01347267713365","9":"-0.79068118","10":"70","11":"Philippines"},{"1":"74","2":"8.0","3":"1","4":"62.37061","5":"11.62939449","6":"0.02962115","7":"14.43014","8":"0.00512600533948","9":"0.81957604","10":"71","11":"Portugal"},{"1":"70","2":"10.4","3":"1","4":"70.04272","5":"-0.04271782","6":"0.03096194","7":"14.48254","8":"0.00000007249537","9":"-0.00301260","10":"72","11":"Romania"},{"1":"53","2":"3.1","3":"0","4":"39.12634","5":"13.87365835","6":"0.02520241","7":"14.40825","8":"0.00615093010969","9":"0.97552092","10":"73","11":"Rwanda"},{"1":"41","2":"4.0","3":"0","4":"43.20030","5":"-2.20029903","6":"0.02049595","7":"14.48069","8":"0.00012461334433","9":"-0.15434103","10":"74","11":"Sao Tome and Principe"},{"1":"28","2":"3.4","3":"0","4":"40.48433","5":"-12.48432744","6":"0.02308119","7":"14.42255","8":"0.00454168617516","9":"-0.87687710","10":"75","11":"Senegal"},{"1":"58","2":"9.2","3":"1","4":"66.20666","5":"-8.20666167","6":"0.02128908","7":"14.45669","8":"0.00180354360596","9":"-0.57589343","10":"76","11":"Serbia"},{"1":"23","2":"2.0","3":"0","4":"34.14706","5":"-11.14706039","6":"0.03770633","7":"14.43400","8":"0.00609628620135","9":"-0.78887711","10":"77","11":"Sierra Leone"},{"1":"80","2":"11.6","3":"1","4":"73.87877","5":"6.12122603","6":"0.05863973","7":"14.46760","8":"0.00298746435564","9":"0.43798910","10":"78","11":"Slovak Republic"},{"1":"79","2":"11.8","3":"1","4":"74.51812","5":"4.48188334","6":"0.06500318","7":"14.47448","8":"0.00179962103197","9":"0.32177944","10":"79","11":"Slovenia"},{"1":"55","2":"9.8","3":"1","4":"68.12469","5":"-13.12468974","6":"0.02387489","7":"14.41617","8":"0.00520060850698","9":"-0.92222973","10":"80","11":"South Africa"},{"1":"71","2":"9.5","3":"1","4":"67.16568","5":"3.83432430","6":"0.02201933","7":"14.47690","8":"0.00040781845317","9":"0.26916992","10":"81","11":"Spain"},{"1":"48","2":"7.3","3":"1","4":"60.13291","5":"-12.13290609","6":"0.04279630","7":"14.42471","8":"0.00828462341030","9":"-0.86092529","10":"82","11":"Suriname"},{"1":"66","2":"7.4","3":"0","4":"58.59080","5":"7.40919528","6":"0.04758327","7":"14.46089","8":"0.00346966865618","9":"0.52706035","10":"83","11":"Swaziland"},{"1":"29","2":"10.0","3":"0","4":"70.36001","5":"-41.36001495","6":"0.11617193","7":"13.73703","8":"0.30652975079693","9":"-3.05421500","10":"84","11":"Tajikistan"},{"1":"38","2":"4.5","3":"0","4":"45.46361","5":"-7.46360869","6":"0.02002947","7":"14.46119","8":"0.00139986730463","9":"-0.52341380","10":"85","11":"Tanzania"},{"1":"78","2":"7.0","3":"1","4":"59.17389","5":"18.82610795","6":"0.05031831","7":"14.34181","8":"0.02382520233611","9":"1.34114065","10":"86","11":"Thailand"},{"1":"20","2":"3.3","3":"0","4":"40.03167","5":"-20.03166551","6":"0.02372688","7":"14.32747","8":"0.01203587805388","9":"-1.40745400","10":"87","11":"Togo"},{"1":"63","2":"5.5","3":"0","4":"49.99023","5":"13.00977199","6":"0.02369988","7":"14.41734","8":"0.00507065893877","9":"0.91407289","10":"88","11":"Tunisia"},{"1":"42","2":"4.3","3":"0","4":"44.55828","5":"-2.55828483","6":"0.02003193","7":"14.48003","8":"0.00016449107696","9":"-0.17940963","10":"89","11":"Uganda"},{"1":"65","2":"11.2","3":"0","4":"75.79196","5":"-10.79195814","6":"0.16182241","7":"14.43030","8":"0.03232307841633","9":"-0.81834238","10":"90","11":"Ukraine"},{"1":"84","2":"12.8","3":"1","4":"77.71483","5":"6.28516987","6":"0.10432246","7":"14.46598","8":"0.00618947954389","9":"0.46104572","10":"91","11":"United Kingdom"},{"1":"80","2":"8.7","3":"1","4":"64.60830","5":"15.39169507","6":"0.02257267","7":"14.39130","8":"0.00674423308034","9":"1.08080421","10":"92","11":"Uruguay"},{"1":"75","2":"8.7","3":"1","4":"64.60830","5":"10.39169507","6":"0.02257267","7":"14.44102","8":"0.00307420240687","9":"0.72970441","10":"93","11":"Venezuela, RB"},{"1":"76","2":"5.2","3":"0","4":"48.63224","5":"27.36775778","6":"0.02195429","7":"14.19225","8":"0.02071214603456","9":"1.92115522","10":"94","11":"Vietnam"},{"1":"34","2":"1.2","3":"0","4":"30.52576","5":"3.47423506","6":"0.05146482","7":"14.47776","8":"0.00083189318997","9":"0.24764827","10":"95","11":"Yemen, Republic"},{"1":"49","2":"5.8","3":"0","4":"51.34821","5":"-2.34821381","6":"0.02599787","7":"14.48042","8":"0.00018207018207","9":"-0.16518115","10":"96","11":"Zambia"},{"1":"67","2":"6.7","3":"0","4":"55.42217","5":"11.57782880","6":"0.03620625","7":"14.43025","8":"0.00629528280894","9":"0.81872469","10":"97","11":"Zimbabwe"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The values in the <code>.sigma</code> column are estimates of <span class="math inline">\(s_e\)</span> computed based on the regression deleting the <em>i</em>th observation. That is, they are <span class="math inline">\(s_{e(-i)}\)</span>. To compute the studentized residual for Observation 1,</p>
<p><span class="math display">\[
\begin{split}
t_1 &amp;= \frac{e_i}{s_{e(-i)}\sqrt{(1 - h_{ii})}} \\[1em]
&amp;= \frac{1.34}{14.5\sqrt{1 - .0875}} \\[1em]
&amp;= 0.09674318
\end{split}
\]</span> We can also use this formula to compute the studentized residual for each observation in the <code>augmented()</code> output.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute studentized residuals</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>out_1 <span class="ot">=</span> out_1 <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_i =</span> .resid <span class="sc">/</span> (.sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> .hat))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View output</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>out_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["case"],"name":[10],"type":["int"],"align":["right"]},{"label":["country"],"name":[11],"type":["chr"],"align":["left"]},{"label":["t_i"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"57","2":"5.9","3":"1","4":"55.65751","5":"1.34249276","6":"0.08752664","7":"14.48180","8":"0.00022828080037","9":"0.09756739","10":"1","11":"Algeria","12":"0.09704638"},{"1":"66","2":"8.9","3":"1","4":"65.24765","5":"0.75235237","6":"0.02168413","7":"14.48232","8":"0.00001545155047","9":"0.05280616","10":"2","11":"Austria","12":"0.05252227"},{"1":"55","2":"10.5","3":"1","4":"70.36239","5":"-15.36238917","6":"0.03258073","7":"14.39070","8":"0.00989907365212","9":"-1.08431187","10":"3","11":"Azerbaijan","12":"-1.08534894"},{"1":"62","2":"4.6","3":"0","4":"45.91627","5":"16.08372937","6":"0.02012031","7":"14.38313","8":"0.00653143149216","9":"1.12798466","10":"4","11":"Bangladesh","12":"1.12965797"},{"1":"67","2":"10.5","3":"1","4":"70.36239","5":"-3.36238917","6":"0.03258073","7":"14.47815","8":"0.00047421248672","9":"-0.23732496","10":"5","11":"Belgium","12":"-0.23611709"},{"1":"51","2":"9.2","3":"1","4":"66.20666","5":"-15.20666167","6":"0.02128908","7":"14.39360","8":"0.00619243355779","9":"-1.06711071","10":"6","11":"Belize","12":"-1.06791616"},{"1":"16","2":"2.0","3":"0","4":"34.14706","5":"-18.14706039","6":"0.03770633","7":"14.35354","8":"0.01615686917694","9":"-1.28426688","10":"7","11":"Benin","12":"-1.28882323"},{"1":"67","2":"8.4","3":"0","4":"63.11742","5":"3.88257596","6":"0.06905329","7":"14.47646","8":"0.00144717241198","9":"0.27935752","10":"8","11":"Bolivia","12":"0.27796819"},{"1":"46","2":"7.2","3":"1","4":"59.81323","5":"-13.81323474","6":"0.04517860","7":"14.40735","8":"0.01139265369220","9":"-0.98137984","10":"9","11":"Bosnia and Herzegovina","12":"-0.98118313"},{"1":"53","2":"8.7","3":"1","4":"64.60830","5":"-11.60830493","6":"0.02257267","7":"14.43071","8":"0.00383616506057","9":"-0.81513470","10":"10","11":"Botswana","12":"-0.81365222"},{"1":"69","2":"10.6","3":"1","4":"70.68206","5":"-1.68206051","6":"0.03432456","7":"14.48144","8":"0.00012547913178","9":"-0.11883075","10":"11","11":"Bulgaria","12":"-0.11819912"},{"1":"32","2":"1.9","3":"0","4":"33.69440","5":"-1.69439846","6":"0.03921132","7":"14.48142","8":"0.00014693742085","9":"-0.12000640","10":"12","11":"Burkina Faso","12":"-0.11936871"},{"1":"29","2":"2.2","3":"0","4":"35.05238","5":"-6.05238426","6":"0.03488049","7":"14.46829","8":"0.00165279496671","9":"-0.42769952","10":"13","11":"Burundi","12":"-0.42581283"},{"1":"56","2":"3.2","3":"0","4":"39.57900","5":"16.42099642","6":"0.02443396","7":"14.37844","8":"0.00834113411826","9":"1.15418117","10":"14","11":"Cambodia","12":"1.15627021"},{"1":"34","2":"5.1","3":"0","4":"48.17958","5":"-14.17958029","6":"0.02149518","7":"14.40523","8":"0.00543860514842","9":"-0.99514120","10":"15","11":"Cameroon","12":"-0.99508877"},{"1":"85","2":"12.3","3":"1","4":"76.11647","5":"8.88352660","6":"0.08309989","7":"14.45021","8":"0.00939880980238","9":"0.64406131","10":"16","11":"Canada","12":"0.64202268"},{"1":"6","2":"0.6","3":"0","4":"27.80979","5":"-21.80979335","6":"0.06436156","7":"14.29049","8":"0.04213656736991","9":"-1.56530991","10":"17","11":"Chad","12":"-1.57779469"},{"1":"76","2":"9.6","3":"1","4":"67.48535","5":"8.51465295","6":"0.02251282","7":"14.45468","8":"0.00205819830913","9":"0.59788028","10":"18","11":"Chile","12":"0.59580332"},{"1":"81","2":"7.0","3":"1","4":"59.17389","5":"21.82610795","6":"0.05031831","7":"14.29306","8":"0.03202344910366","9":"1.55485566","10":"19","11":"Colombia","12":"1.56697484"},{"1":"20","2":"2.1","3":"0","4":"34.59972","5":"-14.59972233","6":"0.03626272","7":"14.39930","8":"0.01002715861298","9":"-1.03244775","10":"20","11":"Congo, Democratic Republic","12":"-1.03281799"},{"1":"78","2":"8.4","3":"1","4":"63.64929","5":"14.35070910","6":"0.02484324","7":"14.40307","8":"0.00648263772796","9":"1.00887871","10":"21","11":"Costa Rica","12":"1.00897652"},{"1":"69","2":"10.5","3":"1","4":"70.36239","5":"-1.36238917","6":"0.03258073","7":"14.48182","8":"0.00007785372425","9":"-0.09616048","10":"22","11":"Croatia","12":"-0.09564685"},{"1":"86","2":"12.1","3":"1","4":"75.47713","5":"10.52286930","6":"0.07548610","7":"14.43752","8":"0.01178295211681","9":"0.75976672","10":"23","11":"Czech Republic","12":"0.75802709"},{"1":"70","2":"7.7","3":"1","4":"61.41159","5":"8.58840853","6":"0.03451743","7":"14.45384","8":"0.00329094527618","9":"0.60679681","10":"24","11":"Dominican Republic","12":"0.60472393"},{"1":"80","2":"7.4","3":"1","4":"60.45258","5":"19.54742257","6":"0.04053903","7":"14.33231","8":"0.02027418356292","9":"1.38541109","10":"25","11":"Ecuador","12":"1.39238567"},{"1":"59","2":"5.3","3":"0","4":"49.08490","5":"9.91509585","6":"0.02247477","7":"14.44475","8":"0.00278598528738","9":"0.69620276","10":"26","11":"Egypt, Arab Republic","12":"0.69426116"},{"1":"72","2":"6.1","3":"0","4":"52.70620","5":"19.29380040","6":"0.02884826","7":"14.33798","8":"0.01371913246726","9":"1.35918023","10":"27","11":"El Salvador","12":"1.36548321"},{"1":"40","2":"1.4","3":"0","4":"31.43109","5":"8.56891120","6":"0.04765693","7":"14.45358","8":"0.00464874899240","9":"0.60958145","10":"28","11":"Ethiopia","12":"0.60751017"},{"1":"78","2":"10.9","3":"1","4":"71.64107","5":"6.35892545","6":"0.04030625","7":"14.46672","8":"0.00213216206873","9":"0.45063012","10":"29","11":"France","12":"0.44869096"},{"1":"31","2":"5.9","3":"0","4":"51.80088","5":"-20.80087574","6":"0.02688662","7":"14.31471","8":"0.01480192536888","9":"-1.46387068","10":"30","11":"Ghana","12":"-1.47304913"},{"1":"76","2":"9.9","3":"1","4":"68.44436","5":"7.55563891","6":"0.02474348","7":"14.46056","8":"0.00178941505069","9":"0.53114681","10":"31","11":"Greece","12":"0.52908657"},{"1":"9","2":"0.8","3":"0","4":"28.71512","5":"-19.71511721","6":"0.05981713","7":"14.32656","8":"0.03169168064474","9":"-1.41154917","10":"32","11":"Guinea","12":"-1.41922503"},{"1":"34","2":"3.2","3":"0","4":"39.57900","5":"-5.57900358","6":"0.02443396","7":"14.47056","8":"0.00096280729288","9":"-0.39213095","10":"33","11":"Haiti","12":"-0.39033984"},{"1":"73","2":"5.3","3":"0","4":"49.08490","5":"23.91509585","6":"0.02247477","7":"14.26129","8":"0.01620799284848","9":"1.67923297","10":"34","11":"Honduras","12":"1.69609169"},{"1":"62","2":"11.2","3":"1","4":"72.60009","5":"-10.60008859","6":"0.04741325","7":"14.43821","8":"0.00707384144150","9":"-0.75398037","10":"35","11":"Hungary","12":"-0.75221835"},{"1":"54","2":"3.2","3":"0","4":"39.57900","5":"14.42099642","6":"0.02443396","7":"14.40232","8":"0.00643304559603","9":"1.01360734","10":"36","11":"India","12":"1.01375831"},{"1":"61","2":"6.9","3":"0","4":"56.32750","5":"4.67250494","6":"0.03914994","7":"14.47401","8":"0.00111548832238","9":"0.33092134","10":"37","11":"Indonesia","12":"0.32933134"},{"1":"53","2":"4.4","3":"1","4":"50.86244","5":"2.13756295","6":"0.16264695","7":"14.48049","8":"0.00127706254622","9":"0.16216884","10":"38","11":"Iraq","12":"0.16131742"},{"1":"65","2":"9.7","3":"1","4":"67.80502","5":"-2.80501840","6":"0.02313134","7":"14.47952","8":"0.00022979757128","9":"-0.19702459","10":"39","11":"Italy","12":"-0.19600337"},{"1":"73","2":"9.8","3":"1","4":"68.12469","5":"4.87531026","6":"0.02387489","7":"14.47340","8":"0.00071759695643","9":"0.34257237","10":"40","11":"Jamaica","12":"0.34094079"},{"1":"40","2":"11.2","3":"1","4":"72.60009","5":"-32.60008859","6":"0.04741325","7":"14.05764","8":"0.06690735966056","9":"-2.31883222","10":"41","11":"Japan","12":"-2.37604214"},{"1":"52","2":"9.4","3":"1","4":"66.84600","5":"-14.84600436","6":"0.02165088","7":"14.39775","8":"0.00600693030058","9":"-1.04199460","10":"42","11":"Jordan","12":"-1.04248056"},{"1":"55","2":"10.2","3":"1","4":"69.40338","5":"-14.40337513","6":"0.02809945","7":"14.40222","8":"0.00743581179799","9":"-1.01427605","10":"43","11":"Kazakhstan","12":"-1.01443460"},{"1":"61","2":"5.4","3":"0","4":"49.53757","5":"11.46243392","6":"0.02305664","7":"14.43198","8":"0.00382433987328","9":"0.80509099","10":"44","11":"Kenya","12":"0.80355597"},{"1":"80","2":"11.1","3":"1","4":"72.28042","5":"7.71958276","6":"0.04491922","7":"14.45911","8":"0.00353578041483","9":"0.54837366","10":"45","11":"Korea, Republic","12":"0.54630139"},{"1":"54","2":"3.8","3":"0","4":"42.29498","5":"11.70502483","6":"0.02111218","7":"14.42992","8":"0.00363711949810","9":"0.82131299","10":"46","11":"Lao PDR","12":"0.81986416"},{"1":"55","2":"7.6","3":"1","4":"61.09192","5":"-6.09192013","6":"0.03639960","7":"14.46808","8":"0.00175289818200","9":"-0.43083257","10":"47","11":"Lebanon","12":"-0.42893827"},{"1":"60","2":"6.8","3":"0","4":"55.87483","5":"4.12516687","6":"0.03764741","7":"14.47590","8":"0.00083348023442","9":"0.29192899","10":"48","11":"Lesotho","12":"0.29048837"},{"1":"31","2":"2.3","3":"0","4":"35.50505","5":"-4.50504619","6":"0.03355963","7":"14.47466","8":"0.00087864051525","9":"-0.31813726","10":"49","11":"Liberia","12":"-0.31659454"},{"1":"48","2":"4.8","3":"0","4":"46.82159","5":"1.17840551","6":"0.02048613","7":"14.48201","8":"0.00003572513002","9":"0.08265941","10":"50","11":"Madagascar","12":"0.08221682"},{"1":"59","2":"3.4","3":"0","4":"40.48433","5":"18.51567256","6":"0.02308119","7":"14.35024","8":"0.00999000725509","9":"1.30050812","10":"51","11":"Malawi","12":"1.30542208"},{"1":"52","2":"9.2","3":"1","4":"66.20666","5":"-14.20666167","6":"0.02128908","7":"14.40495","8":"0.00540477556255","9":"-0.99693682","10":"52","11":"Malaysia","12":"-0.99690367"},{"1":"19","2":"5.4","3":"1","4":"54.05915","5":"-35.05915051","6":"0.10944088","7":"13.95499","8":"0.20436310851133","9":"-2.57912758","10":"53","11":"Maldives","12":"-2.66219795"},{"1":"16","2":"1.4","3":"0","4":"31.43109","5":"-15.43108880","6":"0.04765693","7":"14.38841","8":"0.01507571622679","9":"-1.09774804","10":"54","11":"Mali","12":"-1.09897343"},{"1":"86","2":"9.5","3":"1","4":"67.16568","5":"18.83432430","6":"0.02201933","7":"14.34578","8":"0.00983986812606","9":"1.32217129","10":"55","11":"Malta","12":"1.32758020"},{"1":"64","2":"8.0","3":"1","4":"62.37061","5":"1.62939449","6":"0.02962115","7":"14.48151","8":"0.00010062765093","9":"0.11483080","10":"56","11":"Mauritius","12":"0.11421986"},{"1":"67","2":"8.1","3":"1","4":"62.69028","5":"4.30972314","6":"0.02823912","7":"14.47537","8":"0.00066923199307","9":"0.30350963","10":"57","11":"Mexico","12":"0.30202307"},{"1":"60","2":"9.6","3":"0","4":"68.54937","5":"-8.54936722","6":"0.10291920","7":"14.45193","8":"0.01126281231586","9":"-0.62664417","10":"58","11":"Moldova","12":"-0.62458603"},{"1":"55","2":"8.5","3":"0","4":"63.57009","5":"-8.57008597","6":"0.07153787","7":"14.45282","8":"0.00734384659740","9":"-0.61745583","10":"59","11":"Mongolia","12":"-0.61538989"},{"1":"71","2":"3.2","3":"0","4":"39.57900","5":"31.42099642","6":"0.02443396","7":"14.09766","8":"0.03053978659046","9":"2.20848488","10":"60","11":"Morocco","12":"2.25654867"},{"1":"27","2":"0.8","3":"0","4":"28.71512","5":"-1.71511721","6":"0.05981713","7":"14.48137","8":"0.00023984692449","9":"-0.12279776","10":"61","11":"Mozambique","12":"-0.12214568"},{"1":"56","2":"6.3","3":"1","4":"56.93619","5":"-0.93619263","6":"0.07224585","7":"14.48219","8":"0.00008863866274","9":"-0.06747635","10":"62","11":"Namibia","12":"-0.06711424"},{"1":"53","2":"2.4","3":"0","4":"35.95771","5":"17.04229188","6":"0.03230016","7":"14.36947","8":"0.01207049109980","9":"1.20270877","10":"63","11":"Nepal","12":"1.20563802"},{"1":"80","2":"4.8","3":"0","4":"46.82159","5":"33.17840551","6":"0.02048613","7":"14.05448","8":"0.02832013440911","9":"2.32730353","10":"64","11":"Nicaragua","12":"2.38525822"},{"1":"11","2":"0.8","3":"0","4":"28.71512","5":"-17.71511721","6":"0.05981713","7":"14.35673","8":"0.02558789762288","9":"-1.26835457","10":"65","11":"Niger","12":"-1.27257158"},{"1":"28","2":"4.2","3":"0","4":"44.10562","5":"-16.10562290","6":"0.02012522","7":"14.38286","8":"0.00655088899947","9":"-1.12952293","10":"66","11":"Nigeria","12":"-1.13121994"},{"1":"34","2":"3.3","3":"0","4":"40.03167","5":"-6.03166551","6":"0.02372688","7":"14.46855","8":"0.00109123467663","9":"-0.42379360","10":"67","11":"Pakistan","12":"-0.42191658"},{"1":"63","2":"9.6","3":"1","4":"67.48535","5":"-4.48534705","6":"0.02251282","7":"14.47481","8":"0.00057114373643","9":"-0.31495125","10":"68","11":"Panama","12":"-0.31342058"},{"1":"68","2":"7.5","3":"1","4":"60.77225","5":"7.22775122","6":"0.03840680","7":"14.46214","8":"0.00261443202998","9":"0.51169399","10":"69","11":"Paraguay","12":"0.50965345"},{"1":"54","2":"8.8","3":"0","4":"64.92807","5":"-10.92807177","6":"0.07935988","7":"14.43378","8":"0.01347267713365","9":"-0.79068118","10":"70","11":"Philippines","12":"-0.78907540"},{"1":"74","2":"8.0","3":"1","4":"62.37061","5":"11.62939449","6":"0.02962115","7":"14.43014","8":"0.00512600533948","9":"0.81957604","10":"71","11":"Portugal","12":"0.81811765"},{"1":"70","2":"10.4","3":"1","4":"70.04272","5":"-0.04271782","6":"0.03096194","7":"14.48254","8":"0.00000007249537","9":"-0.00301260","10":"72","11":"Romania","12":"-0.00299636"},{"1":"53","2":"3.1","3":"0","4":"39.12634","5":"13.87365835","6":"0.02520241","7":"14.40825","8":"0.00615093010969","9":"0.97552092","10":"73","11":"Rwanda","12":"0.97526463"},{"1":"41","2":"4.0","3":"0","4":"43.20030","5":"-2.20029903","6":"0.02049595","7":"14.48069","8":"0.00012461334433","9":"-0.15434103","10":"74","11":"Sao Tome and Principe","12":"-0.15352866"},{"1":"28","2":"3.4","3":"0","4":"40.48433","5":"-12.48432744","6":"0.02308119","7":"14.42255","8":"0.00454168617516","9":"-0.87687710","10":"75","11":"Senegal","12":"-0.87577790"},{"1":"58","2":"9.2","3":"1","4":"66.20666","5":"-8.20666167","6":"0.02128908","7":"14.45669","8":"0.00180354360596","9":"-0.57589343","10":"76","11":"Serbia","12":"-0.57381293"},{"1":"23","2":"2.0","3":"0","4":"34.14706","5":"-11.14706039","6":"0.03770633","7":"14.43400","8":"0.00609628620135","9":"-0.78887711","10":"77","11":"Sierra Leone","12":"-0.78726285"},{"1":"80","2":"11.6","3":"1","4":"73.87877","5":"6.12122603","6":"0.05863973","7":"14.46760","8":"0.00298746435564","9":"0.43798910","10":"78","11":"Slovak Republic","12":"0.43607794"},{"1":"79","2":"11.8","3":"1","4":"74.51812","5":"4.48188334","6":"0.06500318","7":"14.47448","8":"0.00179962103197","9":"0.32177944","10":"79","11":"Slovenia","12":"0.32022308"},{"1":"55","2":"9.8","3":"1","4":"68.12469","5":"-13.12468974","6":"0.02387489","7":"14.41617","8":"0.00520060850698","9":"-0.92222973","10":"80","11":"South Africa","12":"-0.92148137"},{"1":"71","2":"9.5","3":"1","4":"67.16568","5":"3.83432430","6":"0.02201933","7":"14.47690","8":"0.00040781845317","9":"0.26916992","10":"81","11":"Spain","12":"0.26782320"},{"1":"48","2":"7.3","3":"1","4":"60.13291","5":"-12.13290609","6":"0.04279630","7":"14.42471","8":"0.00828462341030","9":"-0.86092529","10":"82","11":"Suriname","12":"-0.85971689"},{"1":"66","2":"7.4","3":"0","4":"58.59080","5":"7.40919528","6":"0.04758327","7":"14.46089","8":"0.00346966865618","9":"0.52706035","10":"83","11":"Swaziland","12":"0.52500372"},{"1":"29","2":"10.0","3":"0","4":"70.36001","5":"-41.36001495","6":"0.11617193","7":"13.73703","8":"0.30652975079693","9":"-3.05421500","10":"84","11":"Tajikistan","12":"-3.20260988"},{"1":"38","2":"4.5","3":"0","4":"45.46361","5":"-7.46360869","6":"0.02002947","7":"14.46119","8":"0.00139986730463","9":"-0.52341380","10":"85","11":"Tanzania","12":"-0.52136063"},{"1":"78","2":"7.0","3":"1","4":"59.17389","5":"18.82610795","6":"0.05031831","7":"14.34181","8":"0.02382520233611","9":"1.34114065","10":"86","11":"Thailand","12":"1.34700009"},{"1":"20","2":"3.3","3":"0","4":"40.03167","5":"-20.03166551","6":"0.02372688","7":"14.32747","8":"0.01203587805388","9":"-1.40745400","10":"87","11":"Togo","12":"-1.41501785"},{"1":"63","2":"5.5","3":"0","4":"49.99023","5":"13.00977199","6":"0.02369988","7":"14.41734","8":"0.00507065893877","9":"0.91407289","10":"88","11":"Tunisia","12":"0.91325692"},{"1":"42","2":"4.3","3":"0","4":"44.55828","5":"-2.55828483","6":"0.02003193","7":"14.48003","8":"0.00016449107696","9":"-0.17940963","10":"89","11":"Uganda","12":"-0.17847334"},{"1":"65","2":"11.2","3":"0","4":"75.79196","5":"-10.79195814","6":"0.16182241","7":"14.43030","8":"0.03232307841633","9":"-0.81834238","10":"90","11":"Ukraine","12":"-0.81687724"},{"1":"84","2":"12.8","3":"1","4":"77.71483","5":"6.28516987","6":"0.10432246","7":"14.46598","8":"0.00618947954389","9":"0.46104572","10":"91","11":"United Kingdom","12":"0.45908523"},{"1":"80","2":"8.7","3":"1","4":"64.60830","5":"15.39169507","6":"0.02257267","7":"14.39130","8":"0.00674423308034","9":"1.08080421","10":"92","11":"Uruguay","12":"1.08179319"},{"1":"75","2":"8.7","3":"1","4":"64.60830","5":"10.39169507","6":"0.02257267","7":"14.44102","8":"0.00307420240687","9":"0.72970441","10":"93","11":"Venezuela, RB","12":"0.72785732"},{"1":"76","2":"5.2","3":"0","4":"48.63224","5":"27.36775778","6":"0.02195429","7":"14.19225","8":"0.02071214603456","9":"1.92115522","10":"94","11":"Vietnam","12":"1.94988213"},{"1":"34","2":"1.2","3":"0","4":"30.52576","5":"3.47423506","6":"0.05146482","7":"14.47776","8":"0.00083189318997","9":"0.24764827","10":"95","11":"Yemen, Republic","12":"0.24639448"},{"1":"49","2":"5.8","3":"0","4":"51.34821","5":"-2.34821381","6":"0.02599787","7":"14.48042","8":"0.00018207018207","9":"-0.16518115","10":"96","11":"Zambia","12":"-0.16431479"},{"1":"67","2":"6.7","3":"0","4":"55.42217","5":"11.57782880","6":"0.03620625","7":"14.43025","8":"0.00629528280894","9":"0.81872469","10":"97","11":"Zimbabwe","12":"0.81726163"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Alternatively, we can also use the <code>rstudent()</code> function to compute the studentized residuals directly. This function takes the model object as its input.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute studentized residuals</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>out_1 <span class="ot">=</span> out_1 <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_i =</span> <span class="fu">rstudent</span>(lm<span class="fl">.1</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View output</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>out_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["case"],"name":[10],"type":["int"],"align":["right"]},{"label":["country"],"name":[11],"type":["chr"],"align":["left"]},{"label":["t_i"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"57","2":"5.9","3":"1","4":"55.65751","5":"1.34249276","6":"0.08752664","7":"14.48180","8":"0.00022828080037","9":"0.09756739","10":"1","11":"Algeria","12":"0.09704638"},{"1":"66","2":"8.9","3":"1","4":"65.24765","5":"0.75235237","6":"0.02168413","7":"14.48232","8":"0.00001545155047","9":"0.05280616","10":"2","11":"Austria","12":"0.05252227"},{"1":"55","2":"10.5","3":"1","4":"70.36239","5":"-15.36238917","6":"0.03258073","7":"14.39070","8":"0.00989907365212","9":"-1.08431187","10":"3","11":"Azerbaijan","12":"-1.08534894"},{"1":"62","2":"4.6","3":"0","4":"45.91627","5":"16.08372937","6":"0.02012031","7":"14.38313","8":"0.00653143149216","9":"1.12798466","10":"4","11":"Bangladesh","12":"1.12965797"},{"1":"67","2":"10.5","3":"1","4":"70.36239","5":"-3.36238917","6":"0.03258073","7":"14.47815","8":"0.00047421248672","9":"-0.23732496","10":"5","11":"Belgium","12":"-0.23611709"},{"1":"51","2":"9.2","3":"1","4":"66.20666","5":"-15.20666167","6":"0.02128908","7":"14.39360","8":"0.00619243355779","9":"-1.06711071","10":"6","11":"Belize","12":"-1.06791616"},{"1":"16","2":"2.0","3":"0","4":"34.14706","5":"-18.14706039","6":"0.03770633","7":"14.35354","8":"0.01615686917694","9":"-1.28426688","10":"7","11":"Benin","12":"-1.28882323"},{"1":"67","2":"8.4","3":"0","4":"63.11742","5":"3.88257596","6":"0.06905329","7":"14.47646","8":"0.00144717241198","9":"0.27935752","10":"8","11":"Bolivia","12":"0.27796819"},{"1":"46","2":"7.2","3":"1","4":"59.81323","5":"-13.81323474","6":"0.04517860","7":"14.40735","8":"0.01139265369220","9":"-0.98137984","10":"9","11":"Bosnia and Herzegovina","12":"-0.98118313"},{"1":"53","2":"8.7","3":"1","4":"64.60830","5":"-11.60830493","6":"0.02257267","7":"14.43071","8":"0.00383616506057","9":"-0.81513470","10":"10","11":"Botswana","12":"-0.81365222"},{"1":"69","2":"10.6","3":"1","4":"70.68206","5":"-1.68206051","6":"0.03432456","7":"14.48144","8":"0.00012547913178","9":"-0.11883075","10":"11","11":"Bulgaria","12":"-0.11819912"},{"1":"32","2":"1.9","3":"0","4":"33.69440","5":"-1.69439846","6":"0.03921132","7":"14.48142","8":"0.00014693742085","9":"-0.12000640","10":"12","11":"Burkina Faso","12":"-0.11936871"},{"1":"29","2":"2.2","3":"0","4":"35.05238","5":"-6.05238426","6":"0.03488049","7":"14.46829","8":"0.00165279496671","9":"-0.42769952","10":"13","11":"Burundi","12":"-0.42581283"},{"1":"56","2":"3.2","3":"0","4":"39.57900","5":"16.42099642","6":"0.02443396","7":"14.37844","8":"0.00834113411826","9":"1.15418117","10":"14","11":"Cambodia","12":"1.15627021"},{"1":"34","2":"5.1","3":"0","4":"48.17958","5":"-14.17958029","6":"0.02149518","7":"14.40523","8":"0.00543860514842","9":"-0.99514120","10":"15","11":"Cameroon","12":"-0.99508877"},{"1":"85","2":"12.3","3":"1","4":"76.11647","5":"8.88352660","6":"0.08309989","7":"14.45021","8":"0.00939880980238","9":"0.64406131","10":"16","11":"Canada","12":"0.64202268"},{"1":"6","2":"0.6","3":"0","4":"27.80979","5":"-21.80979335","6":"0.06436156","7":"14.29049","8":"0.04213656736991","9":"-1.56530991","10":"17","11":"Chad","12":"-1.57779469"},{"1":"76","2":"9.6","3":"1","4":"67.48535","5":"8.51465295","6":"0.02251282","7":"14.45468","8":"0.00205819830913","9":"0.59788028","10":"18","11":"Chile","12":"0.59580332"},{"1":"81","2":"7.0","3":"1","4":"59.17389","5":"21.82610795","6":"0.05031831","7":"14.29306","8":"0.03202344910366","9":"1.55485566","10":"19","11":"Colombia","12":"1.56697484"},{"1":"20","2":"2.1","3":"0","4":"34.59972","5":"-14.59972233","6":"0.03626272","7":"14.39930","8":"0.01002715861298","9":"-1.03244775","10":"20","11":"Congo, Democratic Republic","12":"-1.03281799"},{"1":"78","2":"8.4","3":"1","4":"63.64929","5":"14.35070910","6":"0.02484324","7":"14.40307","8":"0.00648263772796","9":"1.00887871","10":"21","11":"Costa Rica","12":"1.00897652"},{"1":"69","2":"10.5","3":"1","4":"70.36239","5":"-1.36238917","6":"0.03258073","7":"14.48182","8":"0.00007785372425","9":"-0.09616048","10":"22","11":"Croatia","12":"-0.09564685"},{"1":"86","2":"12.1","3":"1","4":"75.47713","5":"10.52286930","6":"0.07548610","7":"14.43752","8":"0.01178295211681","9":"0.75976672","10":"23","11":"Czech Republic","12":"0.75802709"},{"1":"70","2":"7.7","3":"1","4":"61.41159","5":"8.58840853","6":"0.03451743","7":"14.45384","8":"0.00329094527618","9":"0.60679681","10":"24","11":"Dominican Republic","12":"0.60472393"},{"1":"80","2":"7.4","3":"1","4":"60.45258","5":"19.54742257","6":"0.04053903","7":"14.33231","8":"0.02027418356292","9":"1.38541109","10":"25","11":"Ecuador","12":"1.39238567"},{"1":"59","2":"5.3","3":"0","4":"49.08490","5":"9.91509585","6":"0.02247477","7":"14.44475","8":"0.00278598528738","9":"0.69620276","10":"26","11":"Egypt, Arab Republic","12":"0.69426116"},{"1":"72","2":"6.1","3":"0","4":"52.70620","5":"19.29380040","6":"0.02884826","7":"14.33798","8":"0.01371913246726","9":"1.35918023","10":"27","11":"El Salvador","12":"1.36548321"},{"1":"40","2":"1.4","3":"0","4":"31.43109","5":"8.56891120","6":"0.04765693","7":"14.45358","8":"0.00464874899240","9":"0.60958145","10":"28","11":"Ethiopia","12":"0.60751017"},{"1":"78","2":"10.9","3":"1","4":"71.64107","5":"6.35892545","6":"0.04030625","7":"14.46672","8":"0.00213216206873","9":"0.45063012","10":"29","11":"France","12":"0.44869096"},{"1":"31","2":"5.9","3":"0","4":"51.80088","5":"-20.80087574","6":"0.02688662","7":"14.31471","8":"0.01480192536888","9":"-1.46387068","10":"30","11":"Ghana","12":"-1.47304913"},{"1":"76","2":"9.9","3":"1","4":"68.44436","5":"7.55563891","6":"0.02474348","7":"14.46056","8":"0.00178941505069","9":"0.53114681","10":"31","11":"Greece","12":"0.52908657"},{"1":"9","2":"0.8","3":"0","4":"28.71512","5":"-19.71511721","6":"0.05981713","7":"14.32656","8":"0.03169168064474","9":"-1.41154917","10":"32","11":"Guinea","12":"-1.41922503"},{"1":"34","2":"3.2","3":"0","4":"39.57900","5":"-5.57900358","6":"0.02443396","7":"14.47056","8":"0.00096280729288","9":"-0.39213095","10":"33","11":"Haiti","12":"-0.39033984"},{"1":"73","2":"5.3","3":"0","4":"49.08490","5":"23.91509585","6":"0.02247477","7":"14.26129","8":"0.01620799284848","9":"1.67923297","10":"34","11":"Honduras","12":"1.69609169"},{"1":"62","2":"11.2","3":"1","4":"72.60009","5":"-10.60008859","6":"0.04741325","7":"14.43821","8":"0.00707384144150","9":"-0.75398037","10":"35","11":"Hungary","12":"-0.75221835"},{"1":"54","2":"3.2","3":"0","4":"39.57900","5":"14.42099642","6":"0.02443396","7":"14.40232","8":"0.00643304559603","9":"1.01360734","10":"36","11":"India","12":"1.01375831"},{"1":"61","2":"6.9","3":"0","4":"56.32750","5":"4.67250494","6":"0.03914994","7":"14.47401","8":"0.00111548832238","9":"0.33092134","10":"37","11":"Indonesia","12":"0.32933134"},{"1":"53","2":"4.4","3":"1","4":"50.86244","5":"2.13756295","6":"0.16264695","7":"14.48049","8":"0.00127706254622","9":"0.16216884","10":"38","11":"Iraq","12":"0.16131742"},{"1":"65","2":"9.7","3":"1","4":"67.80502","5":"-2.80501840","6":"0.02313134","7":"14.47952","8":"0.00022979757128","9":"-0.19702459","10":"39","11":"Italy","12":"-0.19600337"},{"1":"73","2":"9.8","3":"1","4":"68.12469","5":"4.87531026","6":"0.02387489","7":"14.47340","8":"0.00071759695643","9":"0.34257237","10":"40","11":"Jamaica","12":"0.34094079"},{"1":"40","2":"11.2","3":"1","4":"72.60009","5":"-32.60008859","6":"0.04741325","7":"14.05764","8":"0.06690735966056","9":"-2.31883222","10":"41","11":"Japan","12":"-2.37604214"},{"1":"52","2":"9.4","3":"1","4":"66.84600","5":"-14.84600436","6":"0.02165088","7":"14.39775","8":"0.00600693030058","9":"-1.04199460","10":"42","11":"Jordan","12":"-1.04248056"},{"1":"55","2":"10.2","3":"1","4":"69.40338","5":"-14.40337513","6":"0.02809945","7":"14.40222","8":"0.00743581179799","9":"-1.01427605","10":"43","11":"Kazakhstan","12":"-1.01443460"},{"1":"61","2":"5.4","3":"0","4":"49.53757","5":"11.46243392","6":"0.02305664","7":"14.43198","8":"0.00382433987328","9":"0.80509099","10":"44","11":"Kenya","12":"0.80355597"},{"1":"80","2":"11.1","3":"1","4":"72.28042","5":"7.71958276","6":"0.04491922","7":"14.45911","8":"0.00353578041483","9":"0.54837366","10":"45","11":"Korea, Republic","12":"0.54630139"},{"1":"54","2":"3.8","3":"0","4":"42.29498","5":"11.70502483","6":"0.02111218","7":"14.42992","8":"0.00363711949810","9":"0.82131299","10":"46","11":"Lao PDR","12":"0.81986416"},{"1":"55","2":"7.6","3":"1","4":"61.09192","5":"-6.09192013","6":"0.03639960","7":"14.46808","8":"0.00175289818200","9":"-0.43083257","10":"47","11":"Lebanon","12":"-0.42893827"},{"1":"60","2":"6.8","3":"0","4":"55.87483","5":"4.12516687","6":"0.03764741","7":"14.47590","8":"0.00083348023442","9":"0.29192899","10":"48","11":"Lesotho","12":"0.29048837"},{"1":"31","2":"2.3","3":"0","4":"35.50505","5":"-4.50504619","6":"0.03355963","7":"14.47466","8":"0.00087864051525","9":"-0.31813726","10":"49","11":"Liberia","12":"-0.31659454"},{"1":"48","2":"4.8","3":"0","4":"46.82159","5":"1.17840551","6":"0.02048613","7":"14.48201","8":"0.00003572513002","9":"0.08265941","10":"50","11":"Madagascar","12":"0.08221682"},{"1":"59","2":"3.4","3":"0","4":"40.48433","5":"18.51567256","6":"0.02308119","7":"14.35024","8":"0.00999000725509","9":"1.30050812","10":"51","11":"Malawi","12":"1.30542208"},{"1":"52","2":"9.2","3":"1","4":"66.20666","5":"-14.20666167","6":"0.02128908","7":"14.40495","8":"0.00540477556255","9":"-0.99693682","10":"52","11":"Malaysia","12":"-0.99690367"},{"1":"19","2":"5.4","3":"1","4":"54.05915","5":"-35.05915051","6":"0.10944088","7":"13.95499","8":"0.20436310851133","9":"-2.57912758","10":"53","11":"Maldives","12":"-2.66219795"},{"1":"16","2":"1.4","3":"0","4":"31.43109","5":"-15.43108880","6":"0.04765693","7":"14.38841","8":"0.01507571622679","9":"-1.09774804","10":"54","11":"Mali","12":"-1.09897343"},{"1":"86","2":"9.5","3":"1","4":"67.16568","5":"18.83432430","6":"0.02201933","7":"14.34578","8":"0.00983986812606","9":"1.32217129","10":"55","11":"Malta","12":"1.32758020"},{"1":"64","2":"8.0","3":"1","4":"62.37061","5":"1.62939449","6":"0.02962115","7":"14.48151","8":"0.00010062765093","9":"0.11483080","10":"56","11":"Mauritius","12":"0.11421986"},{"1":"67","2":"8.1","3":"1","4":"62.69028","5":"4.30972314","6":"0.02823912","7":"14.47537","8":"0.00066923199307","9":"0.30350963","10":"57","11":"Mexico","12":"0.30202307"},{"1":"60","2":"9.6","3":"0","4":"68.54937","5":"-8.54936722","6":"0.10291920","7":"14.45193","8":"0.01126281231586","9":"-0.62664417","10":"58","11":"Moldova","12":"-0.62458603"},{"1":"55","2":"8.5","3":"0","4":"63.57009","5":"-8.57008597","6":"0.07153787","7":"14.45282","8":"0.00734384659740","9":"-0.61745583","10":"59","11":"Mongolia","12":"-0.61538989"},{"1":"71","2":"3.2","3":"0","4":"39.57900","5":"31.42099642","6":"0.02443396","7":"14.09766","8":"0.03053978659046","9":"2.20848488","10":"60","11":"Morocco","12":"2.25654867"},{"1":"27","2":"0.8","3":"0","4":"28.71512","5":"-1.71511721","6":"0.05981713","7":"14.48137","8":"0.00023984692449","9":"-0.12279776","10":"61","11":"Mozambique","12":"-0.12214568"},{"1":"56","2":"6.3","3":"1","4":"56.93619","5":"-0.93619263","6":"0.07224585","7":"14.48219","8":"0.00008863866274","9":"-0.06747635","10":"62","11":"Namibia","12":"-0.06711424"},{"1":"53","2":"2.4","3":"0","4":"35.95771","5":"17.04229188","6":"0.03230016","7":"14.36947","8":"0.01207049109980","9":"1.20270877","10":"63","11":"Nepal","12":"1.20563802"},{"1":"80","2":"4.8","3":"0","4":"46.82159","5":"33.17840551","6":"0.02048613","7":"14.05448","8":"0.02832013440911","9":"2.32730353","10":"64","11":"Nicaragua","12":"2.38525822"},{"1":"11","2":"0.8","3":"0","4":"28.71512","5":"-17.71511721","6":"0.05981713","7":"14.35673","8":"0.02558789762288","9":"-1.26835457","10":"65","11":"Niger","12":"-1.27257158"},{"1":"28","2":"4.2","3":"0","4":"44.10562","5":"-16.10562290","6":"0.02012522","7":"14.38286","8":"0.00655088899947","9":"-1.12952293","10":"66","11":"Nigeria","12":"-1.13121994"},{"1":"34","2":"3.3","3":"0","4":"40.03167","5":"-6.03166551","6":"0.02372688","7":"14.46855","8":"0.00109123467663","9":"-0.42379360","10":"67","11":"Pakistan","12":"-0.42191658"},{"1":"63","2":"9.6","3":"1","4":"67.48535","5":"-4.48534705","6":"0.02251282","7":"14.47481","8":"0.00057114373643","9":"-0.31495125","10":"68","11":"Panama","12":"-0.31342058"},{"1":"68","2":"7.5","3":"1","4":"60.77225","5":"7.22775122","6":"0.03840680","7":"14.46214","8":"0.00261443202998","9":"0.51169399","10":"69","11":"Paraguay","12":"0.50965345"},{"1":"54","2":"8.8","3":"0","4":"64.92807","5":"-10.92807177","6":"0.07935988","7":"14.43378","8":"0.01347267713365","9":"-0.79068118","10":"70","11":"Philippines","12":"-0.78907540"},{"1":"74","2":"8.0","3":"1","4":"62.37061","5":"11.62939449","6":"0.02962115","7":"14.43014","8":"0.00512600533948","9":"0.81957604","10":"71","11":"Portugal","12":"0.81811765"},{"1":"70","2":"10.4","3":"1","4":"70.04272","5":"-0.04271782","6":"0.03096194","7":"14.48254","8":"0.00000007249537","9":"-0.00301260","10":"72","11":"Romania","12":"-0.00299636"},{"1":"53","2":"3.1","3":"0","4":"39.12634","5":"13.87365835","6":"0.02520241","7":"14.40825","8":"0.00615093010969","9":"0.97552092","10":"73","11":"Rwanda","12":"0.97526463"},{"1":"41","2":"4.0","3":"0","4":"43.20030","5":"-2.20029903","6":"0.02049595","7":"14.48069","8":"0.00012461334433","9":"-0.15434103","10":"74","11":"Sao Tome and Principe","12":"-0.15352866"},{"1":"28","2":"3.4","3":"0","4":"40.48433","5":"-12.48432744","6":"0.02308119","7":"14.42255","8":"0.00454168617516","9":"-0.87687710","10":"75","11":"Senegal","12":"-0.87577790"},{"1":"58","2":"9.2","3":"1","4":"66.20666","5":"-8.20666167","6":"0.02128908","7":"14.45669","8":"0.00180354360596","9":"-0.57589343","10":"76","11":"Serbia","12":"-0.57381293"},{"1":"23","2":"2.0","3":"0","4":"34.14706","5":"-11.14706039","6":"0.03770633","7":"14.43400","8":"0.00609628620135","9":"-0.78887711","10":"77","11":"Sierra Leone","12":"-0.78726285"},{"1":"80","2":"11.6","3":"1","4":"73.87877","5":"6.12122603","6":"0.05863973","7":"14.46760","8":"0.00298746435564","9":"0.43798910","10":"78","11":"Slovak Republic","12":"0.43607794"},{"1":"79","2":"11.8","3":"1","4":"74.51812","5":"4.48188334","6":"0.06500318","7":"14.47448","8":"0.00179962103197","9":"0.32177944","10":"79","11":"Slovenia","12":"0.32022308"},{"1":"55","2":"9.8","3":"1","4":"68.12469","5":"-13.12468974","6":"0.02387489","7":"14.41617","8":"0.00520060850698","9":"-0.92222973","10":"80","11":"South Africa","12":"-0.92148137"},{"1":"71","2":"9.5","3":"1","4":"67.16568","5":"3.83432430","6":"0.02201933","7":"14.47690","8":"0.00040781845317","9":"0.26916992","10":"81","11":"Spain","12":"0.26782320"},{"1":"48","2":"7.3","3":"1","4":"60.13291","5":"-12.13290609","6":"0.04279630","7":"14.42471","8":"0.00828462341030","9":"-0.86092529","10":"82","11":"Suriname","12":"-0.85971689"},{"1":"66","2":"7.4","3":"0","4":"58.59080","5":"7.40919528","6":"0.04758327","7":"14.46089","8":"0.00346966865618","9":"0.52706035","10":"83","11":"Swaziland","12":"0.52500372"},{"1":"29","2":"10.0","3":"0","4":"70.36001","5":"-41.36001495","6":"0.11617193","7":"13.73703","8":"0.30652975079693","9":"-3.05421500","10":"84","11":"Tajikistan","12":"-3.20260988"},{"1":"38","2":"4.5","3":"0","4":"45.46361","5":"-7.46360869","6":"0.02002947","7":"14.46119","8":"0.00139986730463","9":"-0.52341380","10":"85","11":"Tanzania","12":"-0.52136063"},{"1":"78","2":"7.0","3":"1","4":"59.17389","5":"18.82610795","6":"0.05031831","7":"14.34181","8":"0.02382520233611","9":"1.34114065","10":"86","11":"Thailand","12":"1.34700009"},{"1":"20","2":"3.3","3":"0","4":"40.03167","5":"-20.03166551","6":"0.02372688","7":"14.32747","8":"0.01203587805388","9":"-1.40745400","10":"87","11":"Togo","12":"-1.41501785"},{"1":"63","2":"5.5","3":"0","4":"49.99023","5":"13.00977199","6":"0.02369988","7":"14.41734","8":"0.00507065893877","9":"0.91407289","10":"88","11":"Tunisia","12":"0.91325692"},{"1":"42","2":"4.3","3":"0","4":"44.55828","5":"-2.55828483","6":"0.02003193","7":"14.48003","8":"0.00016449107696","9":"-0.17940963","10":"89","11":"Uganda","12":"-0.17847334"},{"1":"65","2":"11.2","3":"0","4":"75.79196","5":"-10.79195814","6":"0.16182241","7":"14.43030","8":"0.03232307841633","9":"-0.81834238","10":"90","11":"Ukraine","12":"-0.81687724"},{"1":"84","2":"12.8","3":"1","4":"77.71483","5":"6.28516987","6":"0.10432246","7":"14.46598","8":"0.00618947954389","9":"0.46104572","10":"91","11":"United Kingdom","12":"0.45908523"},{"1":"80","2":"8.7","3":"1","4":"64.60830","5":"15.39169507","6":"0.02257267","7":"14.39130","8":"0.00674423308034","9":"1.08080421","10":"92","11":"Uruguay","12":"1.08179319"},{"1":"75","2":"8.7","3":"1","4":"64.60830","5":"10.39169507","6":"0.02257267","7":"14.44102","8":"0.00307420240687","9":"0.72970441","10":"93","11":"Venezuela, RB","12":"0.72785732"},{"1":"76","2":"5.2","3":"0","4":"48.63224","5":"27.36775778","6":"0.02195429","7":"14.19225","8":"0.02071214603456","9":"1.92115522","10":"94","11":"Vietnam","12":"1.94988213"},{"1":"34","2":"1.2","3":"0","4":"30.52576","5":"3.47423506","6":"0.05146482","7":"14.47776","8":"0.00083189318997","9":"0.24764827","10":"95","11":"Yemen, Republic","12":"0.24639448"},{"1":"49","2":"5.8","3":"0","4":"51.34821","5":"-2.34821381","6":"0.02599787","7":"14.48042","8":"0.00018207018207","9":"-0.16518115","10":"96","11":"Zambia","12":"-0.16431479"},{"1":"67","2":"6.7","3":"0","4":"55.42217","5":"11.57782880","6":"0.03620625","7":"14.43025","8":"0.00629528280894","9":"0.81872469","10":"97","11":"Zimbabwe","12":"0.81726163"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="testing-observations-for-outlyingness" class="level3">
<h3 class="anchored" data-anchor-id="testing-observations-for-outlyingness">Testing Observations for Outlyingness</h3>
<p>Now that we have the <em>t</em>-value for each of the residuals, we can evaluate each residual for outlyingness by evaluating each <em>t</em>-statistics in the <em>t</em>-distribution with <em>df</em> equivalent to the residual degrees-of-freedom from the model. In our case,</p>
<p><span class="math display">\[
\mathit{df} = 93
\]</span> Thus, to evaluate whethe the first observation is a regression outlier, we would evaluate</p>
<p><span class="math display">\[
t(93) = 0.097
\]</span> to determine if the residual is statistically different than 0. Below, we compute the <em>p</em>-value associated with the first observation.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute p-value for Obs. 1</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fl">0.097</span>, <span class="at">df =</span> <span class="dv">93</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9229351</code></pre>
</div>
</div>
<p>Because we need to carry out this test for each of the 97 observations, we need to adjust each <em>p</em>-value based on the number of comparisons. This is typically done by using a Bonferroni adjustment.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferroni adjustment for Obs. 1</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9229351</span> <span class="sc">*</span> <span class="dv">97</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 89.5247</code></pre>
</div>
</div>
<p>Since this results in a value greater than 1, and <em>p</em>-values need to be between 0 and 1, we report this <em>p</em>-value as 1. Since this is not statistically significant (at the <span class="math inline">\(\alpha = 0.05\)</span> level), Observation 1 is not considered a regression outlier. Below is the syntax I use to compute the Bonferroni adjusted <em>p</em>-values for each of the 97 observations.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferroni adjustment for all observations</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>out_1 <span class="ot">=</span> out_1 <span class="sc">|&gt;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(t_i), <span class="at">df =</span> <span class="dv">97</span>),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_adj =</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Order data by adjusted p-values</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(out_1, p_adj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["case"],"name":[10],"type":["int"],"align":["right"]},{"label":["country"],"name":[11],"type":["chr"],"align":["left"]},{"label":["t_i"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["p_adj"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"29","2":"10.0","3":"0","4":"70.36001","5":"-41.36001495","6":"0.11617193","7":"13.73703","8":"0.30652975079693","9":"-3.05421500","10":"84","11":"Tajikistan","12":"-3.20260988","13":"0.001842514","14":"0.1787238"},{"1":"19","2":"5.4","3":"1","4":"54.05915","5":"-35.05915051","6":"0.10944088","7":"13.95499","8":"0.20436310851133","9":"-2.57912758","10":"53","11":"Maldives","12":"-2.66219795","13":"0.009088365","14":"0.8815714"},{"1":"57","2":"5.9","3":"1","4":"55.65751","5":"1.34249276","6":"0.08752664","7":"14.48180","8":"0.00022828080037","9":"0.09756739","10":"1","11":"Algeria","12":"0.09704638","13":"0.922889800","14":"1.0000000"},{"1":"66","2":"8.9","3":"1","4":"65.24765","5":"0.75235237","6":"0.02168413","7":"14.48232","8":"0.00001545155047","9":"0.05280616","10":"2","11":"Austria","12":"0.05252227","13":"0.958220563","14":"1.0000000"},{"1":"55","2":"10.5","3":"1","4":"70.36239","5":"-15.36238917","6":"0.03258073","7":"14.39070","8":"0.00989907365212","9":"-1.08431187","10":"3","11":"Azerbaijan","12":"-1.08534894","13":"0.280457185","14":"1.0000000"},{"1":"62","2":"4.6","3":"0","4":"45.91627","5":"16.08372937","6":"0.02012031","7":"14.38313","8":"0.00653143149216","9":"1.12798466","10":"4","11":"Bangladesh","12":"1.12965797","13":"0.261406168","14":"1.0000000"},{"1":"67","2":"10.5","3":"1","4":"70.36239","5":"-3.36238917","6":"0.03258073","7":"14.47815","8":"0.00047421248672","9":"-0.23732496","10":"5","11":"Belgium","12":"-0.23611709","13":"0.813839669","14":"1.0000000"},{"1":"51","2":"9.2","3":"1","4":"66.20666","5":"-15.20666167","6":"0.02128908","7":"14.39360","8":"0.00619243355779","9":"-1.06711071","10":"6","11":"Belize","12":"-1.06791616","13":"0.288208893","14":"1.0000000"},{"1":"16","2":"2.0","3":"0","4":"34.14706","5":"-18.14706039","6":"0.03770633","7":"14.35354","8":"0.01615686917694","9":"-1.28426688","10":"7","11":"Benin","12":"-1.28882323","13":"0.200524864","14":"1.0000000"},{"1":"67","2":"8.4","3":"0","4":"63.11742","5":"3.88257596","6":"0.06905329","7":"14.47646","8":"0.00144717241198","9":"0.27935752","10":"8","11":"Bolivia","12":"0.27796819","13":"0.781628405","14":"1.0000000"},{"1":"46","2":"7.2","3":"1","4":"59.81323","5":"-13.81323474","6":"0.04517860","7":"14.40735","8":"0.01139265369220","9":"-0.98137984","10":"9","11":"Bosnia and Herzegovina","12":"-0.98118313","13":"0.328943379","14":"1.0000000"},{"1":"53","2":"8.7","3":"1","4":"64.60830","5":"-11.60830493","6":"0.02257267","7":"14.43071","8":"0.00383616506057","9":"-0.81513470","10":"10","11":"Botswana","12":"-0.81365222","13":"0.417837035","14":"1.0000000"},{"1":"69","2":"10.6","3":"1","4":"70.68206","5":"-1.68206051","6":"0.03432456","7":"14.48144","8":"0.00012547913178","9":"-0.11883075","10":"11","11":"Bulgaria","12":"-0.11819912","13":"0.906154309","14":"1.0000000"},{"1":"32","2":"1.9","3":"0","4":"33.69440","5":"-1.69439846","6":"0.03921132","7":"14.48142","8":"0.00014693742085","9":"-0.12000640","10":"12","11":"Burkina Faso","12":"-0.11936871","13":"0.905230126","14":"1.0000000"},{"1":"29","2":"2.2","3":"0","4":"35.05238","5":"-6.05238426","6":"0.03488049","7":"14.46829","8":"0.00165279496671","9":"-0.42769952","10":"13","11":"Burundi","12":"-0.42581283","13":"0.671187571","14":"1.0000000"},{"1":"56","2":"3.2","3":"0","4":"39.57900","5":"16.42099642","6":"0.02443396","7":"14.37844","8":"0.00834113411826","9":"1.15418117","10":"14","11":"Cambodia","12":"1.15627021","13":"0.250410525","14":"1.0000000"},{"1":"34","2":"5.1","3":"0","4":"48.17958","5":"-14.17958029","6":"0.02149518","7":"14.40523","8":"0.00543860514842","9":"-0.99514120","10":"15","11":"Cameroon","12":"-0.99508877","13":"0.322168966","14":"1.0000000"},{"1":"85","2":"12.3","3":"1","4":"76.11647","5":"8.88352660","6":"0.08309989","7":"14.45021","8":"0.00939880980238","9":"0.64406131","10":"16","11":"Canada","12":"0.64202268","13":"0.522372861","14":"1.0000000"},{"1":"6","2":"0.6","3":"0","4":"27.80979","5":"-21.80979335","6":"0.06436156","7":"14.29049","8":"0.04213656736991","9":"-1.56530991","10":"17","11":"Chad","12":"-1.57779469","13":"0.117868569","14":"1.0000000"},{"1":"76","2":"9.6","3":"1","4":"67.48535","5":"8.51465295","6":"0.02251282","7":"14.45468","8":"0.00205819830913","9":"0.59788028","10":"18","11":"Chile","12":"0.59580332","13":"0.552694325","14":"1.0000000"},{"1":"81","2":"7.0","3":"1","4":"59.17389","5":"21.82610795","6":"0.05031831","7":"14.29306","8":"0.03202344910366","9":"1.55485566","10":"19","11":"Colombia","12":"1.56697484","13":"0.120377184","14":"1.0000000"},{"1":"20","2":"2.1","3":"0","4":"34.59972","5":"-14.59972233","6":"0.03626272","7":"14.39930","8":"0.01002715861298","9":"-1.03244775","10":"20","11":"Congo, Democratic Republic","12":"-1.03281799","13":"0.304257307","14":"1.0000000"},{"1":"78","2":"8.4","3":"1","4":"63.64929","5":"14.35070910","6":"0.02484324","7":"14.40307","8":"0.00648263772796","9":"1.00887871","10":"21","11":"Costa Rica","12":"1.00897652","13":"0.315496193","14":"1.0000000"},{"1":"69","2":"10.5","3":"1","4":"70.36239","5":"-1.36238917","6":"0.03258073","7":"14.48182","8":"0.00007785372425","9":"-0.09616048","10":"22","11":"Croatia","12":"-0.09564685","13":"0.923998379","14":"1.0000000"},{"1":"86","2":"12.1","3":"1","4":"75.47713","5":"10.52286930","6":"0.07548610","7":"14.43752","8":"0.01178295211681","9":"0.75976672","10":"23","11":"Czech Republic","12":"0.75802709","13":"0.450272502","14":"1.0000000"},{"1":"70","2":"7.7","3":"1","4":"61.41159","5":"8.58840853","6":"0.03451743","7":"14.45384","8":"0.00329094527618","9":"0.60679681","10":"24","11":"Dominican Republic","12":"0.60472393","13":"0.546774446","14":"1.0000000"},{"1":"80","2":"7.4","3":"1","4":"60.45258","5":"19.54742257","6":"0.04053903","7":"14.33231","8":"0.02027418356292","9":"1.38541109","10":"25","11":"Ecuador","12":"1.39238567","13":"0.166989425","14":"1.0000000"},{"1":"59","2":"5.3","3":"0","4":"49.08490","5":"9.91509585","6":"0.02247477","7":"14.44475","8":"0.00278598528738","9":"0.69620276","10":"26","11":"Egypt, Arab Republic","12":"0.69426116","13":"0.489177896","14":"1.0000000"},{"1":"72","2":"6.1","3":"0","4":"52.70620","5":"19.29380040","6":"0.02884826","7":"14.33798","8":"0.01371913246726","9":"1.35918023","10":"27","11":"El Salvador","12":"1.36548321","13":"0.175259460","14":"1.0000000"},{"1":"40","2":"1.4","3":"0","4":"31.43109","5":"8.56891120","6":"0.04765693","7":"14.45358","8":"0.00464874899240","9":"0.60958145","10":"28","11":"Ethiopia","12":"0.60751017","13":"0.544932009","14":"1.0000000"},{"1":"78","2":"10.9","3":"1","4":"71.64107","5":"6.35892545","6":"0.04030625","7":"14.46672","8":"0.00213216206873","9":"0.45063012","10":"29","11":"France","12":"0.44869096","13":"0.654655367","14":"1.0000000"},{"1":"31","2":"5.9","3":"0","4":"51.80088","5":"-20.80087574","6":"0.02688662","7":"14.31471","8":"0.01480192536888","9":"-1.46387068","10":"30","11":"Ghana","12":"-1.47304913","13":"0.143975414","14":"1.0000000"},{"1":"76","2":"9.9","3":"1","4":"68.44436","5":"7.55563891","6":"0.02474348","7":"14.46056","8":"0.00178941505069","9":"0.53114681","10":"31","11":"Greece","12":"0.52908657","13":"0.597954095","14":"1.0000000"},{"1":"9","2":"0.8","3":"0","4":"28.71512","5":"-19.71511721","6":"0.05981713","7":"14.32656","8":"0.03169168064474","9":"-1.41154917","10":"32","11":"Guinea","12":"-1.41922503","13":"0.159038939","14":"1.0000000"},{"1":"34","2":"3.2","3":"0","4":"39.57900","5":"-5.57900358","6":"0.02443396","7":"14.47056","8":"0.00096280729288","9":"-0.39213095","10":"33","11":"Haiti","12":"-0.39033984","13":"0.697141148","14":"1.0000000"},{"1":"73","2":"5.3","3":"0","4":"49.08490","5":"23.91509585","6":"0.02247477","7":"14.26129","8":"0.01620799284848","9":"1.67923297","10":"34","11":"Honduras","12":"1.69609169","13":"0.093075807","14":"1.0000000"},{"1":"62","2":"11.2","3":"1","4":"72.60009","5":"-10.60008859","6":"0.04741325","7":"14.43821","8":"0.00707384144150","9":"-0.75398037","10":"35","11":"Hungary","12":"-0.75221835","13":"0.453741251","14":"1.0000000"},{"1":"54","2":"3.2","3":"0","4":"39.57900","5":"14.42099642","6":"0.02443396","7":"14.40232","8":"0.00643304559603","9":"1.01360734","10":"36","11":"India","12":"1.01375831","13":"0.313220131","14":"1.0000000"},{"1":"61","2":"6.9","3":"0","4":"56.32750","5":"4.67250494","6":"0.03914994","7":"14.47401","8":"0.00111548832238","9":"0.33092134","10":"37","11":"Indonesia","12":"0.32933134","13":"0.742615318","14":"1.0000000"},{"1":"53","2":"4.4","3":"1","4":"50.86244","5":"2.13756295","6":"0.16264695","7":"14.48049","8":"0.00127706254622","9":"0.16216884","10":"38","11":"Iraq","12":"0.16131742","13":"0.872178921","14":"1.0000000"},{"1":"65","2":"9.7","3":"1","4":"67.80502","5":"-2.80501840","6":"0.02313134","7":"14.47952","8":"0.00022979757128","9":"-0.19702459","10":"39","11":"Italy","12":"-0.19600337","13":"0.845017562","14":"1.0000000"},{"1":"73","2":"9.8","3":"1","4":"68.12469","5":"4.87531026","6":"0.02387489","7":"14.47340","8":"0.00071759695643","9":"0.34257237","10":"40","11":"Jamaica","12":"0.34094079","13":"0.733885525","14":"1.0000000"},{"1":"40","2":"11.2","3":"1","4":"72.60009","5":"-32.60008859","6":"0.04741325","7":"14.05764","8":"0.06690735966056","9":"-2.31883222","10":"41","11":"Japan","12":"-2.37604214","13":"0.019464279","14":"1.0000000"},{"1":"52","2":"9.4","3":"1","4":"66.84600","5":"-14.84600436","6":"0.02165088","7":"14.39775","8":"0.00600693030058","9":"-1.04199460","10":"42","11":"Jordan","12":"-1.04248056","13":"0.299780188","14":"1.0000000"},{"1":"55","2":"10.2","3":"1","4":"69.40338","5":"-14.40337513","6":"0.02809945","7":"14.40222","8":"0.00743581179799","9":"-1.01427605","10":"43","11":"Kazakhstan","12":"-1.01443460","13":"0.312899112","14":"1.0000000"},{"1":"61","2":"5.4","3":"0","4":"49.53757","5":"11.46243392","6":"0.02305664","7":"14.43198","8":"0.00382433987328","9":"0.80509099","10":"44","11":"Kenya","12":"0.80355597","13":"0.423618240","14":"1.0000000"},{"1":"80","2":"11.1","3":"1","4":"72.28042","5":"7.71958276","6":"0.04491922","7":"14.45911","8":"0.00353578041483","9":"0.54837366","10":"45","11":"Korea, Republic","12":"0.54630139","13":"0.586113156","14":"1.0000000"},{"1":"54","2":"3.8","3":"0","4":"42.29498","5":"11.70502483","6":"0.02111218","7":"14.42992","8":"0.00363711949810","9":"0.82131299","10":"46","11":"Lao PDR","12":"0.81986416","13":"0.414303597","14":"1.0000000"},{"1":"55","2":"7.6","3":"1","4":"61.09192","5":"-6.09192013","6":"0.03639960","7":"14.46808","8":"0.00175289818200","9":"-0.43083257","10":"47","11":"Lebanon","12":"-0.42893827","13":"0.668919274","14":"1.0000000"},{"1":"60","2":"6.8","3":"0","4":"55.87483","5":"4.12516687","6":"0.03764741","7":"14.47590","8":"0.00083348023442","9":"0.29192899","10":"48","11":"Lesotho","12":"0.29048837","13":"0.772062794","14":"1.0000000"},{"1":"31","2":"2.3","3":"0","4":"35.50505","5":"-4.50504619","6":"0.03355963","7":"14.47466","8":"0.00087864051525","9":"-0.31813726","10":"49","11":"Liberia","12":"-0.31659454","13":"0.752231609","14":"1.0000000"},{"1":"48","2":"4.8","3":"0","4":"46.82159","5":"1.17840551","6":"0.02048613","7":"14.48201","8":"0.00003572513002","9":"0.08265941","10":"50","11":"Madagascar","12":"0.08221682","13":"0.934643715","14":"1.0000000"},{"1":"59","2":"3.4","3":"0","4":"40.48433","5":"18.51567256","6":"0.02308119","7":"14.35024","8":"0.00999000725509","9":"1.30050812","10":"51","11":"Malawi","12":"1.30542208","13":"0.194837064","14":"1.0000000"},{"1":"52","2":"9.2","3":"1","4":"66.20666","5":"-14.20666167","6":"0.02128908","7":"14.40495","8":"0.00540477556255","9":"-0.99693682","10":"52","11":"Malaysia","12":"-0.99690367","13":"0.321291669","14":"1.0000000"},{"1":"16","2":"1.4","3":"0","4":"31.43109","5":"-15.43108880","6":"0.04765693","7":"14.38841","8":"0.01507571622679","9":"-1.09774804","10":"54","11":"Mali","12":"-1.09897343","13":"0.274499871","14":"1.0000000"},{"1":"86","2":"9.5","3":"1","4":"67.16568","5":"18.83432430","6":"0.02201933","7":"14.34578","8":"0.00983986812606","9":"1.32217129","10":"55","11":"Malta","12":"1.32758020","13":"0.187432778","14":"1.0000000"},{"1":"64","2":"8.0","3":"1","4":"62.37061","5":"1.62939449","6":"0.02962115","7":"14.48151","8":"0.00010062765093","9":"0.11483080","10":"56","11":"Mauritius","12":"0.11421986","13":"0.909299597","14":"1.0000000"},{"1":"67","2":"8.1","3":"1","4":"62.69028","5":"4.30972314","6":"0.02823912","7":"14.47537","8":"0.00066923199307","9":"0.30350963","10":"57","11":"Mexico","12":"0.30202307","13":"0.763281092","14":"1.0000000"},{"1":"60","2":"9.6","3":"0","4":"68.54937","5":"-8.54936722","6":"0.10291920","7":"14.45193","8":"0.01126281231586","9":"-0.62664417","10":"58","11":"Moldova","12":"-0.62458603","13":"0.533709179","14":"1.0000000"},{"1":"55","2":"8.5","3":"0","4":"63.57009","5":"-8.57008597","6":"0.07153787","7":"14.45282","8":"0.00734384659740","9":"-0.61745583","10":"59","11":"Mongolia","12":"-0.61538989","13":"0.539738433","14":"1.0000000"},{"1":"71","2":"3.2","3":"0","4":"39.57900","5":"31.42099642","6":"0.02443396","7":"14.09766","8":"0.03053978659046","9":"2.20848488","10":"60","11":"Morocco","12":"2.25654867","13":"0.026280726","14":"1.0000000"},{"1":"27","2":"0.8","3":"0","4":"28.71512","5":"-1.71511721","6":"0.05981713","7":"14.48137","8":"0.00023984692449","9":"-0.12279776","10":"61","11":"Mozambique","12":"-0.12214568","13":"0.903036347","14":"1.0000000"},{"1":"56","2":"6.3","3":"1","4":"56.93619","5":"-0.93619263","6":"0.07224585","7":"14.48219","8":"0.00008863866274","9":"-0.06747635","10":"62","11":"Namibia","12":"-0.06711424","13":"0.946628904","14":"1.0000000"},{"1":"53","2":"2.4","3":"0","4":"35.95771","5":"17.04229188","6":"0.03230016","7":"14.36947","8":"0.01207049109980","9":"1.20270877","10":"63","11":"Nepal","12":"1.20563802","13":"0.230889860","14":"1.0000000"},{"1":"80","2":"4.8","3":"0","4":"46.82159","5":"33.17840551","6":"0.02048613","7":"14.05448","8":"0.02832013440911","9":"2.32730353","10":"64","11":"Nicaragua","12":"2.38525822","13":"0.019010365","14":"1.0000000"},{"1":"11","2":"0.8","3":"0","4":"28.71512","5":"-17.71511721","6":"0.05981713","7":"14.35673","8":"0.02558789762288","9":"-1.26835457","10":"65","11":"Niger","12":"-1.27257158","13":"0.206212035","14":"1.0000000"},{"1":"28","2":"4.2","3":"0","4":"44.10562","5":"-16.10562290","6":"0.02012522","7":"14.38286","8":"0.00655088899947","9":"-1.12952293","10":"66","11":"Nigeria","12":"-1.13121994","13":"0.260751577","14":"1.0000000"},{"1":"34","2":"3.3","3":"0","4":"40.03167","5":"-6.03166551","6":"0.02372688","7":"14.46855","8":"0.00109123467663","9":"-0.42379360","10":"67","11":"Pakistan","12":"-0.42191658","13":"0.674019535","14":"1.0000000"},{"1":"63","2":"9.6","3":"1","4":"67.48535","5":"-4.48534705","6":"0.02251282","7":"14.47481","8":"0.00057114373643","9":"-0.31495125","10":"68","11":"Panama","12":"-0.31342058","13":"0.754634113","14":"1.0000000"},{"1":"68","2":"7.5","3":"1","4":"60.77225","5":"7.22775122","6":"0.03840680","7":"14.46214","8":"0.00261443202998","9":"0.51169399","10":"69","11":"Paraguay","12":"0.50965345","13":"0.611451867","14":"1.0000000"},{"1":"54","2":"8.8","3":"0","4":"64.92807","5":"-10.92807177","6":"0.07935988","7":"14.43378","8":"0.01347267713365","9":"-0.79068118","10":"70","11":"Philippines","12":"-0.78907540","13":"0.431992393","14":"1.0000000"},{"1":"74","2":"8.0","3":"1","4":"62.37061","5":"11.62939449","6":"0.02962115","7":"14.43014","8":"0.00512600533948","9":"0.81957604","10":"71","11":"Portugal","12":"0.81811765","13":"0.415295219","14":"1.0000000"},{"1":"70","2":"10.4","3":"1","4":"70.04272","5":"-0.04271782","6":"0.03096194","7":"14.48254","8":"0.00000007249537","9":"-0.00301260","10":"72","11":"Romania","12":"-0.00299636","13":"0.997615408","14":"1.0000000"},{"1":"53","2":"3.1","3":"0","4":"39.12634","5":"13.87365835","6":"0.02520241","7":"14.40825","8":"0.00615093010969","9":"0.97552092","10":"73","11":"Rwanda","12":"0.97526463","13":"0.331854939","14":"1.0000000"},{"1":"41","2":"4.0","3":"0","4":"43.20030","5":"-2.20029903","6":"0.02049595","7":"14.48069","8":"0.00012461334433","9":"-0.15434103","10":"74","11":"Sao Tome and Principe","12":"-0.15352866","13":"0.878300337","14":"1.0000000"},{"1":"28","2":"3.4","3":"0","4":"40.48433","5":"-12.48432744","6":"0.02308119","7":"14.42255","8":"0.00454168617516","9":"-0.87687710","10":"75","11":"Senegal","12":"-0.87577790","13":"0.383314349","14":"1.0000000"},{"1":"58","2":"9.2","3":"1","4":"66.20666","5":"-8.20666167","6":"0.02128908","7":"14.45669","8":"0.00180354360596","9":"-0.57589343","10":"76","11":"Serbia","12":"-0.57381293","13":"0.567422529","14":"1.0000000"},{"1":"23","2":"2.0","3":"0","4":"34.14706","5":"-11.14706039","6":"0.03770633","7":"14.43400","8":"0.00609628620135","9":"-0.78887711","10":"77","11":"Sierra Leone","12":"-0.78726285","13":"0.433047415","14":"1.0000000"},{"1":"80","2":"11.6","3":"1","4":"73.87877","5":"6.12122603","6":"0.05863973","7":"14.46760","8":"0.00298746435564","9":"0.43798910","10":"78","11":"Slovak Republic","12":"0.43607794","13":"0.663749181","14":"1.0000000"},{"1":"79","2":"11.8","3":"1","4":"74.51812","5":"4.48188334","6":"0.06500318","7":"14.47448","8":"0.00179962103197","9":"0.32177944","10":"79","11":"Slovenia","12":"0.32022308","13":"0.749488001","14":"1.0000000"},{"1":"55","2":"9.8","3":"1","4":"68.12469","5":"-13.12468974","6":"0.02387489","7":"14.41617","8":"0.00520060850698","9":"-0.92222973","10":"80","11":"South Africa","12":"-0.92148137","13":"0.359085381","14":"1.0000000"},{"1":"71","2":"9.5","3":"1","4":"67.16568","5":"3.83432430","6":"0.02201933","7":"14.47690","8":"0.00040781845317","9":"0.26916992","10":"81","11":"Spain","12":"0.26782320","13":"0.789404091","14":"1.0000000"},{"1":"48","2":"7.3","3":"1","4":"60.13291","5":"-12.13290609","6":"0.04279630","7":"14.42471","8":"0.00828462341030","9":"-0.86092529","10":"82","11":"Suriname","12":"-0.85971689","13":"0.392064909","14":"1.0000000"},{"1":"66","2":"7.4","3":"0","4":"58.59080","5":"7.40919528","6":"0.04758327","7":"14.46089","8":"0.00346966865618","9":"0.52706035","10":"83","11":"Swaziland","12":"0.52500372","13":"0.600778525","14":"1.0000000"},{"1":"38","2":"4.5","3":"0","4":"45.46361","5":"-7.46360869","6":"0.02002947","7":"14.46119","8":"0.00139986730463","9":"-0.52341380","10":"85","11":"Tanzania","12":"-0.52136063","13":"0.603303896","14":"1.0000000"},{"1":"78","2":"7.0","3":"1","4":"59.17389","5":"18.82610795","6":"0.05031831","7":"14.34181","8":"0.02382520233611","9":"1.34114065","10":"86","11":"Thailand","12":"1.34700009","13":"0.181118724","14":"1.0000000"},{"1":"20","2":"3.3","3":"0","4":"40.03167","5":"-20.03166551","6":"0.02372688","7":"14.32747","8":"0.01203587805388","9":"-1.40745400","10":"87","11":"Togo","12":"-1.41501785","13":"0.160265625","14":"1.0000000"},{"1":"63","2":"5.5","3":"0","4":"49.99023","5":"13.00977199","6":"0.02369988","7":"14.41734","8":"0.00507065893877","9":"0.91407289","10":"88","11":"Tunisia","12":"0.91325692","13":"0.363371810","14":"1.0000000"},{"1":"42","2":"4.3","3":"0","4":"44.55828","5":"-2.55828483","6":"0.02003193","7":"14.48003","8":"0.00016449107696","9":"-0.17940963","10":"89","11":"Uganda","12":"-0.17847334","13":"0.858723478","14":"1.0000000"},{"1":"65","2":"11.2","3":"0","4":"75.79196","5":"-10.79195814","6":"0.16182241","7":"14.43030","8":"0.03232307841633","9":"-0.81834238","10":"90","11":"Ukraine","12":"-0.81687724","13":"0.416000351","14":"1.0000000"},{"1":"84","2":"12.8","3":"1","4":"77.71483","5":"6.28516987","6":"0.10432246","7":"14.46598","8":"0.00618947954389","9":"0.46104572","10":"91","11":"United Kingdom","12":"0.45908523","13":"0.647200080","14":"1.0000000"},{"1":"80","2":"8.7","3":"1","4":"64.60830","5":"15.39169507","6":"0.02257267","7":"14.39130","8":"0.00674423308034","9":"1.08080421","10":"92","11":"Uruguay","12":"1.08179319","13":"0.282026506","14":"1.0000000"},{"1":"75","2":"8.7","3":"1","4":"64.60830","5":"10.39169507","6":"0.02257267","7":"14.44102","8":"0.00307420240687","9":"0.72970441","10":"93","11":"Venezuela, RB","12":"0.72785732","13":"0.468454265","14":"1.0000000"},{"1":"76","2":"5.2","3":"0","4":"48.63224","5":"27.36775778","6":"0.02195429","7":"14.19225","8":"0.02071214603456","9":"1.92115522","10":"94","11":"Vietnam","12":"1.94988213","13":"0.054077458","14":"1.0000000"},{"1":"34","2":"1.2","3":"0","4":"30.52576","5":"3.47423506","6":"0.05146482","7":"14.47776","8":"0.00083189318997","9":"0.24764827","10":"95","11":"Yemen, Republic","12":"0.24639448","13":"0.805897545","14":"1.0000000"},{"1":"49","2":"5.8","3":"0","4":"51.34821","5":"-2.34821381","6":"0.02599787","7":"14.48042","8":"0.00018207018207","9":"-0.16518115","10":"96","11":"Zambia","12":"-0.16431479","13":"0.869825252","14":"1.0000000"},{"1":"67","2":"6.7","3":"0","4":"55.42217","5":"11.57782880","6":"0.03620625","7":"14.43025","8":"0.00629528280894","9":"0.81872469","10":"97","11":"Zimbabwe","12":"0.81726163","13":"0.415781761","14":"1.0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>These results indicate that none of the observations are more extreme than would be expected given the sample size. In other words, the test would not identify any observations as regression outliers.</p>
<p><br></p>
</section>
</section>
</section>
<section id="measuring-influence" class="level1">
<h1>Measuring Influence</h1>
<p>Recall that an influential observation is an observation that has a large impact on the values of the regression coefficients. There have been several methods proposed to measure influence. Here we will look at a few of those methods.</p>
<p><br></p>
<section id="dfbetas" class="level2">
<h2 class="anchored" data-anchor-id="dfbetas">DFBETAS</h2>
<p>The most direct way to measure the influence of an observation is to drop that observation from the dataset and measure the difference in regression coefficients. We can define this difference as <span class="math inline">\(d_{ij}\)</span> (the difference between the <em>j</em>th regression coefficient when the <em>i</em>th observation is dropped) as:</p>
<p><span class="math display">\[
d_{ij} = \hat{\beta}_j - \hat{\beta}_{j(-i)}
\]</span></p>
<p>These are referred to as DFBETAs following the naming convention set by <span class="citation" data-cites="Belsley:1980">Belsley, Kuh, &amp; Welsch (<a href="#ref-Belsley:1980" role="doc-biblioref">1980</a>)</span>. The <code>dfbeta()</code> function computes the DFBETA values for each coefficient for all observations. This function takes the fitted model object as its input. (Here we pipe this output into a data frame for better screen printing in the notes.)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfbeta</span>(lm<span class="fl">.1</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X.Intercept."],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["educ_female.high_gni"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"-5.506044e-16","2":"1.117983e-16","3":"0.305434363","4":"-0.0299422430","_rn_":"1"},{"1":"2.659737e-17","2":"-3.320266e-18","3":"0.027600534","4":"-0.0012275087","_rn_":"2"},{"1":"-1.761529e-15","2":"3.428031e-16","3":"0.884314292","4":"-0.1334941558","_rn_":"3"},{"1":"2.843749e-01","2":"9.973825e-03","3":"-0.284374901","4":"-0.0099738248","_rn_":"4"},{"1":"-1.958969e-17","2":"0.000000e+00","3":"0.193551196","4":"-0.0292180662","_rn_":"5"},{"1":"2.070035e-17","2":"6.708264e-18","3":"-0.290848803","4":"-0.0043401015","_rn_":"6"},{"1":"-9.890961e-01","2":"1.390126e-01","3":"0.989096139","4":"-0.1390126107","_rn_":"7"},{"1":"-1.418416e-01","2":"5.117060e-02","3":"0.141841614","4":"-0.0511705953","_rn_":"8"},{"1":"-1.719658e-16","2":"4.996822e-17","3":"-1.926866474","4":"0.1768438267","_rn_":"9"},{"1":"-1.040562e-16","2":"2.051044e-17","3":"-0.562197691","4":"0.0338064252","_rn_":"10"},{"1":"1.062010e-17","2":"-4.512242e-18","3":"0.106970012","4":"-0.0157319062","_rn_":"11"},{"1":"-9.487940e-02","2":"1.354121e-02","3":"0.094879404","4":"-0.0135412113","_rn_":"12"},{"1":"-3.119725e-01","2":"4.237847e-02","3":"0.311972499","4":"-0.0423784680","_rn_":"13"},{"1":"6.099708e-01","2":"-6.209117e-02","3":"-0.609970839","4":"0.0620911695","_rn_":"14"},{"1":"-1.531780e-01","2":"-3.104119e-02","3":"0.153178047","4":"0.0310411906","_rn_":"15"},{"1":"-1.151681e-16","2":"3.346448e-17","3":"-1.537721805","4":"0.1904754297","_rn_":"16"},{"1":"-1.663461e+00","2":"2.719807e-01","3":"1.663460512","4":"-0.2719807369","_rn_":"17"},{"1":"3.500797e-17","2":"-7.051603e-18","3":"-0.036370422","4":"0.0242160503","_rn_":"18"},{"1":"0.000000e+00","2":"0.000000e+00","3":"3.324181371","4":"-0.3096769079","_rn_":"19"},{"1":"-7.740930e-01","2":"1.070222e-01","3":"0.774093016","4":"-0.1070221810","_rn_":"20"},{"1":"8.746572e-17","2":"-2.541497e-17","3":"0.949325059","4":"-0.0694909780","_rn_":"21"},{"1":"-7.937447e-18","2":"0.000000e+00","3":"0.078424013","4":"-0.0118387179","_rn_":"22"},{"1":"1.283054e-16","2":"0.000000e+00","3":"-1.676194531","4":"0.2095356712","_rn_":"23"},{"1":"-5.013749e-17","2":"0.000000e+00","3":"0.930232256","4":"-0.0809329750","_rn_":"24"},{"1":"2.421760e-16","2":"-7.036924e-17","3":"2.480347677","4":"-0.2235719332","_rn_":"25"},{"1":"7.981224e-02","2":"2.795296e-02","3":"-0.079812241","4":"-0.0279529611","_rn_":"26"},{"1":"-5.838447e-02","2":"1.035264e-01","3":"0.058384473","4":"-0.1035263532","_rn_":"27"},{"1":"5.448557e-01","2":"-8.289445e-02","3":"-0.544855653","4":"0.0828944480","_rn_":"28"},{"1":"-3.938130e-17","2":"1.144305e-17","3":"-0.520688515","4":"0.0722713331","_rn_":"29"},{"1":"5.064284e-03","2":"-9.826809e-02","3":"-0.005064284","4":"0.0982680935","_rn_":"30"},{"1":"-2.361787e-17","2":"1.003470e-17","3":"-0.165376727","4":"0.0360679552","_rn_":"31"},{"1":"-1.439772e+00","2":"2.317999e-01","3":"1.439772232","4":"-0.2317999186","_rn_":"32"},{"1":"-2.072365e-01","2":"2.109536e-02","3":"0.207236480","4":"-0.0210953616","_rn_":"33"},{"1":"1.925062e-01","2":"6.742222e-02","3":"-0.192506197","4":"-0.0674222170","_rn_":"34"},{"1":"-6.271903e-17","2":"0.000000e+00","3":"1.065516502","4":"-0.1422425380","_rn_":"35"},{"1":"5.356793e-01","2":"-5.452876e-02","3":"-0.535679264","4":"0.0545287576","_rn_":"36"},{"1":"-6.684626e-02","2":"3.727942e-02","3":"0.066846265","4":"-0.0372794179","_rn_":"37"},{"1":"6.068890e-17","2":"-1.763441e-17","3":"0.749118332","4":"-0.0758907733","_rn_":"38"},{"1":"-1.460224e-17","2":"2.479478e-18","3":"0.028424337","4":"-0.0097777886","_rn_":"39"},{"1":"-7.037706e-18","2":"0.000000e+00","3":"-0.078028084","4":"0.0201298504","_rn_":"40"},{"1":"-1.928895e-16","2":"0.000000e+00","3":"3.276947363","4":"-0.4374604326","_rn_":"41"},{"1":"5.578566e-17","2":"-1.310317e-17","3":"-0.110348375","4":"-0.0232121148","_rn_":"42"},{"1":"2.275958e-18","2":"-1.279685e-17","3":"0.570817338","4":"-0.0967887948","_rn_":"43"},{"1":"7.647221e-02","2":"3.593524e-02","3":"-0.076472205","4":"-0.0359352392","_rn_":"44"},{"1":"-9.607771e-17","2":"2.791736e-17","3":"-0.727680745","4":"0.0982654987","_rn_":"45"},{"1":"3.363947e-01","2":"-2.209116e-02","3":"-0.336394733","4":"0.0220911563","_rn_":"46"},{"1":"-3.883641e-18","2":"2.183624e-17","3":"-0.697305200","4":"0.0614717745","_rn_":"47"},{"1":"-5.313292e-02","2":"3.154562e-02","3":"0.053132921","4":"-0.0315456166","_rn_":"48"},{"1":"-2.255996e-01","2":"3.007042e-02","3":"0.225599650","4":"-0.0300704163","_rn_":"49"},{"1":"1.759258e-02","2":"1.469433e-03","3":"-0.017592583","4":"-0.0014694330","_rn_":"50"},{"1":"6.356182e-01","2":"-5.828158e-02","3":"-0.635618161","4":"0.0582815752","_rn_":"51"},{"1":"1.933908e-17","2":"6.267124e-18","3":"-0.271722395","4":"-0.0040546936","_rn_":"52"},{"1":"8.875503e-16","2":"0.000000e+00","3":"-9.299314822","4":"0.9242394241","_rn_":"53"},{"1":"-9.811884e-01","2":"1.492782e-01","3":"0.981188364","4":"-0.1492781940","_rn_":"54"},{"1":"-4.613020e-17","2":"1.143281e-17","3":"0.029817683","4":"0.0414988376","_rn_":"55"},{"1":"9.979846e-18","2":"-2.899850e-18","3":"0.146761088","4":"-0.0121279080","_rn_":"56"},{"1":"0.000000e+00","2":"0.000000e+00","3":"0.362244594","4":"-0.0292598962","_rn_":"57"},{"1":"4.786195e-01","2":"-1.520272e-01","3":"-0.478619451","4":"0.1520271750","_rn_":"58"},{"1":"3.263972e-01","2":"-1.160848e-01","3":"-0.326397236","4":"0.1160848324","_rn_":"59"},{"1":"1.167158e+00","2":"-1.188093e-01","3":"-1.167157647","4":"0.1188092589","_rn_":"60"},{"1":"-1.252530e-01","2":"2.016544e-02","3":"0.125253028","4":"-0.0201654408","_rn_":"61"},{"1":"-2.399005e-17","2":"6.970806e-18","3":"-0.186384854","4":"0.0180129969","_rn_":"62"},{"1":"8.285264e-01","2":"-1.082017e-01","3":"-0.828526415","4":"0.1082016649","_rn_":"63"},{"1":"4.953251e-01","2":"4.137238e-02","3":"-0.495325133","4":"-0.0413723826","_rn_":"64"},{"1":"-1.293715e+00","2":"2.082850e-01","3":"1.293714543","4":"-0.2082849767","_rn_":"65"},{"1":"-3.735811e-01","2":"1.018922e-02","3":"0.373581124","4":"-0.0101892181","_rn_":"66"},{"1":"-2.155423e-01","2":"2.089441e-02","3":"0.215542306","4":"-0.0208944072","_rn_":"67"},{"1":"-1.844149e-17","2":"3.714642e-18","3":"0.019159203","4":"-0.0127565258","_rn_":"68"},{"1":"2.308679e-18","2":"-1.298083e-17","3":"0.872065197","4":"-0.0777844084","_rn_":"69"},{"1":"4.678457e-01","2":"-1.602107e-01","3":"-0.467845723","4":"0.1602106589","_rn_":"70"},{"1":"7.122865e-17","2":"-2.069696e-17","3":"1.047470453","4":"-0.0865599014","_rn_":"71"},{"1":"2.620035e-19","2":"-7.613054e-20","3":"0.002202570","4":"-0.0003430246","_rn_":"72"},{"1":"5.349811e-01","2":"-5.686828e-02","3":"-0.534981114","4":"0.0568682775","_rn_":"73"},{"1":"-5.712608e-02","2":"2.771303e-03","3":"0.057126075","4":"-0.0027713033","_rn_":"74"},{"1":"-4.285702e-01","2":"3.929678e-02","3":"0.428570187","4":"-0.0392967777","_rn_":"75"},{"1":"1.117147e-17","2":"3.620285e-18","3":"-0.156963952","4":"-0.0023422461","_rn_":"76"},{"1":"-6.075648e-01","2":"8.539025e-02","3":"0.607564760","4":"-0.0853902469","_rn_":"77"},{"1":"0.000000e+00","2":"0.000000e+00","3":"-0.771513772","4":"0.0993810833","_rn_":"78"},{"1":"-1.694665e-16","2":"4.139149e-17","3":"-0.623609346","4":"0.0792542730","_rn_":"79"},{"1":"1.894602e-17","2":"0.000000e+00","3":"0.210057275","4":"-0.0541910212","_rn_":"80"},{"1":"-9.391267e-18","2":"2.327512e-18","3":"0.006070336","4":"0.0084484051","_rn_":"81"},{"1":"-1.545642e-16","2":"6.567081e-17","3":"-1.615708833","4":"0.1470205679","_rn_":"82"},{"1":"-1.594836e-01","2":"7.157448e-02","3":"0.159483601","4":"-0.0715744793","_rn_":"83"},{"1":"2.603053e+00","2":"-8.039487e-01","3":"-2.603053159","4":"0.8039486898","_rn_":"84"},{"1":"-1.422400e-01","2":"-2.290575e-03","3":"0.142240016","4":"0.0022905747","_rn_":"85"},{"1":"0.000000e+00","2":"0.000000e+00","3":"2.867272419","4":"-0.2671117961","_rn_":"86"},{"1":"-7.158340e-01","2":"6.939207e-02","3":"0.715834021","4":"-0.0693920735","_rn_":"87"},{"1":"6.885061e-02","2":"4.490257e-02","3":"-0.068850611","4":"-0.0449025724","_rn_":"88"},{"1":"-5.580884e-02","2":"8.171837e-04","3":"0.055808838","4":"-0.0008171837","_rn_":"89"},{"1":"9.249268e-01","2":"-2.686135e-01","3":"-0.924926763","4":"0.2686135450","_rn_":"90"},{"1":"-8.772379e-17","2":"4.847480e-17","3":"-1.314549909","4":"0.1598909357","_rn_":"91"},{"1":"1.379703e-16","2":"-2.719522e-17","3":"0.745429714","4":"-0.0448246484","_rn_":"92"},{"1":"9.315060e-17","2":"-1.836084e-17","3":"0.503276491","4":"-0.0302633385","_rn_":"93"},{"1":"2.579832e-01","2":"6.852760e-02","3":"-0.257983213","4":"-0.0685275959","_rn_":"94"},{"1":"2.316929e-01","2":"-3.599230e-02","3":"-0.231692856","4":"0.0359923019","_rn_":"95"},{"1":"-2.685758e-03","2":"-1.034350e-02","3":"0.002685758","4":"0.0103434982","_rn_":"96"},{"1":"-1.326732e-01","2":"8.471798e-02","3":"0.132673221","4":"-0.0847179785","_rn_":"97"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Positive DFBETA values indicate that removing the observation results in a lower regression coefficient value, while a negative DFBETA value would indicate that removing the observation results in a higher regression coefficient value. For example, focusing on the interaction term, we see that removing Observation 1 would result in a higher value on the interaction coefficient by .0299 units.</p>
<p>Because the DFBETA values are in the same unit as the coefficients, it can sometimes be difficult to assess whether those values are indicative of a small or large amount of influence. To remedy this, the DFBETA values are typically scaled. To do this, the DFBETA value is divided by a scaled RMSE estimate,</p>
<p><span class="math display">\[
d^*_{ij} = \frac{d_{ij}}{s_{e(-i)}\sqrt{c_{jj}}}
\]</span></p>
<p>where <span class="math inline">\(s_{e(-i)}\)</span> is the RMSE estimate when the <em>i</em>th observation is deleted from the model, and <span class="math inline">\(c_{jj}\)</span> is the <em>j</em>th diagonal element of the <span class="math inline">\((\mathbf{XX}^\intercal)^{-1}\)</span> matrix corresponding to the appropriate regression coefficient. For example, here we compute the <span class="math inline">\((\mathbf{XX}^\intercal)^{-1}\)</span> matrix for the fitted model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">model.matrix</span>(lm<span class="fl">.1</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     (Intercept)  educ_female    high_gni educ_female:high_gni
(Intercept)           0.07946790 -0.013509292 -0.07946790          0.013509292
educ_female          -0.01350929  0.003068899  0.01350929         -0.003068899
high_gni             -0.07946790  0.013509292  0.62476222         -0.070745716
educ_female:high_gni  0.01350929 -0.003068899 -0.07074572          0.009320611</code></pre>
</div>
</div>
<p>The <span class="math inline">\(c_{jj}\)</span> value corresponding to the interaction term is 0.009320611.</p>
<p>Again, using the <code>.sigma</code> value from the augmented output to obtain <span class="math inline">\(s_{e(-i)}\)</span>, we can compute the scaled DFBETA value for the interaction term based on the first observation as:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute scaled DFBETA for interaction term (Obs. 1)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.0299422430</span> <span class="sc">/</span> (<span class="fl">14.5</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fl">0.009320611</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.02138918</code></pre>
</div>
</div>
<p>Removing Observation 1 would result in a higher value on the interaction coefficient by .0214 standard deviation units. We can use the <code>dfbetas()</code> function to compute all the scaled DFBETA values. (Here we pipe this output into a data frame for better screen printing in the notes.)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get scaled DFBETA values</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dfbetas</span>(lm<span class="fl">.1</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X.Intercept."],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["educ_female.high_gni"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"-1.348719e-16","2":"1.393546e-16","3":"0.0266832052","4":"-0.0214160621","_rn_":"1"},{"1":"6.514853e-18","2":"-4.138504e-18","3":"0.0024111369","4":"-0.0008779386","_rn_":"2"},{"1":"-4.342220e-16","2":"4.300030e-16","3":"0.0777440666","4":"-0.0960855429","_rn_":"3"},{"1":"7.013616e-02","2":"1.251748e-02","3":"-0.0250138461","4":"-0.0071826736","_rn_":"4"},{"1":"-4.799749e-18","2":"0.000000e+00","3":"0.0169131804","4":"-0.0209033588","_rn_":"5"},{"1":"5.101668e-18","2":"8.412970e-18","3":"-0.0255646819","4":"-0.0031232603","_rn_":"6"},{"1":"-2.444463e-01","2":"1.748251e-01","3":"0.0871810332","4":"-0.1003166199","_rn_":"7"},{"1":"-3.475724e-02","2":"6.380677e-02","3":"0.0123960646","4":"-0.0366130427","_rn_":"8"},{"1":"-4.234109e-17","2":"6.260635e-17","3":"-0.1692037527","4":"0.1271403667","_rn_":"9"},{"1":"-2.557905e-17","2":"2.565642e-17","3":"-0.0492883093","4":"0.0242655030","_rn_":"10"},{"1":"2.601484e-18","2":"-5.624570e-18","3":"0.0093452923","4":"-0.0112524575","_rn_":"11"},{"1":"-2.324154e-02","2":"1.687933e-02","3":"0.0082890250","4":"-0.0096855481","_rn_":"12"},{"1":"-7.648975e-02","2":"5.287334e-02","3":"0.0272798340","4":"-0.0303393205","_rn_":"13"},{"1":"1.504878e-01","2":"-7.795191e-02","3":"-0.0536710212","4":"0.0447296821","_rn_":"14"},{"1":"-3.772077e-02","2":"-3.889798e-02","3":"0.0134529981","4":"0.0223200986","_rn_":"15"},{"1":"-2.827238e-17","2":"4.180409e-17","3":"-0.1346314024","4":"0.1365346070","_rn_":"16"},{"1":"-4.129235e-01","2":"3.435578e-01","3":"0.1472678962","4":"-0.1971373519","_rn_":"17"},{"1":"8.591373e-18","2":"-8.806190e-18","3":"-0.0031833359","4":"0.0173529221","_rn_":"18"},{"1":"0.000000e+00","2":"0.000000e+00","3":"0.2942402553","4":"-0.2244199106","_rn_":"19"},{"1":"-1.907022e-01","2":"1.341656e-01","3":"0.0680133702","4":"-0.0769857117","_rn_":"20"},{"1":"2.154204e-17","2":"-3.185248e-17","3":"0.0833877932","4":"-0.0499748092","_rn_":"21"},{"1":"-1.944293e-18","2":"0.000000e+00","3":"0.0068512297","4":"-0.0084675802","_rn_":"22"},{"1":"3.152510e-17","2":"0.000000e+00","3":"-0.1468839394","4":"0.1503290959","_rn_":"23"},{"1":"-1.230505e-17","2":"0.000000e+00","3":"0.0814236740","4":"-0.0579989312","_rn_":"24"},{"1":"5.994030e-17","2":"-8.862889e-17","3":"0.2189469401","4":"-0.1615767196","_rn_":"25"},{"1":"1.960034e-02","2":"3.493224e-02","3":"-0.0069904006","4":"-0.0200445157","_rn_":"26"},{"1":"-1.444487e-02","2":"1.303382e-01","3":"0.0051517184","4":"-0.0747895376","_rn_":"27"},{"1":"1.337243e-01","2":"-1.035282e-01","3":"-0.0476923477","4":"0.0594056661","_rn_":"28"},{"1":"-9.656596e-18","2":"1.427843e-17","3":"-0.0455355445","4":"0.0517456430","_rn_":"29"},{"1":"1.254988e-03","2":"-1.239192e-01","3":"-0.0004475875","4":"0.0711062325","_rn_":"30"},{"1":"-5.793750e-18","2":"1.252645e-17","3":"-0.0144687824","4":"0.0258353470","_rn_":"31"},{"1":"-3.564971e-01","2":"2.920654e-01","3":"0.1271435925","4":"-0.1675904048","_rn_":"32"},{"1":"-5.080248e-02","2":"2.631542e-02","3":"0.0181185487","4":"-0.0151000839","_rn_":"33"},{"1":"4.788396e-02","2":"8.534006e-02","3":"-0.0170776661","4":"-0.0489690885","_rn_":"34"},{"1":"-1.540956e-17","2":"0.000000e+00","3":"0.0933661593","4":"-0.1020455315","_rn_":"35"},{"1":"1.319400e-01","2":"-6.834423e-02","3":"-0.0470559937","4":"0.0392166870","_rn_":"36"},{"1":"-1.638296e-02","2":"4.649315e-02","3":"0.0058429324","4":"-0.0266782922","_rn_":"37"},{"1":"1.486723e-17","2":"-2.198297e-17","3":"0.0654500091","4":"-0.0542854509","_rn_":"38"},{"1":"-3.577418e-18","2":"3.091113e-18","3":"0.0024835841","4":"-0.0069946238","_rn_":"39"},{"1":"-1.724903e-18","2":"0.000000e+00","3":"-0.0068206066","4":"0.0144061454","_rn_":"40"},{"1":"-4.867437e-17","2":"0.000000e+00","3":"0.2949169340","4":"-0.3223325830","_rn_":"41"},{"1":"1.374460e-17","2":"-1.642822e-17","3":"-0.0096964748","4":"-0.0166992830","_rn_":"42"},{"1":"5.605819e-19","2":"-1.603919e-17","3":"0.0501430182","4":"-0.0696103125","_rn_":"43"},{"1":"1.879670e-02","2":"4.494726e-02","3":"-0.0067037871","4":"-0.0257912459","_rn_":"44"},{"1":"-2.357140e-17","2":"3.485312e-17","3":"-0.0636710533","4":"0.0703942845","_rn_":"45"},{"1":"8.269692e-02","2":"-2.763524e-02","3":"-0.0294936029","4":"0.0158574107","_rn_":"46"},{"1":"-9.522090e-19","2":"2.724430e-17","3":"-0.0609753931","4":"0.0440091155","_rn_":"47"},{"1":"-1.302033e-02","2":"3.933708e-02","3":"0.0046436625","4":"-0.0225720580","_rn_":"48"},{"1":"-5.528843e-02","2":"3.750074e-02","3":"0.0197184486","4":"-0.0215183490","_rn_":"49"},{"1":"4.309282e-03","2":"1.831596e-03","3":"-0.0015368923","4":"-0.0010509905","_rn_":"50"},{"1":"1.571235e-01","2":"-7.331295e-02","3":"-0.0560376114","4":"0.0420677984","_rn_":"51"},{"1":"4.762426e-18","2":"7.853539e-18","3":"-0.0238647248","4":"-0.0029155750","_rn_":"52"},{"1":"2.256147e-16","2":"0.000000e+00","3":"-0.8430705169","4":"0.6860134435","_rn_":"53"},{"1":"-2.419044e-01","2":"1.872804e-01","3":"0.0862744784","4":"-0.1074636312","_rn_":"54"},{"1":"-1.140684e-17","2":"1.438592e-17","3":"0.0026296162","4":"0.0299632966","_rn_":"55"},{"1":"2.444635e-18","2":"-3.614684e-18","3":"0.0128215221","4":"-0.0086746057","_rn_":"56"},{"1":"0.000000e+00","2":"0.000000e+00","3":"0.0316602966","4":"-0.0209373172","_rn_":"57"},{"1":"1.174812e-01","2":"-1.898908e-01","3":"-0.0418993263","4":"0.1089615083","_rn_":"58"},{"1":"8.011205e-02","2":"-1.449878e-01","3":"-0.0285717186","4":"0.0831956380","_rn_":"59"},{"1":"2.936884e-01","2":"-1.521290e-01","3":"-0.1047430530","4":"0.0872933542","_rn_":"60"},{"1":"-3.068194e-02","2":"2.513662e-02","3":"0.0109426200","4":"-0.0144236771","_rn_":"61"},{"1":"-5.876263e-18","2":"8.688756e-18","3":"-0.0162824263","4":"0.0128833754","_rn_":"62"},{"1":"2.045360e-01","2":"-1.359258e-01","3":"-0.0729471366","4":"0.0779957645","_rn_":"63"},{"1":"1.250201e-01","2":"5.313791e-02","3":"-0.0445880183","4":"-0.0304911303","_rn_":"64"},{"1":"-3.196590e-01","2":"2.618852e-01","3":"0.1140054030","4":"-0.1502727056","_rn_":"65"},{"1":"-9.213908e-02","2":"1.278805e-02","3":"0.0328611197","4":"-0.0073379285","_rn_":"66"},{"1":"-5.284594e-02","2":"2.606837e-02","3":"0.0188473439","4":"-0.0149583218","_rn_":"67"},{"1":"-4.519466e-18","2":"4.632470e-18","3":"0.0016745844","4":"-0.0091284534","_rn_":"68"},{"1":"5.662852e-19","2":"-1.620238e-17","3":"0.0762884941","4":"-0.0557105987","_rn_":"69"},{"1":"1.149812e-01","2":"-2.003642e-01","3":"-0.0410076800","4":"0.1149712169","_rn_":"70"},{"1":"1.751008e-17","2":"-2.589074e-17","3":"0.0918361608","4":"-0.0621332223","_rn_":"71"},{"1":"6.417510e-20","2":"-9.489054e-20","3":"0.0001924100","4":"-0.0002453343","_rn_":"72"},{"1":"1.317138e-01","2":"-7.124715e-02","3":"-0.0469753226","4":"0.0408824186","_rn_":"73"},{"1":"-1.399424e-02","2":"3.454647e-03","3":"0.0049910036","4":"-0.0019823154","_rn_":"74"},{"1":"-1.054106e-01","2":"4.918399e-02","3":"0.0375943552","4":"-0.0282223264","_rn_":"75"},{"1":"2.741230e-18","2":"4.520459e-18","3":"-0.0137364201","4":"-0.0016781909","_rn_":"76"},{"1":"-1.493172e-01","2":"1.067899e-01","3":"0.0532535315","4":"-0.0612772536","_rn_":"77"},{"1":"0.000000e+00","2":"0.000000e+00","3":"-0.0674667726","4":"0.0711516808","_rn_":"78"},{"1":"-4.153221e-17","2":"5.161988e-17","3":"-0.0545070131","4":"0.0567149614","_rn_":"79"},{"1":"4.662001e-18","2":"0.000000e+00","3":"0.0184344676","4":"-0.0389363640","_rn_":"80"},{"1":"-2.301192e-18","2":"2.902186e-18","3":"0.0005304932","4":"0.0060447316","_rn_":"81"},{"1":"-3.801069e-17","2":"8.218148e-17","3":"-0.1417093568","4":"0.1055719903","_rn_":"82"},{"1":"-3.912236e-02","2":"8.934531e-02","3":"0.0139528684","4":"-0.0512673474","_rn_":"83"},{"1":"6.721937e-01","2":"-1.056439e+00","3":"-0.2397358061","4":"0.6061964429","_rn_":"84"},{"1":"-3.489167e-02","2":"-2.859230e-03","3":"0.0124440081","4":"0.0016406583","_rn_":"85"},{"1":"0.000000e+00","2":"0.000000e+00","3":"0.2529342780","4":"-0.1929154391","_rn_":"86"},{"1":"-1.772340e-01","2":"8.742771e-02","3":"0.0632099544","4":"-0.0501670071","_rn_":"87"},{"1":"1.694053e-02","2":"5.622053e-02","3":"-0.0060417866","4":"-0.0322599721","_rn_":"88"},{"1":"-1.367217e-02","2":"1.018729e-03","3":"0.0048761384","4":"-0.0005845584","_rn_":"89"},{"1":"2.273715e-01","2":"-3.360170e-01","3":"-0.0810913503","4":"0.1928103220","_rn_":"90"},{"1":"-2.151165e-17","2":"6.048907e-17","3":"-0.1149666394","4":"0.1144863704","_rn_":"91"},{"1":"3.400869e-17","2":"-3.411155e-17","3":"0.0655313856","4":"-0.0322622556","_rn_":"92"},{"1":"2.288189e-17","2":"-2.295110e-17","3":"0.0440911431","4":"-0.0217068465","_rn_":"93"},{"1":"6.448286e-02","2":"8.716115e-02","3":"-0.0229976142","4":"-0.0500140495","_rn_":"94"},{"1":"5.676953e-02","2":"-4.487628e-02","3":"-0.0202466773","4":"0.0257505155","_rn_":"95"},{"1":"-6.579456e-04","2":"-1.289422e-02","3":"0.0002346543","4":"0.0073988499","_rn_":"96"},{"1":"-3.261470e-02","2":"1.059767e-01","3":"0.0116319340","4":"-0.0608106195","_rn_":"97"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>As with our other measures, it is useful to create an index plot of the scaled DFBETA values. Typically you would create separate index plots for each of the coefficients. Below, I include the scaled DFBETA values in a data frame, and create the index plots. Because we are interested in large scaled DFBETA values regardless of sign, I plot the absolute value of the scaled DFBETA values in each case plot. Here I focus on the index plot associated with the interaction term since that is the primary effect of interests in an interaction model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up data with case number and scaled DFBETA values</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>scl_dfbeta <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">case =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">97</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">dfbetas</span>(lm<span class="fl">.1</span>))</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create index plots</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> scl_dfbeta, <span class="fu">aes</span>(<span class="at">x =</span> case, <span class="at">y =</span> <span class="fu">abs</span>(<span class="st">`</span><span class="at">educ_female:high_gni</span><span class="st">`</span>))) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> case), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Observation number"</span>) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Scaled DFBETA value"</span>) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">97</span>), <span class="at">color =</span> <span class="st">"#cc79a7"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Index plot of the absolute value of the standardized DFBETA values for the interaction effect between female education level and high GNI.</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that because the variable name included a colon (which is a special character in R syntax), we had to enclose the variable name <code>educ_female:high_gni</code> in back ticks in the <code>ggplot()</code> syntax. We also add a guideline to demarcate observations where <span class="math inline">\(\vert d^*_{ij}\vert &gt; \frac{2}{\sqrt{n}}\)</span>.</p>
<p>We want to use the plot to identify cases that have an absolute scaled DFBETA value that is substantially higher than most other observations‚Äô absolute scaled DFBETA values. (The guideline can help us identify these cases.) Observations 53 (Maldives), 84 (Tajikistan), and 41 (Japan) seem to have influence on the interaction coefficient of interest. Observation 19 (Colombia) also may have a modest amount of influence on the interaction term.</p>
<p><br></p>
</section>
<section id="cooks-distance" class="level2">
<h2 class="anchored" data-anchor-id="cooks-distance">Cook‚Äôs Distance</h2>
<p>While the DFBETA and scaled DFBETA values directly measure the impact of an observation on each of the coefficients, these measures of influence are not commonly used in practice. Instead, Cook‚Äôs Distance <span class="citation" data-cites="Cook-1977">(<a href="#ref-Cook-1977" role="doc-biblioref">Cook, 1977</a>)</span> is a more commonly used measure of influence by applied researchers. This measure is computed as:</p>
<p><span class="math display">\[
D_i = \frac{(e^*_i)^2}{p + 1} \times \frac{h_{ii}}{1 - h_{ii}}
\]</span></p>
<p>where <span class="math inline">\(e^*_i\)</span> is the standardized residual for the <em>i</em>th observation, <em>p</em> is the number of predictors in the fitted model, and <span class="math inline">\(h_{ii}\)</span> is the leverage value for the <em>i</em>th observation. Below we compute Cook‚Äôs Distance for Observation 1 using values obtained from the <code>augment()</code> output.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute D_i for Obs. 1</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0976</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">3</span> <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fl">0.0875</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.0875</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0002283573</code></pre>
</div>
</div>
<p>The Cook‚Äôs Distance values are also generated in the <code>.cooksd</code> column of the <code>augment()</code> output.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View augmented output</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>out_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["case"],"name":[10],"type":["int"],"align":["right"]},{"label":["country"],"name":[11],"type":["chr"],"align":["left"]},{"label":["t_i"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["p_adj"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"57","2":"5.9","3":"1","4":"55.65751","5":"1.34249276","6":"0.08752664","7":"14.48180","8":"0.00022828080037","9":"0.09756739","10":"1","11":"Algeria","12":"0.09704638","13":"0.922889800","14":"1.0000000"},{"1":"66","2":"8.9","3":"1","4":"65.24765","5":"0.75235237","6":"0.02168413","7":"14.48232","8":"0.00001545155047","9":"0.05280616","10":"2","11":"Austria","12":"0.05252227","13":"0.958220563","14":"1.0000000"},{"1":"55","2":"10.5","3":"1","4":"70.36239","5":"-15.36238917","6":"0.03258073","7":"14.39070","8":"0.00989907365212","9":"-1.08431187","10":"3","11":"Azerbaijan","12":"-1.08534894","13":"0.280457185","14":"1.0000000"},{"1":"62","2":"4.6","3":"0","4":"45.91627","5":"16.08372937","6":"0.02012031","7":"14.38313","8":"0.00653143149216","9":"1.12798466","10":"4","11":"Bangladesh","12":"1.12965797","13":"0.261406168","14":"1.0000000"},{"1":"67","2":"10.5","3":"1","4":"70.36239","5":"-3.36238917","6":"0.03258073","7":"14.47815","8":"0.00047421248672","9":"-0.23732496","10":"5","11":"Belgium","12":"-0.23611709","13":"0.813839669","14":"1.0000000"},{"1":"51","2":"9.2","3":"1","4":"66.20666","5":"-15.20666167","6":"0.02128908","7":"14.39360","8":"0.00619243355779","9":"-1.06711071","10":"6","11":"Belize","12":"-1.06791616","13":"0.288208893","14":"1.0000000"},{"1":"16","2":"2.0","3":"0","4":"34.14706","5":"-18.14706039","6":"0.03770633","7":"14.35354","8":"0.01615686917694","9":"-1.28426688","10":"7","11":"Benin","12":"-1.28882323","13":"0.200524864","14":"1.0000000"},{"1":"67","2":"8.4","3":"0","4":"63.11742","5":"3.88257596","6":"0.06905329","7":"14.47646","8":"0.00144717241198","9":"0.27935752","10":"8","11":"Bolivia","12":"0.27796819","13":"0.781628405","14":"1.0000000"},{"1":"46","2":"7.2","3":"1","4":"59.81323","5":"-13.81323474","6":"0.04517860","7":"14.40735","8":"0.01139265369220","9":"-0.98137984","10":"9","11":"Bosnia and Herzegovina","12":"-0.98118313","13":"0.328943379","14":"1.0000000"},{"1":"53","2":"8.7","3":"1","4":"64.60830","5":"-11.60830493","6":"0.02257267","7":"14.43071","8":"0.00383616506057","9":"-0.81513470","10":"10","11":"Botswana","12":"-0.81365222","13":"0.417837035","14":"1.0000000"},{"1":"69","2":"10.6","3":"1","4":"70.68206","5":"-1.68206051","6":"0.03432456","7":"14.48144","8":"0.00012547913178","9":"-0.11883075","10":"11","11":"Bulgaria","12":"-0.11819912","13":"0.906154309","14":"1.0000000"},{"1":"32","2":"1.9","3":"0","4":"33.69440","5":"-1.69439846","6":"0.03921132","7":"14.48142","8":"0.00014693742085","9":"-0.12000640","10":"12","11":"Burkina Faso","12":"-0.11936871","13":"0.905230126","14":"1.0000000"},{"1":"29","2":"2.2","3":"0","4":"35.05238","5":"-6.05238426","6":"0.03488049","7":"14.46829","8":"0.00165279496671","9":"-0.42769952","10":"13","11":"Burundi","12":"-0.42581283","13":"0.671187571","14":"1.0000000"},{"1":"56","2":"3.2","3":"0","4":"39.57900","5":"16.42099642","6":"0.02443396","7":"14.37844","8":"0.00834113411826","9":"1.15418117","10":"14","11":"Cambodia","12":"1.15627021","13":"0.250410525","14":"1.0000000"},{"1":"34","2":"5.1","3":"0","4":"48.17958","5":"-14.17958029","6":"0.02149518","7":"14.40523","8":"0.00543860514842","9":"-0.99514120","10":"15","11":"Cameroon","12":"-0.99508877","13":"0.322168966","14":"1.0000000"},{"1":"85","2":"12.3","3":"1","4":"76.11647","5":"8.88352660","6":"0.08309989","7":"14.45021","8":"0.00939880980238","9":"0.64406131","10":"16","11":"Canada","12":"0.64202268","13":"0.522372861","14":"1.0000000"},{"1":"6","2":"0.6","3":"0","4":"27.80979","5":"-21.80979335","6":"0.06436156","7":"14.29049","8":"0.04213656736991","9":"-1.56530991","10":"17","11":"Chad","12":"-1.57779469","13":"0.117868569","14":"1.0000000"},{"1":"76","2":"9.6","3":"1","4":"67.48535","5":"8.51465295","6":"0.02251282","7":"14.45468","8":"0.00205819830913","9":"0.59788028","10":"18","11":"Chile","12":"0.59580332","13":"0.552694325","14":"1.0000000"},{"1":"81","2":"7.0","3":"1","4":"59.17389","5":"21.82610795","6":"0.05031831","7":"14.29306","8":"0.03202344910366","9":"1.55485566","10":"19","11":"Colombia","12":"1.56697484","13":"0.120377184","14":"1.0000000"},{"1":"20","2":"2.1","3":"0","4":"34.59972","5":"-14.59972233","6":"0.03626272","7":"14.39930","8":"0.01002715861298","9":"-1.03244775","10":"20","11":"Congo, Democratic Republic","12":"-1.03281799","13":"0.304257307","14":"1.0000000"},{"1":"78","2":"8.4","3":"1","4":"63.64929","5":"14.35070910","6":"0.02484324","7":"14.40307","8":"0.00648263772796","9":"1.00887871","10":"21","11":"Costa Rica","12":"1.00897652","13":"0.315496193","14":"1.0000000"},{"1":"69","2":"10.5","3":"1","4":"70.36239","5":"-1.36238917","6":"0.03258073","7":"14.48182","8":"0.00007785372425","9":"-0.09616048","10":"22","11":"Croatia","12":"-0.09564685","13":"0.923998379","14":"1.0000000"},{"1":"86","2":"12.1","3":"1","4":"75.47713","5":"10.52286930","6":"0.07548610","7":"14.43752","8":"0.01178295211681","9":"0.75976672","10":"23","11":"Czech Republic","12":"0.75802709","13":"0.450272502","14":"1.0000000"},{"1":"70","2":"7.7","3":"1","4":"61.41159","5":"8.58840853","6":"0.03451743","7":"14.45384","8":"0.00329094527618","9":"0.60679681","10":"24","11":"Dominican Republic","12":"0.60472393","13":"0.546774446","14":"1.0000000"},{"1":"80","2":"7.4","3":"1","4":"60.45258","5":"19.54742257","6":"0.04053903","7":"14.33231","8":"0.02027418356292","9":"1.38541109","10":"25","11":"Ecuador","12":"1.39238567","13":"0.166989425","14":"1.0000000"},{"1":"59","2":"5.3","3":"0","4":"49.08490","5":"9.91509585","6":"0.02247477","7":"14.44475","8":"0.00278598528738","9":"0.69620276","10":"26","11":"Egypt, Arab Republic","12":"0.69426116","13":"0.489177896","14":"1.0000000"},{"1":"72","2":"6.1","3":"0","4":"52.70620","5":"19.29380040","6":"0.02884826","7":"14.33798","8":"0.01371913246726","9":"1.35918023","10":"27","11":"El Salvador","12":"1.36548321","13":"0.175259460","14":"1.0000000"},{"1":"40","2":"1.4","3":"0","4":"31.43109","5":"8.56891120","6":"0.04765693","7":"14.45358","8":"0.00464874899240","9":"0.60958145","10":"28","11":"Ethiopia","12":"0.60751017","13":"0.544932009","14":"1.0000000"},{"1":"78","2":"10.9","3":"1","4":"71.64107","5":"6.35892545","6":"0.04030625","7":"14.46672","8":"0.00213216206873","9":"0.45063012","10":"29","11":"France","12":"0.44869096","13":"0.654655367","14":"1.0000000"},{"1":"31","2":"5.9","3":"0","4":"51.80088","5":"-20.80087574","6":"0.02688662","7":"14.31471","8":"0.01480192536888","9":"-1.46387068","10":"30","11":"Ghana","12":"-1.47304913","13":"0.143975414","14":"1.0000000"},{"1":"76","2":"9.9","3":"1","4":"68.44436","5":"7.55563891","6":"0.02474348","7":"14.46056","8":"0.00178941505069","9":"0.53114681","10":"31","11":"Greece","12":"0.52908657","13":"0.597954095","14":"1.0000000"},{"1":"9","2":"0.8","3":"0","4":"28.71512","5":"-19.71511721","6":"0.05981713","7":"14.32656","8":"0.03169168064474","9":"-1.41154917","10":"32","11":"Guinea","12":"-1.41922503","13":"0.159038939","14":"1.0000000"},{"1":"34","2":"3.2","3":"0","4":"39.57900","5":"-5.57900358","6":"0.02443396","7":"14.47056","8":"0.00096280729288","9":"-0.39213095","10":"33","11":"Haiti","12":"-0.39033984","13":"0.697141148","14":"1.0000000"},{"1":"73","2":"5.3","3":"0","4":"49.08490","5":"23.91509585","6":"0.02247477","7":"14.26129","8":"0.01620799284848","9":"1.67923297","10":"34","11":"Honduras","12":"1.69609169","13":"0.093075807","14":"1.0000000"},{"1":"62","2":"11.2","3":"1","4":"72.60009","5":"-10.60008859","6":"0.04741325","7":"14.43821","8":"0.00707384144150","9":"-0.75398037","10":"35","11":"Hungary","12":"-0.75221835","13":"0.453741251","14":"1.0000000"},{"1":"54","2":"3.2","3":"0","4":"39.57900","5":"14.42099642","6":"0.02443396","7":"14.40232","8":"0.00643304559603","9":"1.01360734","10":"36","11":"India","12":"1.01375831","13":"0.313220131","14":"1.0000000"},{"1":"61","2":"6.9","3":"0","4":"56.32750","5":"4.67250494","6":"0.03914994","7":"14.47401","8":"0.00111548832238","9":"0.33092134","10":"37","11":"Indonesia","12":"0.32933134","13":"0.742615318","14":"1.0000000"},{"1":"53","2":"4.4","3":"1","4":"50.86244","5":"2.13756295","6":"0.16264695","7":"14.48049","8":"0.00127706254622","9":"0.16216884","10":"38","11":"Iraq","12":"0.16131742","13":"0.872178921","14":"1.0000000"},{"1":"65","2":"9.7","3":"1","4":"67.80502","5":"-2.80501840","6":"0.02313134","7":"14.47952","8":"0.00022979757128","9":"-0.19702459","10":"39","11":"Italy","12":"-0.19600337","13":"0.845017562","14":"1.0000000"},{"1":"73","2":"9.8","3":"1","4":"68.12469","5":"4.87531026","6":"0.02387489","7":"14.47340","8":"0.00071759695643","9":"0.34257237","10":"40","11":"Jamaica","12":"0.34094079","13":"0.733885525","14":"1.0000000"},{"1":"40","2":"11.2","3":"1","4":"72.60009","5":"-32.60008859","6":"0.04741325","7":"14.05764","8":"0.06690735966056","9":"-2.31883222","10":"41","11":"Japan","12":"-2.37604214","13":"0.019464279","14":"1.0000000"},{"1":"52","2":"9.4","3":"1","4":"66.84600","5":"-14.84600436","6":"0.02165088","7":"14.39775","8":"0.00600693030058","9":"-1.04199460","10":"42","11":"Jordan","12":"-1.04248056","13":"0.299780188","14":"1.0000000"},{"1":"55","2":"10.2","3":"1","4":"69.40338","5":"-14.40337513","6":"0.02809945","7":"14.40222","8":"0.00743581179799","9":"-1.01427605","10":"43","11":"Kazakhstan","12":"-1.01443460","13":"0.312899112","14":"1.0000000"},{"1":"61","2":"5.4","3":"0","4":"49.53757","5":"11.46243392","6":"0.02305664","7":"14.43198","8":"0.00382433987328","9":"0.80509099","10":"44","11":"Kenya","12":"0.80355597","13":"0.423618240","14":"1.0000000"},{"1":"80","2":"11.1","3":"1","4":"72.28042","5":"7.71958276","6":"0.04491922","7":"14.45911","8":"0.00353578041483","9":"0.54837366","10":"45","11":"Korea, Republic","12":"0.54630139","13":"0.586113156","14":"1.0000000"},{"1":"54","2":"3.8","3":"0","4":"42.29498","5":"11.70502483","6":"0.02111218","7":"14.42992","8":"0.00363711949810","9":"0.82131299","10":"46","11":"Lao PDR","12":"0.81986416","13":"0.414303597","14":"1.0000000"},{"1":"55","2":"7.6","3":"1","4":"61.09192","5":"-6.09192013","6":"0.03639960","7":"14.46808","8":"0.00175289818200","9":"-0.43083257","10":"47","11":"Lebanon","12":"-0.42893827","13":"0.668919274","14":"1.0000000"},{"1":"60","2":"6.8","3":"0","4":"55.87483","5":"4.12516687","6":"0.03764741","7":"14.47590","8":"0.00083348023442","9":"0.29192899","10":"48","11":"Lesotho","12":"0.29048837","13":"0.772062794","14":"1.0000000"},{"1":"31","2":"2.3","3":"0","4":"35.50505","5":"-4.50504619","6":"0.03355963","7":"14.47466","8":"0.00087864051525","9":"-0.31813726","10":"49","11":"Liberia","12":"-0.31659454","13":"0.752231609","14":"1.0000000"},{"1":"48","2":"4.8","3":"0","4":"46.82159","5":"1.17840551","6":"0.02048613","7":"14.48201","8":"0.00003572513002","9":"0.08265941","10":"50","11":"Madagascar","12":"0.08221682","13":"0.934643715","14":"1.0000000"},{"1":"59","2":"3.4","3":"0","4":"40.48433","5":"18.51567256","6":"0.02308119","7":"14.35024","8":"0.00999000725509","9":"1.30050812","10":"51","11":"Malawi","12":"1.30542208","13":"0.194837064","14":"1.0000000"},{"1":"52","2":"9.2","3":"1","4":"66.20666","5":"-14.20666167","6":"0.02128908","7":"14.40495","8":"0.00540477556255","9":"-0.99693682","10":"52","11":"Malaysia","12":"-0.99690367","13":"0.321291669","14":"1.0000000"},{"1":"19","2":"5.4","3":"1","4":"54.05915","5":"-35.05915051","6":"0.10944088","7":"13.95499","8":"0.20436310851133","9":"-2.57912758","10":"53","11":"Maldives","12":"-2.66219795","13":"0.009088365","14":"0.8815714"},{"1":"16","2":"1.4","3":"0","4":"31.43109","5":"-15.43108880","6":"0.04765693","7":"14.38841","8":"0.01507571622679","9":"-1.09774804","10":"54","11":"Mali","12":"-1.09897343","13":"0.274499871","14":"1.0000000"},{"1":"86","2":"9.5","3":"1","4":"67.16568","5":"18.83432430","6":"0.02201933","7":"14.34578","8":"0.00983986812606","9":"1.32217129","10":"55","11":"Malta","12":"1.32758020","13":"0.187432778","14":"1.0000000"},{"1":"64","2":"8.0","3":"1","4":"62.37061","5":"1.62939449","6":"0.02962115","7":"14.48151","8":"0.00010062765093","9":"0.11483080","10":"56","11":"Mauritius","12":"0.11421986","13":"0.909299597","14":"1.0000000"},{"1":"67","2":"8.1","3":"1","4":"62.69028","5":"4.30972314","6":"0.02823912","7":"14.47537","8":"0.00066923199307","9":"0.30350963","10":"57","11":"Mexico","12":"0.30202307","13":"0.763281092","14":"1.0000000"},{"1":"60","2":"9.6","3":"0","4":"68.54937","5":"-8.54936722","6":"0.10291920","7":"14.45193","8":"0.01126281231586","9":"-0.62664417","10":"58","11":"Moldova","12":"-0.62458603","13":"0.533709179","14":"1.0000000"},{"1":"55","2":"8.5","3":"0","4":"63.57009","5":"-8.57008597","6":"0.07153787","7":"14.45282","8":"0.00734384659740","9":"-0.61745583","10":"59","11":"Mongolia","12":"-0.61538989","13":"0.539738433","14":"1.0000000"},{"1":"71","2":"3.2","3":"0","4":"39.57900","5":"31.42099642","6":"0.02443396","7":"14.09766","8":"0.03053978659046","9":"2.20848488","10":"60","11":"Morocco","12":"2.25654867","13":"0.026280726","14":"1.0000000"},{"1":"27","2":"0.8","3":"0","4":"28.71512","5":"-1.71511721","6":"0.05981713","7":"14.48137","8":"0.00023984692449","9":"-0.12279776","10":"61","11":"Mozambique","12":"-0.12214568","13":"0.903036347","14":"1.0000000"},{"1":"56","2":"6.3","3":"1","4":"56.93619","5":"-0.93619263","6":"0.07224585","7":"14.48219","8":"0.00008863866274","9":"-0.06747635","10":"62","11":"Namibia","12":"-0.06711424","13":"0.946628904","14":"1.0000000"},{"1":"53","2":"2.4","3":"0","4":"35.95771","5":"17.04229188","6":"0.03230016","7":"14.36947","8":"0.01207049109980","9":"1.20270877","10":"63","11":"Nepal","12":"1.20563802","13":"0.230889860","14":"1.0000000"},{"1":"80","2":"4.8","3":"0","4":"46.82159","5":"33.17840551","6":"0.02048613","7":"14.05448","8":"0.02832013440911","9":"2.32730353","10":"64","11":"Nicaragua","12":"2.38525822","13":"0.019010365","14":"1.0000000"},{"1":"11","2":"0.8","3":"0","4":"28.71512","5":"-17.71511721","6":"0.05981713","7":"14.35673","8":"0.02558789762288","9":"-1.26835457","10":"65","11":"Niger","12":"-1.27257158","13":"0.206212035","14":"1.0000000"},{"1":"28","2":"4.2","3":"0","4":"44.10562","5":"-16.10562290","6":"0.02012522","7":"14.38286","8":"0.00655088899947","9":"-1.12952293","10":"66","11":"Nigeria","12":"-1.13121994","13":"0.260751577","14":"1.0000000"},{"1":"34","2":"3.3","3":"0","4":"40.03167","5":"-6.03166551","6":"0.02372688","7":"14.46855","8":"0.00109123467663","9":"-0.42379360","10":"67","11":"Pakistan","12":"-0.42191658","13":"0.674019535","14":"1.0000000"},{"1":"63","2":"9.6","3":"1","4":"67.48535","5":"-4.48534705","6":"0.02251282","7":"14.47481","8":"0.00057114373643","9":"-0.31495125","10":"68","11":"Panama","12":"-0.31342058","13":"0.754634113","14":"1.0000000"},{"1":"68","2":"7.5","3":"1","4":"60.77225","5":"7.22775122","6":"0.03840680","7":"14.46214","8":"0.00261443202998","9":"0.51169399","10":"69","11":"Paraguay","12":"0.50965345","13":"0.611451867","14":"1.0000000"},{"1":"54","2":"8.8","3":"0","4":"64.92807","5":"-10.92807177","6":"0.07935988","7":"14.43378","8":"0.01347267713365","9":"-0.79068118","10":"70","11":"Philippines","12":"-0.78907540","13":"0.431992393","14":"1.0000000"},{"1":"74","2":"8.0","3":"1","4":"62.37061","5":"11.62939449","6":"0.02962115","7":"14.43014","8":"0.00512600533948","9":"0.81957604","10":"71","11":"Portugal","12":"0.81811765","13":"0.415295219","14":"1.0000000"},{"1":"70","2":"10.4","3":"1","4":"70.04272","5":"-0.04271782","6":"0.03096194","7":"14.48254","8":"0.00000007249537","9":"-0.00301260","10":"72","11":"Romania","12":"-0.00299636","13":"0.997615408","14":"1.0000000"},{"1":"53","2":"3.1","3":"0","4":"39.12634","5":"13.87365835","6":"0.02520241","7":"14.40825","8":"0.00615093010969","9":"0.97552092","10":"73","11":"Rwanda","12":"0.97526463","13":"0.331854939","14":"1.0000000"},{"1":"41","2":"4.0","3":"0","4":"43.20030","5":"-2.20029903","6":"0.02049595","7":"14.48069","8":"0.00012461334433","9":"-0.15434103","10":"74","11":"Sao Tome and Principe","12":"-0.15352866","13":"0.878300337","14":"1.0000000"},{"1":"28","2":"3.4","3":"0","4":"40.48433","5":"-12.48432744","6":"0.02308119","7":"14.42255","8":"0.00454168617516","9":"-0.87687710","10":"75","11":"Senegal","12":"-0.87577790","13":"0.383314349","14":"1.0000000"},{"1":"58","2":"9.2","3":"1","4":"66.20666","5":"-8.20666167","6":"0.02128908","7":"14.45669","8":"0.00180354360596","9":"-0.57589343","10":"76","11":"Serbia","12":"-0.57381293","13":"0.567422529","14":"1.0000000"},{"1":"23","2":"2.0","3":"0","4":"34.14706","5":"-11.14706039","6":"0.03770633","7":"14.43400","8":"0.00609628620135","9":"-0.78887711","10":"77","11":"Sierra Leone","12":"-0.78726285","13":"0.433047415","14":"1.0000000"},{"1":"80","2":"11.6","3":"1","4":"73.87877","5":"6.12122603","6":"0.05863973","7":"14.46760","8":"0.00298746435564","9":"0.43798910","10":"78","11":"Slovak Republic","12":"0.43607794","13":"0.663749181","14":"1.0000000"},{"1":"79","2":"11.8","3":"1","4":"74.51812","5":"4.48188334","6":"0.06500318","7":"14.47448","8":"0.00179962103197","9":"0.32177944","10":"79","11":"Slovenia","12":"0.32022308","13":"0.749488001","14":"1.0000000"},{"1":"55","2":"9.8","3":"1","4":"68.12469","5":"-13.12468974","6":"0.02387489","7":"14.41617","8":"0.00520060850698","9":"-0.92222973","10":"80","11":"South Africa","12":"-0.92148137","13":"0.359085381","14":"1.0000000"},{"1":"71","2":"9.5","3":"1","4":"67.16568","5":"3.83432430","6":"0.02201933","7":"14.47690","8":"0.00040781845317","9":"0.26916992","10":"81","11":"Spain","12":"0.26782320","13":"0.789404091","14":"1.0000000"},{"1":"48","2":"7.3","3":"1","4":"60.13291","5":"-12.13290609","6":"0.04279630","7":"14.42471","8":"0.00828462341030","9":"-0.86092529","10":"82","11":"Suriname","12":"-0.85971689","13":"0.392064909","14":"1.0000000"},{"1":"66","2":"7.4","3":"0","4":"58.59080","5":"7.40919528","6":"0.04758327","7":"14.46089","8":"0.00346966865618","9":"0.52706035","10":"83","11":"Swaziland","12":"0.52500372","13":"0.600778525","14":"1.0000000"},{"1":"29","2":"10.0","3":"0","4":"70.36001","5":"-41.36001495","6":"0.11617193","7":"13.73703","8":"0.30652975079693","9":"-3.05421500","10":"84","11":"Tajikistan","12":"-3.20260988","13":"0.001842514","14":"0.1787238"},{"1":"38","2":"4.5","3":"0","4":"45.46361","5":"-7.46360869","6":"0.02002947","7":"14.46119","8":"0.00139986730463","9":"-0.52341380","10":"85","11":"Tanzania","12":"-0.52136063","13":"0.603303896","14":"1.0000000"},{"1":"78","2":"7.0","3":"1","4":"59.17389","5":"18.82610795","6":"0.05031831","7":"14.34181","8":"0.02382520233611","9":"1.34114065","10":"86","11":"Thailand","12":"1.34700009","13":"0.181118724","14":"1.0000000"},{"1":"20","2":"3.3","3":"0","4":"40.03167","5":"-20.03166551","6":"0.02372688","7":"14.32747","8":"0.01203587805388","9":"-1.40745400","10":"87","11":"Togo","12":"-1.41501785","13":"0.160265625","14":"1.0000000"},{"1":"63","2":"5.5","3":"0","4":"49.99023","5":"13.00977199","6":"0.02369988","7":"14.41734","8":"0.00507065893877","9":"0.91407289","10":"88","11":"Tunisia","12":"0.91325692","13":"0.363371810","14":"1.0000000"},{"1":"42","2":"4.3","3":"0","4":"44.55828","5":"-2.55828483","6":"0.02003193","7":"14.48003","8":"0.00016449107696","9":"-0.17940963","10":"89","11":"Uganda","12":"-0.17847334","13":"0.858723478","14":"1.0000000"},{"1":"65","2":"11.2","3":"0","4":"75.79196","5":"-10.79195814","6":"0.16182241","7":"14.43030","8":"0.03232307841633","9":"-0.81834238","10":"90","11":"Ukraine","12":"-0.81687724","13":"0.416000351","14":"1.0000000"},{"1":"84","2":"12.8","3":"1","4":"77.71483","5":"6.28516987","6":"0.10432246","7":"14.46598","8":"0.00618947954389","9":"0.46104572","10":"91","11":"United Kingdom","12":"0.45908523","13":"0.647200080","14":"1.0000000"},{"1":"80","2":"8.7","3":"1","4":"64.60830","5":"15.39169507","6":"0.02257267","7":"14.39130","8":"0.00674423308034","9":"1.08080421","10":"92","11":"Uruguay","12":"1.08179319","13":"0.282026506","14":"1.0000000"},{"1":"75","2":"8.7","3":"1","4":"64.60830","5":"10.39169507","6":"0.02257267","7":"14.44102","8":"0.00307420240687","9":"0.72970441","10":"93","11":"Venezuela, RB","12":"0.72785732","13":"0.468454265","14":"1.0000000"},{"1":"76","2":"5.2","3":"0","4":"48.63224","5":"27.36775778","6":"0.02195429","7":"14.19225","8":"0.02071214603456","9":"1.92115522","10":"94","11":"Vietnam","12":"1.94988213","13":"0.054077458","14":"1.0000000"},{"1":"34","2":"1.2","3":"0","4":"30.52576","5":"3.47423506","6":"0.05146482","7":"14.47776","8":"0.00083189318997","9":"0.24764827","10":"95","11":"Yemen, Republic","12":"0.24639448","13":"0.805897545","14":"1.0000000"},{"1":"49","2":"5.8","3":"0","4":"51.34821","5":"-2.34821381","6":"0.02599787","7":"14.48042","8":"0.00018207018207","9":"-0.16518115","10":"96","11":"Zambia","12":"-0.16431479","13":"0.869825252","14":"1.0000000"},{"1":"67","2":"6.7","3":"0","4":"55.42217","5":"11.57782880","6":"0.03620625","7":"14.43025","8":"0.00629528280894","9":"0.81872469","10":"97","11":"Zimbabwe","12":"0.81726163","13":"0.415781761","14":"1.0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Observations with a Cook‚Äôs Distance such that <span class="math inline">\(D_i &gt; \frac{4}{n-p-1}\)</span> are considered influential. In this case, Observation 1 would not be considered influential as its Cook‚Äôs Distance of 0.0002 is not larger than the cutoff of 0.043.</p>
<p>Unlike the DFBETA measures which computes multiple measures of influence for each observation, Cook‚Äôs Distance computes a single measure of influence for each observation. This measures the overall influence across all of the predictors rather than the influence on any one predictor. (It is probably for this reason that Cook‚Äôs Distance is favored by applied researchers.) We can, once again, create an index plot to plot the Cook‚Äôs Distance values. Within this plot, a guideline can be added to identify cases larger than the cutoff.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add case number to data</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>out_1 <span class="ot">=</span> out_1 <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">case =</span> <span class="fu">row_number</span>())</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create index plot</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> out_1, <span class="fu">aes</span>(<span class="at">x =</span> case, <span class="at">y =</span> .cooksd)) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> case), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Observation number"</span>) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cook's D value"</span>) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span> <span class="sc">/</span> (<span class="dv">97</span> <span class="sc">-</span> <span class="dv">3</span><span class="sc">-</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"#cc79a7"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Index plot of Cook‚Äôs D values for the 97 observations.</figcaption>
</figure>
</div>
</div>
</div>
<p>Based on the plot, we can identify Observations 84 (Tajikistan), 53 (Maldives), and 41 (Japan) as being influential in the model.</p>
<p><br></p>
</section>
</section>
<section id="one-last-diagnostic-plot" class="level1">
<h1>One Last Diagnostic Plot</h1>
<p>It is possible to create a plot that includes the measures of leverage, outlyingness, and influence. To do this, we will create a scatterplot of outlyingness versus leverage. Then, we will map point size to the degree of influence.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create index plot</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> out_1, <span class="fu">aes</span>(<span class="at">x =</span> .hat, <span class="at">y =</span> <span class="fu">abs</span>(t_i))) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> case, <span class="at">size =</span> .cooksd)) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Leverage value"</span>) <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Absolute studentized residual"</span>) <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Cook's D"</span>,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"#cc79a7"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">mean</span>(out_1<span class="sc">$</span>.hat), <span class="at">color =</span> <span class="st">"#cc79a7"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Scatterplot of absolute studentized residuals versus leverage values for the 97 observations. Observation numbers are sized relative to their Cook‚Äôs D value. Guidelines are included to demarcate observations with large leverage values and potential regression outliers.</figcaption>
</figure>
</div>
</div>
</div>
<p>From this plot we can see that Observations 84 (Tajikistan) and 53 (Maldives) are observations that are identified as having high leverage and as potential regression outliers. Moreover, the large size of their text indicates a relatively large Cook‚Äôs D value, suggesting they may be influential.</p>
<p><br></p>
</section>
<section id="removing-observations" class="level1">
<h1>Removing Observations</h1>
<p>Based on our analyses, we have identified the following observations as being extreme on one or more of the diagnostic measures.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Case numbers and country names for observations that were identified as high leverage, regression outliers, or influential (as measured by Cook‚Äôs D). </caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Case</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Country</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">High Leverage</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Regression Outlier</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Influential</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: left;">Algeria</td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">16</td>
<td style="text-align: left;">Canada</td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">38</td>
<td style="text-align: left;">Iraq</td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">41</td>
<td style="text-align: left;">Japan</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;">‚úî</td>
</tr>
<tr class="odd">
<td style="text-align: center;">53</td>
<td style="text-align: left;">Maldives</td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;">‚úî</td>
</tr>
<tr class="even">
<td style="text-align: center;">58</td>
<td style="text-align: left;">Moldova</td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">60</td>
<td style="text-align: left;">Morocco</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">64</td>
<td style="text-align: left;">Nicaragua</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">84</td>
<td style="text-align: left;">Tajikistan</td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;">‚úî</td>
</tr>
<tr class="even">
<td style="text-align: center;">90</td>
<td style="text-align: left;">Ukraine</td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">91</td>
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: center;">‚úî</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Not only might these unusual observations impact the regression coefficients, but they also might lead to violations of the regression model‚Äôs assumptions. For example, having regression outliers might violate the assumption of homoskedasticity or normality. Once we have identified observations that are unusual or that influence the regression coefficients, should we remove them? This depends on why the observations are unusual. For example, do they belong to your population? If they don‚Äôt belong to your population of interest, then the observations can be removed. Otherwise, we need to consider other methods of dealing with them. For example,</p>
<ul>
<li>Sometimes, we can make observations less unusual by transforming the data (e.g., log-transformation). We will cover this in the next set of notes.</li>
<li>Other times we have to use a more robust method of fitting the model (e.g., non-parametric regression).</li>
</ul>
<div class="protip">
<p>Large samples are far more robust to unusual cases. In large samples, unusual cases rarely have much influence on the estimated coefficients or SEs.</p>
</div>
<p>In our example, it is unclear that we can remove Tajikistan and Maldives from the data. However, here we remove the observations and re-fit the interaction model purely for pedagogical purposes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove observations</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>contraception2 <span class="ot">=</span> contraception <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Tajikistan"</span>, <span class="st">"Maldives"</span>))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit interaction model</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">lm</span>(contraceptive <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> educ_female <span class="sc">+</span> high_gni <span class="sc">+</span> educ_female<span class="sc">:</span>high_gni, <span class="at">data =</span> contraception2)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Augment model</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>out_2 <span class="ot">=</span> <span class="fu">augment</span>(lm<span class="fl">.2</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co"># View augmented data</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>out_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"57","2":"5.9","3":"1","4":"59.50381","5":"-2.50380946","6":"0.09824545","7":"13.32241","8":"0.0010782576829","9":"-0.198966161"},{"1":"66","2":"8.9","3":"1","4":"66.32123","5":"-0.32123157","6":"0.02251922","7":"13.32527","8":"0.0000034622431","9":"-0.024518067"},{"1":"55","2":"10.5","3":"1","4":"69.95719","5":"-14.95719003","6":"0.03269969","7":"13.22853","8":"0.0111302591916","9":"-1.147602441"},{"1":"62","2":"4.6","3":"0","4":"47.01138","5":"14.98861856","6":"0.02073993","7":"13.22932","8":"0.0069170135351","9":"1.142969652"},{"1":"67","2":"10.5","3":"1","4":"69.95719","5":"-2.95719003","6":"0.03269969","7":"13.32154","8":"0.0004350745932","9":"-0.226892785"},{"1":"51","2":"9.2","3":"1","4":"67.00297","5":"-16.00297379","6":"0.02174851","7":"13.21572","8":"0.0082854134830","9":"-1.220949076"},{"1":"16","2":"2.0","3":"0","4":"33.15190","5":"-17.15190462","6":"0.03821800","7":"13.19717","8":"0.0173030868174","9":"-1.319763596"},{"1":"67","2":"8.4","3":"0","4":"67.26754","5":"-0.26753988","6":"0.07795199","7":"13.32528","8":"0.0000093428944","9":"-0.021024897"},{"1":"46","2":"7.2","3":"1","4":"62.45803","5":"-16.45802571","6":"0.05024667","7":"13.20587","8":"0.0214795584745","9":"-1.274366772"},{"1":"53","2":"8.7","3":"1","4":"65.86674","5":"-12.86673677","6":"0.02372008","7":"13.25442","8":"0.0058652779527","9":"-0.982660171"},{"1":"69","2":"10.6","3":"1","4":"70.18444","5":"-1.18443744","6":"0.03450398","7":"13.32470","8":"0.0000739225066","9":"-0.090961790"},{"1":"32","2":"1.9","3":"0","4":"32.61885","5":"-0.61884781","6":"0.03980900","7":"13.32514","8":"0.0000235406218","9":"-0.047657050"},{"1":"29","2":"2.2","3":"0","4":"34.21802","5":"-5.21801822","6":"0.03524017","7":"13.31354","8":"0.0014675570713","9":"-0.400883425"},{"1":"56","2":"3.2","3":"0","4":"39.54859","5":"16.45141377","6":"0.02443444","7":"13.20914","8":"0.0098919079487","9":"1.256889532"},{"1":"34","2":"5.1","3":"0","4":"49.67667","5":"-15.67666544","6":"0.02265316","7":"13.22006","8":"0.0082970344110","9":"-1.196606748"},{"1":"85","2":"12.3","3":"1","4":"74.04764","5":"10.95235670","6":"0.08620095","7":"13.27047","8":"0.0176282837461","9":"0.864578324"},{"1":"6","2":"0.6","3":"0","4":"25.68911","5":"-19.68910940","6":"0.06668514","7":"13.15100","8":"0.0422482848628","9":"-1.537921246"},{"1":"76","2":"9.6","3":"1","4":"67.91196","5":"8.08803660","6":"0.02264468","7":"13.29738","8":"0.0022076576817","9":"0.617360704"},{"1":"81","2":"7.0","3":"1","4":"62.00353","5":"18.99646910","6":"0.05611956","7":"13.16495","8":"0.0323601332404","9":"1.475490805"},{"1":"20","2":"2.1","3":"0","4":"33.68496","5":"-13.68496142","6":"0.03669506","7":"13.24401","8":"0.0105426883759","9":"-1.052164870"},{"1":"78","2":"8.4","3":"1","4":"65.18499","5":"12.81500544","6":"0.02655198","7":"13.25479","8":"0.0065507821535","9":"0.980131904"},{"1":"69","2":"10.5","3":"1","4":"69.95719","5":"-0.95719003","6":"0.03269969","7":"13.32492","8":"0.0000455828622","9":"-0.073441176"},{"1":"86","2":"12.1","3":"1","4":"73.59315","5":"12.40685151","6":"0.07805776","7":"13.25552","8":"0.0201240825983","9":"0.975061129"},{"1":"70","2":"7.7","3":"1","4":"63.59426","5":"6.40573727","6":"0.03796916","7":"13.30752","8":"0.0023964894319","9":"0.492829550"},{"1":"80","2":"7.4","3":"1","4":"62.91252","5":"17.08747948","6":"0.04492343","7":"13.19724","8":"0.0204708923902","9":"1.319413810"},{"1":"59","2":"5.3","3":"0","4":"50.74278","5":"8.25722095","6":"0.02389484","7":"13.29616","8":"0.0024342378519","9":"0.630678051"},{"1":"72","2":"6.1","3":"0","4":"55.00723","5":"16.99276655","6":"0.03158386","7":"13.20041","8":"0.0138437447871","9":"1.303032345"},{"1":"40","2":"1.4","3":"0","4":"29.95356","5":"10.04643619","6":"0.04878484","7":"13.28100","8":"0.0077470376343","9":"0.777310911"},{"1":"78","2":"10.9","3":"1","4":"70.86618","5":"7.13382035","6":"0.04074131","7":"13.30317","8":"0.0032076877547","9":"0.549637572"},{"1":"31","2":"5.9","3":"0","4":"53.94112","5":"-22.94111985","6":"0.02925327","7":"13.09733","8":"0.0232581913708","9":"-1.757048540"},{"1":"76","2":"9.9","3":"1","4":"68.59371","5":"7.40629439","6":"0.02475964","7":"13.30184","8":"0.0020328586221","9":"0.565935911"},{"1":"9","2":"0.8","3":"0","4":"26.75522","5":"-17.75522300","6":"0.06180172","7":"13.18448","8":"0.0315099587023","9":"-1.383250803"},{"1":"34","2":"3.2","3":"0","4":"39.54859","5":"-5.54858623","6":"0.02443444","7":"13.31215","8":"0.0011252222056","9":"-0.423912500"},{"1":"73","2":"5.3","3":"0","4":"50.74278","5":"22.25722095","6":"0.02389484","7":"13.11201","8":"0.0176863035182","9":"1.699983665"},{"1":"62","2":"11.2","3":"1","4":"71.54792","5":"-9.54792186","6":"0.04821536","7":"13.28532","8":"0.0069073256824","9":"-0.738518917"},{"1":"54","2":"3.2","3":"0","4":"39.54859","5":"14.45141377","6":"0.02443444","7":"13.23576","8":"0.0076329828587","9":"1.104089347"},{"1":"61","2":"6.9","3":"0","4":"59.27169","5":"1.72831214","6":"0.04362850","7":"13.32401","8":"0.0002028363013","9":"0.133361657"},{"1":"53","2":"4.4","3":"1","4":"56.09510","5":"-3.09509841","6":"0.18248528","7":"13.32042","8":"0.0037236585634","9":"-0.258314501"},{"1":"65","2":"9.7","3":"1","4":"68.13921","5":"-3.13921080","6":"0.02321226","7":"13.32110","8":"0.0003413046045","9":"-0.239685904"},{"1":"73","2":"9.8","3":"1","4":"68.36646","5":"4.63354179","6":"0.02391724","7":"13.31614","8":"0.0007672700031","9":"0.353909221"},{"1":"40","2":"11.2","3":"1","4":"71.54792","5":"-31.54792186","6":"0.04821536","7":"12.88197","8":"0.0754108323474","9":"-2.440189333"},{"1":"52","2":"9.4","3":"1","4":"67.45747","5":"-15.45746859","6":"0.02192177","7":"13.22307","8":"0.0077945220034","9":"-1.179434133"},{"1":"55","2":"10.2","3":"1","4":"69.27545","5":"-14.27544782","6":"0.02811131","7":"13.23760","8":"0.0086339941481","9":"-1.092706664"},{"1":"61","2":"5.4","3":"0","4":"51.27584","5":"9.72416415","6":"0.02461777","7":"13.28483","8":"0.0034832757725","9":"0.742996858"},{"1":"80","2":"11.1","3":"1","4":"71.32067","5":"8.67932554","6":"0.04558659","7":"13.29236","8":"0.0053668602094","9":"0.670408987"},{"1":"54","2":"3.8","3":"0","4":"42.74693","5":"11.25307297","6":"0.02121771","7":"13.27126","8":"0.0039925734412","9":"0.858321912"},{"1":"55","2":"7.6","3":"1","4":"63.36702","5":"-8.36701533","6":"0.04014984","7":"13.29487","8":"0.0043431246659","9":"-0.644452568"},{"1":"60","2":"6.8","3":"0","4":"58.73863","5":"1.26136894","6":"0.04188473","7":"13.32462","8":"0.0001033448058","9":"0.097242332"},{"1":"31","2":"2.3","3":"0","4":"34.75108","5":"-3.75107502","6":"0.03385334","7":"13.31924","8":"0.0007264591105","9":"-0.287976028"},{"1":"48","2":"4.8","3":"0","4":"48.07750","5":"-0.07749504","6":"0.02130105","7":"13.32531","8":"0.0000001901231","9":"-0.005911143"},{"1":"59","2":"3.4","3":"0","4":"40.61470","5":"18.38530017","6":"0.02308997","7":"13.18026","8":"0.0116423294224","9":"1.403671736"},{"1":"52","2":"9.2","3":"1","4":"67.00297","5":"-15.00297379","6":"0.02174851","7":"13.22903","8":"0.0072822821234","9":"-1.144653939"},{"1":"16","2":"1.4","3":"0","4":"29.95356","5":"-13.95356381","6":"0.04878484","7":"13.23970","8":"0.0149445172557","9":"-1.079612430"},{"1":"86","2":"9.5","3":"1","4":"67.68472","5":"18.31528400","6":"0.02221452","7":"13.18150","8":"0.0110958699107","9":"1.397700050"},{"1":"64","2":"8.0","3":"1","4":"64.27600","5":"-0.27600494","6":"0.03225161","7":"13.32528","8":"0.0000037346027","9":"-0.021171798"},{"1":"67","2":"8.1","3":"1","4":"64.50325","5":"2.49674766","6":"0.03062058","7":"13.32263","8":"0.0002891740966","9":"0.191359430"},{"1":"60","2":"9.6","3":"0","4":"73.66422","5":"-13.66422149","6":"0.11643597","7":"13.23692","8":"0.0396428735835","9":"-1.096952933"},{"1":"55","2":"8.5","3":"0","4":"67.80060","5":"-12.80059668","6":"0.08078468","7":"13.25078","8":"0.0223017614479","9":"-1.007496861"},{"1":"71","2":"3.2","3":"0","4":"39.54859","5":"31.45141377","6":"0.02443444","7":"12.89564","8":"0.0361538006985","9":"2.402890918"},{"1":"27","2":"0.8","3":"0","4":"26.75522","5":"0.24477700","6":"0.06180172","7":"13.32528","8":"0.0000059887581","9":"0.019069768"},{"1":"56","2":"6.3","3":"1","4":"60.41280","5":"-4.41279908","6":"0.08100317","7":"13.31647","8":"0.0026588053265","9":"-0.347359565"},{"1":"53","2":"2.4","3":"0","4":"35.28413","5":"17.71586818","6":"0.03253457","7":"13.18937","8":"0.0155304228017","9":"1.359148241"},{"1":"80","2":"4.8","3":"0","4":"48.07750","5":"31.92250496","6":"0.02130105","7":"12.88389","8":"0.0322612299114","9":"2.434975056"},{"1":"11","2":"0.8","3":"0","4":"26.75522","5":"-15.75522300","6":"0.06180172","7":"13.21454","8":"0.0248110235296","9":"-1.227437406"},{"1":"28","2":"4.2","3":"0","4":"44.87915","5":"-16.87915424","6":"0.02043437","7":"13.20349","8":"0.0086373345345","9":"-1.286933265"},{"1":"34","2":"3.3","3":"0","4":"40.08164","5":"-6.08164303","6":"0.02372817","7":"13.30951","8":"0.0013108375680","9":"-0.464469993"},{"1":"63","2":"9.6","3":"1","4":"67.91196","5":"-4.91196340","6":"0.02264468","7":"13.31501","8":"0.0008142462394","9":"-0.374930695"},{"1":"68","2":"7.5","3":"1","4":"63.13977","5":"4.86023208","6":"0.04246793","7":"13.31502","8":"0.0015575882819","9":"0.374802482"},{"1":"54","2":"8.8","3":"0","4":"69.39977","5":"-15.39976708","6":"0.08969108","7":"13.21625","8":"0.0365413164348","9":"-1.217984797"},{"1":"74","2":"8.0","3":"1","4":"64.27600","5":"9.72399506","6":"0.03225161","7":"13.28451","8":"0.0046355381201","9":"0.745908601"},{"1":"70","2":"10.4","3":"1","4":"69.72994","5":"0.27005737","6":"0.03103282","7":"13.32528","8":"0.0000034316217","9":"0.020702539"},{"1":"53","2":"3.1","3":"0","4":"39.01553","5":"13.98447057","6":"0.02520875","7":"13.24140","8":"0.0073859170750","9":"1.068839103"},{"1":"41","2":"4.0","3":"0","4":"43.81304","5":"-2.81304063","6":"0.02068993","7":"13.32194","8":"0.0002430271479","9":"-0.214505291"},{"1":"28","2":"3.4","3":"0","4":"40.61470","5":"-12.61469983","6":"0.02308997","7":"13.25722","8":"0.0054809050106","9":"-0.963100816"},{"1":"58","2":"9.2","3":"1","4":"67.00297","5":"-9.00297379","6":"0.02174851","7":"13.29072","8":"0.0026223144631","9":"-0.686883118"},{"1":"23","2":"2.0","3":"0","4":"33.15190","5":"-10.15190462","6":"0.03821800","7":"13.28056","8":"0.0060616930138","9":"-0.781144394"},{"1":"80","2":"11.6","3":"1","4":"72.45691","5":"7.54308853","6":"0.06010452","7":"13.30005","8":"0.0055110034642","9":"0.587126307"},{"1":"79","2":"11.8","3":"1","4":"72.91141","5":"6.08859372","6":"0.06687358","7":"13.30874","8":"0.0040531422404","9":"0.475629593"},{"1":"55","2":"9.8","3":"1","4":"68.36646","5":"-13.36645821","6":"0.02391724","7":"13.24878","8":"0.0063849094167","9":"-1.020928057"},{"1":"71","2":"9.5","3":"1","4":"67.68472","5":"3.31528400","6":"0.02221452","7":"13.32062","8":"0.0003635595170","9":"0.253000315"},{"1":"48","2":"7.3","3":"1","4":"62.68527","5":"-14.68527311","6":"0.04751634","7":"13.23058","8":"0.0160796372237","9":"-1.135469248"},{"1":"66","2":"7.4","3":"0","4":"61.93697","5":"4.06302813","6":"0.05336825","7":"13.31804","8":"0.0013996025712","9":"0.315123950"},{"1":"38","2":"4.5","3":"0","4":"46.47832","5":"-8.47832464","6":"0.02056145","7":"13.29468","8":"0.0021933288783","9":"-0.646462833"},{"1":"78","2":"7.0","3":"1","4":"62.00353","5":"15.99646910","6":"0.05611956","7":"13.21180","8":"0.0229463066372","9":"1.242475270"},{"1":"20","2":"3.3","3":"0","4":"40.08164","5":"-20.08164303","6":"0.02372817","7":"13.15196","8":"0.0142924116195","9":"-1.533684327"},{"1":"63","2":"5.5","3":"0","4":"51.80889","5":"11.19110735","6":"0.02540876","7":"13.27163","8":"0.0047694551459","9":"0.855428911"},{"1":"42","2":"4.3","3":"0","4":"45.41221","5":"-3.41221104","6":"0.02040867","7":"13.32035","8":"0.0003525176938","9":"-0.260157010"},{"1":"65","2":"11.2","3":"0","4":"82.19313","5":"-17.19313030","6":"0.18299263","7":"13.17360","8":"0.1153654618849","9":"-1.435370721"},{"1":"84","2":"12.8","3":"1","4":"75.18388","5":"8.81611968","6":"0.10896363","7":"13.28889","8":"0.0151855271744","9":"0.704777248"},{"1":"80","2":"8.7","3":"1","4":"65.86674","5":"14.13326323","6":"0.02372008","7":"13.23973","8":"0.0070767957531","9":"1.079387502"},{"1":"75","2":"8.7","3":"1","4":"65.86674","5":"9.13326323","6":"0.02372008","7":"13.28964","8":"0.0029553145731","9":"0.697526822"},{"1":"76","2":"5.2","3":"0","4":"50.20972","5":"25.79027775","6":"0.02323997","7":"13.03831","8":"0.0230651399621","9":"1.969174461"},{"1":"34","2":"1.2","3":"0","4":"28.88745","5":"5.11254979","6":"0.05285158","7":"13.31380","8":"0.0021922051510","9":"0.396415516"},{"1":"49","2":"5.8","3":"0","4":"53.40806","5":"-4.40806305","6":"0.02819005","7":"13.31697","8":"0.0008256824416","9":"-0.337426543"},{"1":"67","2":"6.7","3":"0","4":"58.20557","5":"8.79442574","6":"0.04020900","7":"13.29167","8":"0.0048058385555","9":"0.677393875"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual Plots</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> out_2, <span class="fu">aes</span>(<span class="at">x =</span> .resid)) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  educate<span class="sc">::</span><span class="fu">stat_density_confidence</span>(<span class="at">model =</span> <span class="st">"normal"</span>) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Residuals"</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> out_2, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Fitted values"</span>) <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Residuals"</span>)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level information</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0.5597163","2":"0.5452015","3":"13.25189","4":"38.56164","5":"3.568289e-16","6":"3","7":"-378.2492","8":"766.4983","9":"779.2677","10":"15980.75","11":"91","12":"95"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level information</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm<span class="fl">.2</span>, <span class="at">conf.int =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"22.490769","3":"3.8171141","4":"5.892087","5":"6.355707e-08","6":"14.908540","7":"30.0729969"},{"1":"educ_female","2":"5.330568","3":"0.7730335","4":"6.895650","5":"6.889942e-10","6":"3.795032","7":"6.8661040"},{"1":"high_gni","2":"23.605444","3":"11.0151759","4":"2.142993","5":"3.478197e-02","6":"1.725150","7":"45.4857379"},{"1":"educ_female:high_gni","2":"-3.058094","3":"1.3431862","4":"-2.276746","5":"2.514575e-02","6":"-5.726168","7":"-0.3900195"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>By removing Takijistan and Maldives, the model <span class="math inline">\(R^2\)</span> increased from 0.497 to 0.560. We expect this since both observations were potential regression outliers. By removing them, we reduced the residual variation getting better fit. (We can also see this in the size of the RMSE which decreased from 14.4 tp 13.3.)</p>
<p>At the coefficient-level, all of the effect sizes (the coefficient estimates) increased. In particular, we are interested in the interaction effect, which now has a bigger effect (it is more negative). Moreover, because we reduced the residual variation, the SEs on the effects have decreased. Higher estimates and smaller SEs lead to smaller <em>p</em>-values and more precise interval estimates.</p>
<p>However, we also note that in this new model, we might now have new unusual values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add studentized residuals and country names</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>out_2 <span class="ot">=</span> out_2 <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_i =</span> .resid <span class="sc">/</span> (.sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> .hat)),</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">country =</span> contraception2<span class="sc">$</span>country</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create index plot</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> out_2, <span class="fu">aes</span>(<span class="at">x =</span> .hat, <span class="at">y =</span> <span class="fu">abs</span>(t_i))) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country, <span class="at">size =</span> .cooksd)) <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Leverage value"</span>) <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Absolute studentized residual"</span>) <span class="sc">+</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Cook's D"</span>,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"#cc79a7"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">mean</span>(out_2<span class="sc">$</span>.hat), <span class="at">color =</span> <span class="st">"#cc79a7"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-01-regression-diagnostics_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Scatterplot of absolute studentized residuals versus leverage values for the 95 observations after removing Tajikistan and Maldives. Observation numbers are sized relative to their Cook‚Äôs D value. Guidelines are included to demarcate observations with large leverage values and potential regression outliers.</figcaption>
</figure>
</div>
</div>
</div>
<p>Here it looks like there are no new influential values.</p>
<p><br></p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Belsley:1980" class="csl-entry" role="listitem">
Belsley, D., Kuh, E., &amp; Welsch, R. (1980). <em>Regression diagnostics</em>. New York: Wiley.
</div>
<div id="ref-Cook-1977" class="csl-entry" role="listitem">
Cook, R. D. (1977). Detection of influential observations in linear regression. <em>Technometrics</em>, <em>19</em>, 15‚Äì18.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>When there is more than one predictor, leverage is measure of how far away an observation is from the centroid of the predictor space.<a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn2"><p>Because we are dividing by the standard error sometimes these are referred to as <em>internally studentized residuals</em> rather than standardized residuals.<a href="#fnref2" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn3"><p>If the sample size is large, it is better to use the heuristic that regression outliers have a standardized residual more than 3 SEs from zero.<a href="#fnref3" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn4"><p>Studentized residuals are also sometimes referred to as: <em>deleted studentized residuals</em>, <em>externally studentized residuals</em>, and in some books and papers, even as <em>standardized residuals</em>. Ugh.<a href="#fnref4" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>