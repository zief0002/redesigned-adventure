{
  "hash": "b52b904967108b8e967dad3ea1eac70c",
  "result": {
    "markdown": "---\ntitle: \"ðŸŽ¶ Regression from Summary Measures\"\nformat:\n  html:\n    code-copy: true\n    code-fold: false\n    highlight-style: zenburn\n    df-print: paged\n    css: [\"../assets/style.css\", \"../assets/notes.css\", \"../assets/gt-table-styles.css\"]\ndate: 10-13-2022\nbibliography: '../assets/epsy8264.bib'\ncsl: '../assets/apa-single-spaced.csl'\n---\n\n::: {.cell}\n\n:::\n\n\n---\n\nWhen we have raw data, we can fit a regression model using the `lm()` function and obtain model- and coefficient-level summaries using the `glance()` and `tidy()` functions respectively. However, there are times we might want to compute regression coefficients and standard errors, but are not given the raw data. This is common for example in articles, which often report summaries rather than providing raw data. In this set of notes, we will examine how we can fit a regression model to summaries of the data, rather than to the raw data itself.\n\n<!-- - [[CSV]](https://raw.githubusercontent.com/zief0002/pensive-giraffe/main/data/states-2019.csv) -->\n- [[R Script File]](https://raw.githubusercontent.com/zief0002/redesigned-adventure/main/scripts/03-01-regression-from-summary-measures.R).R)\n\n\n\nSo long as we have certain statistical information we can compute the regression coefficients and standard errors without having the raw data. To do this, we need the sample size, means, standard deviations, and correlations between variables. For example, consider the following summary table:\n\n\n::: {.cell layout-align=\"center\" tbl-cap='Correlation matrix for five attributes measured on *n* = 1,000 students. Means (standard deviations) for each attribute are provided on the main diagonal.'}\n::: {.cell-output-display}\n`````{=html}\n<table style='width:60%; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;' class=\" lightable-classic\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;text-align: center;\"> Measure </th>\n   <th style=\"text-align:center;text-align: center;\"> 1. </th>\n   <th style=\"text-align:center;text-align: center;\"> 2. </th>\n   <th style=\"text-align:center;text-align: center;\"> 3. </th>\n   <th style=\"text-align:center;text-align: center;\"> 4. </th>\n   <th style=\"text-align:center;text-align: center;\"> 5. </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1. Achievement </td>\n   <td style=\"text-align:center;\"> 50 (10) </td>\n   <td style=\"text-align:center;\"> --- </td>\n   <td style=\"text-align:center;\"> --- </td>\n   <td style=\"text-align:center;\"> --- </td>\n   <td style=\"text-align:center;\"> --- </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2. Ability </td>\n   <td style=\"text-align:center;\"> 0.737 </td>\n   <td style=\"text-align:center;\"> 100 (15) </td>\n   <td style=\"text-align:center;\"> --- </td>\n   <td style=\"text-align:center;\"> --- </td>\n   <td style=\"text-align:center;\"> --- </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3. Motivation </td>\n   <td style=\"text-align:center;\"> 0.255 </td>\n   <td style=\"text-align:center;\"> 0.205 </td>\n   <td style=\"text-align:center;\"> 50 (10) </td>\n   <td style=\"text-align:center;\"> --- </td>\n   <td style=\"text-align:center;\"> --- </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4. Previous Coursework </td>\n   <td style=\"text-align:center;\"> 0.615 </td>\n   <td style=\"text-align:center;\"> 0.498 </td>\n   <td style=\"text-align:center;\"> 0.375 </td>\n   <td style=\"text-align:center;\"> 4 (2) </td>\n   <td style=\"text-align:center;\"> --- </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5. Family Background </td>\n   <td style=\"text-align:center;\"> 0.417 </td>\n   <td style=\"text-align:center;\"> 0.417 </td>\n   <td style=\"text-align:center;\"> 0.190 </td>\n   <td style=\"text-align:center;\"> 0.372 </td>\n   <td style=\"text-align:center;\"> 0 (1) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nSay we wanted to use this information to fit a regression model to predict variation in achievement using the other four predictors. Mathematically,\n\n$$\n\\begin{split}\n\\mathrm{Achievement}_i = &\\beta_0 + \\beta_1(\\mathrm{Ability}_i) + \\beta_2(\\mathrm{Motivation}_i) + \\\\\n&\\beta_3(\\mathrm{Coursework~}_i) + \\beta_4(\\mathrm{Family~Background}_i) + \\epsilon_i\n\\end{split}\n$$\n\nTo do this we are going to create the correlation matrix, the vector of attribute means, and the vector of attribute standard deviations.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Create correlation matrix\ncorrs = matrix(\n  data = c(\n    1.000, 0.737, 0.255, 0.615, 0.417,\n    0.737, 1.000, 0.205, 0.498, 0.417,\n    0.255, 0.205, 1.000, 0.375, 0.190,\n    0.615, 0.498, 0.375, 1.000, 0.372,\n    0.417, 0.417, 0.190, 0.372, 1.000\n  ),\n  nrow = 5\n)\n\n# View correlation matrix\ncorrs\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1]  [,2]  [,3]  [,4]  [,5]\n[1,] 1.000 0.737 0.255 0.615 0.417\n[2,] 0.737 1.000 0.205 0.498 0.417\n[3,] 0.255 0.205 1.000 0.375 0.190\n[4,] 0.615 0.498 0.375 1.000 0.372\n[5,] 0.417 0.417 0.190 0.372 1.000\n```\n:::\n\n```{.r .cell-code}\n# Create mean vector\nmeans = c(50, 100, 50, 4, 0)\n\n# Create sd vector\nsds = c(10, 15, 10, 2, 1)\n\n# Set sample size\nn = 1000\n```\n:::\n\n\n<br />\n\n\n# Computing Regression Coefficients from Summary Data\n\nTo compute the coefficients from raw data, recall that we solve the normal equations based on:\n\n$$\n\\mathbf{X}^\\intercal\\mathbf{Xb} = \\mathbf{X}^\\intercal\\mathbf{y}\n$$\n\nRecall that if we mean center the variables in a regression analysis, the coefficients for this set of predictors would be exactly the same as if we used the raw predictors. (The intercept would differ, but ignore that for now.) That is if we solved the normal equations based on\n\n$$\n\\mathbf{X}_{\\mathrm{Dev}}^\\intercal\\mathbf{X}_{\\mathrm{Dev}}\\mathbf{b} = \\mathbf{X}_{\\mathrm{Dev}}^\\intercal\\mathbf{y}_{\\mathrm{Dev}}\n$$\n\nthe elements of **b** associated with the predictors in this set of equations would be the same as those from solving for **b** in $\\mathbf{X}^\\intercal\\mathbf{Xb} = \\mathbf{X}^\\intercal\\mathbf{y}$. \n\nSo, if our goal is to find the coefficients associated with the predictors, it doesn't matter if we use the raw or mean centered predictors. This is useful since there is a direct relationship between the $\\mathbf{X}_{\\mathrm{Dev}}^\\intercal\\mathbf{X}_{\\mathrm{Dev}}$ matrix and the variance-covariance matrix of the raw predictors:\n\n$$\n\\mathrm{Cov}(X,X) = \\frac{\\mathbf{X}_{\\mathrm{Dev}}^\\intercal\\mathbf{X}_{\\mathrm{Dev}}}{n-1}\n$$\n\nSimilarly, there is a direct relationship between the $\\mathbf{X}_{\\mathrm{Dev}}^\\intercal\\mathbf{y}_{\\mathrm{Dev}}$ matrix and the vector of covariances between the raw predictors and the raw outcome:\n\n$$\n\\mathrm{Cov}(X,y) = \\frac{\\mathbf{X}_{\\mathrm{Dev}}^\\intercal\\mathbf{y}_{\\mathrm{Dev}}}{n-1}\n$$\n\nThis means we can write our second set of normal equations (using the mean centered variables) as:\n\n$$\n\\begin{split}\n\\mathbf{X}_{\\mathrm{Dev}}^\\intercal\\mathbf{X}_{\\mathrm{Dev}}\\mathbf{b} &= \\mathbf{X}_{\\mathrm{Dev}}^\\intercal\\mathbf{y}_{\\mathrm{Dev}} \\\\[1em]\n\\mathrm{Cov}(X,X) (n-1)\\mathbf{b} &= \\mathrm{Cov}(X,y)(n-1) \\\\[1em]\n\\mathrm{Cov}(X,X) \\mathbf{b} &= \\mathrm{Cov}(X,y)\n\\end{split}\n$$\n\nWhich we can use to solve for **b**:\n\n$$\n\\mathbf{b} = \\mathrm{Cov}(X,X)^{-1}\\mathrm{Cov}(X,y)\n$$\n\n<br />\n\n\n## Going From the Correlations to Covariances\n\nThe summary measures we have give correlations, not covariances. However, it is quite easy to convert a correlation matrix to a covariance matrix. From the chapter [Statistical Application: SSCP, Varianceâ€“Covariance, and Correlation Matrices](https://zief0002.github.io/matrix-algebra/statistical-application-sscp-variancecovariance-and-correlation-matrices.html) in *Matrix Algebra for Educational Scientists*, know that:\n\n$$\n\\mathbf{R} = \\mathbf{S} \\boldsymbol\\Sigma \\mathbf{S}\n$$\n\nwhere **R** is the correlation matrix, $\\boldsymbol\\Sigma$ is the covariance matrix, and **S** is a diagonal scaling matrix with diagonal elements equal to the reciprocal of the standard deviations of each of the variables in the covariance matrix. Re-arranging this:\n\n$$\n\\boldsymbol\\Sigma = \\mathbf{S}^{-1} \\mathbf{R} \\mathbf{S}^{-1}\n$$\n\nRecall that the inverse of a diagonal matrix is another diagonal matrix where the diagonal elements are the resciprocals of the original. Thus the diagonal elements of the inverse of our scaling matrix will be the standard deviations of the variables. Using this formula, we can now convert the given correlation matrix to a covariance matrix.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Compute the scaling matrix S^(-1)\nS_inv = diag(sds)\nS_inv\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3] [,4] [,5]\n[1,]   10    0    0    0    0\n[2,]    0   15    0    0    0\n[3,]    0    0   10    0    0\n[4,]    0    0    0    2    0\n[5,]    0    0    0    0    1\n```\n:::\n\n```{.r .cell-code}\n# Compute covariance matrix\ncovs = S_inv %*% corrs %*% S_inv\ncovs\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       [,1]    [,2]   [,3]   [,4]  [,5]\n[1,] 100.00 110.550  25.50 12.300 4.170\n[2,] 110.55 225.000  30.75 14.940 6.255\n[3,]  25.50  30.750 100.00  7.500 1.900\n[4,]  12.30  14.940   7.50  4.000 0.744\n[5,]   4.17   6.255   1.90  0.744 1.000\n```\n:::\n:::\n\n\nAdding in the row and column names:\n\n\n\n::: {.cell layout-align=\"center\" tbl-cap='Variance-covariance matrix for five attributes measured on *n* = 1,000 students.'}\n::: {.cell-output-display}\n`````{=html}\n<table style='width:80%; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;' class=\" lightable-classic\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;text-align: center;\">   </th>\n   <th style=\"text-align:left;text-align: center;\"> Achievement </th>\n   <th style=\"text-align:center;text-align: center;\"> Ability </th>\n   <th style=\"text-align:center;text-align: center;\"> Motivation </th>\n   <th style=\"text-align:center;text-align: center;\"> Previous.Coursework </th>\n   <th style=\"text-align:center;text-align: center;\"> Family.Background </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Achievement </td>\n   <td style=\"text-align:left;\"> 100.00 </td>\n   <td style=\"text-align:center;\"> 110.550 </td>\n   <td style=\"text-align:center;\"> 25.50 </td>\n   <td style=\"text-align:center;\"> 12.300 </td>\n   <td style=\"text-align:center;\"> 4.170 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ability </td>\n   <td style=\"text-align:left;\"> 110.55 </td>\n   <td style=\"text-align:center;\"> 225.000 </td>\n   <td style=\"text-align:center;\"> 30.75 </td>\n   <td style=\"text-align:center;\"> 14.940 </td>\n   <td style=\"text-align:center;\"> 6.255 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Motivation </td>\n   <td style=\"text-align:left;\"> 25.50 </td>\n   <td style=\"text-align:center;\"> 30.750 </td>\n   <td style=\"text-align:center;\"> 100.00 </td>\n   <td style=\"text-align:center;\"> 7.500 </td>\n   <td style=\"text-align:center;\"> 1.900 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Previous Coursework </td>\n   <td style=\"text-align:left;\"> 12.30 </td>\n   <td style=\"text-align:center;\"> 14.940 </td>\n   <td style=\"text-align:center;\"> 7.50 </td>\n   <td style=\"text-align:center;\"> 4.000 </td>\n   <td style=\"text-align:center;\"> 0.744 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Family Background </td>\n   <td style=\"text-align:left;\"> 4.17 </td>\n   <td style=\"text-align:center;\"> 6.255 </td>\n   <td style=\"text-align:center;\"> 1.90 </td>\n   <td style=\"text-align:center;\"> 0.744 </td>\n   <td style=\"text-align:center;\"> 1.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n<br />\n\nRemember, the diagonal elements in the covariance matrix are variances of each variable and the off-diagonal elements are the covariances between two variables. For example, the first diagonal element is 100, which is the variance of the achievement variable. The remaining elements in the first column indicate the covariances between achievement and ability, achievement and motivation, achievement and previous coursework, and achievement and family background.\n\n<br />\n\n\n## Finding the Predictor Coefficients\n\nTo compute the coefficients for the predictors, we need to obtain two things:\n\n- Cov(X, X): The variance-covariance matrix of the predictors, and\n- Cov(X, y): The vector that contains the covariances between the outcome and each predictor. (Note: This vector does not include the variance of the outcome, only the covariances with the predictors.)\n\nIn our example, the elements in the first column (or row) of the variance-covariance matrix *other than the variance of the outcome* are the values in the vector Cov(X, y). The elements in the other rows/columns make up the elements of the Cov(X, X) matrix.\n\n\n::: {.cell layout-align=\"center\" tbl-cap='Variance-covariance matrix for five attributes measured on n = 1,000 students.'}\n::: {.cell-output-display}\n`````{=html}\n<table style='width:80%; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;' class=\" lightable-classic\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;text-align: center;\">   </th>\n   <th style=\"text-align:left;text-align: center;\"> Achievement </th>\n   <th style=\"text-align:center;text-align: center;\"> Ability </th>\n   <th style=\"text-align:center;text-align: center;\"> Motivation </th>\n   <th style=\"text-align:center;text-align: center;\"> Previous.Coursework </th>\n   <th style=\"text-align:center;text-align: center;\"> Family.Background </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;color: #222222 !important;\"> Achievement </td>\n   <td style=\"text-align:left;color: #0072b2 !important;color: #222222 !important;\"> 100.00 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;color: #222222 !important;\"> 110.550 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;color: #222222 !important;\"> 25.50 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;color: #222222 !important;\"> 12.300 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;color: #222222 !important;\"> 4.170 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ability </td>\n   <td style=\"text-align:left;color: #0072b2 !important;\"> 110.55 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 225.000 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 30.75 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 14.940 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 6.255 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Motivation </td>\n   <td style=\"text-align:left;color: #0072b2 !important;\"> 25.50 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 30.750 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 100.00 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 7.500 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 1.900 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Previous Coursework </td>\n   <td style=\"text-align:left;color: #0072b2 !important;\"> 12.30 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 14.940 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 7.50 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 4.000 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 0.744 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Family Background </td>\n   <td style=\"text-align:left;color: #0072b2 !important;\"> 4.17 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 6.255 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 1.90 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 0.744 </td>\n   <td style=\"text-align:center;color: #cc79a7 !important;\"> 1.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n<br />\n\nHere the blue elements compose Cov(X, y) and the reddish-purple elements constitute Cov(X, X). We can create this vector and matrix using indexing.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Create Cov(X, y)\ncov_xy = covs[-1 , 1]\ncov_xy\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 110.55  25.50  12.30   4.17\n```\n:::\n\n```{.r .cell-code}\n# Create Cov(X, X)\ncov_xx = covs[-1 , -1]\ncov_xx\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        [,1]   [,2]   [,3]  [,4]\n[1,] 225.000  30.75 14.940 6.255\n[2,]  30.750 100.00  7.500 1.900\n[3,]  14.940   7.50  4.000 0.744\n[4,]   6.255   1.90  0.744 1.000\n```\n:::\n:::\n\n\n\nThen we can use these to compute the predictor coefficients.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Compute predictor coefficients\nb = solve(cov_xx) %*% cov_xy\nb\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           [,1]\n[1,] 0.36737330\n[2,] 0.01257721\n[3,] 1.55001342\n[4,] 0.69497334\n```\n:::\n:::\n\n\nThus the coefficient estimates are:\n\n- $\\hat\\beta_{\\mathrm{Ability}} = 0.367$\n- $\\hat\\beta_{\\mathrm{Motivation}} = 0.013$\n- $\\hat\\beta_{\\mathrm{Previous~Coursework}} = 1.550$\n- $\\hat\\beta_{\\mathrm{Family~Background}} = 0.695$\n\n<br />\n\n\n## Computing the Intercept\n\nTo compute the intercept, we can use the following:\n\n$$\n\\hat\\beta_0 = \\bar{y} - \\bar{\\mathbf{x}}^\\intercal\\mathbf{b}\n$$\n\nwhere $\\bar{y}$ is the mean of the outcome, $\\bar{\\mathbf{x}}$ is the vector of predictor means, and **b** is the associated vector of predictor coefficients.\n\nIn our example,\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Compute intercept\nb_0 = means[1] - t(means[2:5]) %*% b\nb_0\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         [,1]\n[1,] 6.433756\n```\n:::\n:::\n\n\nThus the fitted equation for the unstandardized model is:\n\n$$\n\\begin{split}\n\\widehat{\\mathrm{Achievement}_i} = &6.434 + 0.367(\\mathrm{Ability}_i) + 0.013(\\mathrm{Motivation}_i) + \\\\\n&1.550(\\mathrm{Coursework~}_i) + 0.695(\\mathrm{Family~Background}_i)\n\\end{split}\n$$\n\n<br />\n\n\n# Standard Errors for the Coefficients\n\nUsing the raw data, we estimated the standard error for the coefficients by taking the square root of the diagonal elements of the variance-covariance matrix of the coefficients, where the the variance-covariance matrix of the coefficients was computed as:\n\n$$\n\\hat\\sigma^2_{e} (\\mathbf{X}^\\intercal\\mathbf{X})^{-1}\n$$\n\nWe can use the summary values we have to also obtain the $\\hat\\sigma^2_{e}$ estimate and to compute the elements of the $\\mathbf{X}^\\intercal\\mathbf{X}$ matrix.\n\n<br />\n\nThe estimate of the residual variance is found using:\n\n$$\n\\hat\\sigma^2_{e} = \\hat\\sigma^2_y (1 - R^2_{\\mathrm{Adj}})\n$$\n\nwhere $\\hat\\sigma^2_y$ is the variance of the outcome and $R^2_{\\mathrm{Adj}}$ is the Adjusted $R^2$ value which is found using:\n\n$$\nR^2_{\\mathrm{Adj}} = 1 - \\frac{\\mathrm{df}_{\\mathrm{Total}}}{\\mathrm{df}_{\\mathrm{Residual}}}(1 -R^2)\n$$\n\nTo find the $R^2$ value, we can invert the correlation matrix and compute one minus the reciprocal of the diagonal elements of this inverted matrix. The results are the $R^2$ values for the given term as an outcome variable and all other terms in the correlation matrix as predictors.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Invert correlation matrix\ncorr_inv = solve(corrs)\n\n# Compute the R2 values\nr2 = 1 - 1/diag(corr_inv)\nr2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6289704 0.5591756 0.1439290 0.4421816 0.2201437\n```\n:::\n:::\n\n\nHere the $R^2$ value from regressing achievement on all the other variables in the correlation matrix (e.g., ability, motivation, previous coursework, and family background) is 0.629. We can then use this to compute adjusted $R^2$ and subsequently use that to compute $\\hat\\sigma^2_y$.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Compute adjusted R2\nr2_adj = 1 - (999 / 995) * (1 - r2[1])\nr2_adj\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6274788\n```\n:::\n\n```{.r .cell-code}\n# Compute estimated residual variance\ns2_e = sds[1]^2 * (1 - r2_adj)\ns2_e\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 37.25212\n```\n:::\n:::\n\n\nOur estimate for $\\hat\\sigma^2_y$ is 37.25.\n\n<br />\n\n\n## Compute $\\mathbf{X}^\\intercal\\mathbf{X}$ Matrix\n\nThe elements in the first row and column of the $\\mathbf{X}^\\intercal\\mathbf{X}$ matrix are functions of the sample size and means of the predictor variables. Namely the first element in the first row and column is *n* and the remaining elements in the that row and column are created as $n\\mathbf{M_x}$, where *n* is the sample size, and $\\mathbf{M_x}$ is the vector of predictor means. The remaining elements constitute a submatrix defined as:\n\n$$\n(\\mathbf{X}^\\intercal\\mathbf{X})_{\\mathrm{Sub}} = (n-1)\\mathrm{Cov}(X,X) + n(\\mathbf{M_x})(\\mathbf{M_x}^\\intercal)\n$$\n\nwhere *n* is the sample size, Cov(X,X) is the variance covariance matrix ofthe predictors, and $\\mathbf{M_x}$ is again the vector of predictor means. We cn then create the $\\mathbf{X}^\\intercal\\mathbf{X}$ matrix as:\n\n$$\n\\require{color}\n\\begin{split}\n\\mathbf{X}^\\intercal\\mathbf{X} &= \\begin{bmatrix}{\\color[rgb]{0.044147,0.363972,0.636955}n} & {\\color[rgb]{0.044147,0.363972,0.636955}n\\mathbf{M_x}}\\\\{\\color[rgb]{0.044147,0.363972,0.636955}n\\mathbf{M_x}} & {\\color[rgb]{0.748052,0.381230,0.589698}(\\mathbf{X}^\\intercal\\mathbf{X})_{\\mathrm{Sub}}}\\end{bmatrix}\n \\\\[2ex]\n&= \\begin{bmatrix}{\\color[rgb]{0.044147,0.363972,0.636955}n} & {\\color[rgb]{0.044147,0.363972,0.636955}n\\overline{X1}} & {\\color[rgb]{0.044147,0.363972,0.636955}n\\overline{X2}} &  {\\color[rgb]{0.044147,0.363972,0.636955}n\\overline{X3}} & {\\color[rgb]{0.044147,0.363972,0.636955}\\ldots} & {\\color[rgb]{0.044147,0.363972,0.636955}n\\overline{Xk}}\\\\ {\\color[rgb]{0.044147,0.363972,0.636955}n\\overline{X1}} & & & & &  \\\\ {\\color[rgb]{0.044147,0.363972,0.636955}n\\overline{X2}} & & & & &  \\\\ {\\color[rgb]{0.044147,0.363972,0.636955}n\\overline{X3}} & & & {\\color[rgb]{0.748052,0.381230,0.589698}(\\mathbf{X}^\\intercal\\mathbf{X})_{\\mathrm{Sub}}} & &  \\\\ {\\color[rgb]{0.044147,0.363972,0.636955}\\vdots} & & & & &  \\\\ {\\color[rgb]{0.044147,0.363972,0.636955}n\\overline{Xk}} & & & & &   \\end{bmatrix}\n\\end{split}\n$$\n\nTo create this matrix using R, we will:\n\n1. Compute the submatrix $(\\mathbf{X}^\\intercal\\mathbf{X})_{\\mathrm{Sub}}$.\n2. Bind the $n\\mathbf{M_x}$ vector to the top of the submatrix.\n3. Bind the vector that contains *n* and $n\\mathbf{M_x}$ to the left of the resulting matrix from Step 2.\n\nThe resulting matrix is the $\\mathbf{X}^\\intercal\\mathbf{X}$ matrix. For our example,\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Step 1: Create submatrix\nsub_mat = 999 * cov_xx + 1000 * means[2:5] %*% t(means[2:5])\nsub_mat\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             [,1]      [,2]       [,3]     [,4]\n[1,] 10224775.000 5030719.2 414925.060 6248.745\n[2,]  5030719.250 2599900.0 207492.500 1898.100\n[3,]   414925.060  207492.5  19996.000  743.256\n[4,]     6248.745    1898.1    743.256  999.000\n```\n:::\n\n```{.r .cell-code}\n# Step 2: Bind n(M_x) to top of submatrix\nmat_2 = rbind(1000 * means[2:5], sub_mat)\nmat_2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             [,1]      [,2]       [,3]     [,4]\n[1,]   100000.000   50000.0   4000.000    0.000\n[2,] 10224775.000 5030719.2 414925.060 6248.745\n[3,]  5030719.250 2599900.0 207492.500 1898.100\n[4,]   414925.060  207492.5  19996.000  743.256\n[5,]     6248.745    1898.1    743.256  999.000\n```\n:::\n\n```{.r .cell-code}\n# Step 3: Bind vector to left of Step 2 matrix\nXtX = cbind(c(1000, 1000 * means[2:5]), mat_2)\nXtX\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       [,1]         [,2]      [,3]       [,4]     [,5]\n[1,]   1000   100000.000   50000.0   4000.000    0.000\n[2,] 100000 10224775.000 5030719.2 414925.060 6248.745\n[3,]  50000  5030719.250 2599900.0 207492.500 1898.100\n[4,]   4000   414925.060  207492.5  19996.000  743.256\n[5,]      0     6248.745    1898.1    743.256  999.000\n```\n:::\n:::\n\n\nWe can then scale this matrix using our previous estimate of the residual variance to obtain the variance-covariance matrix for the coefficients and compute the coefficient standard errors.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Compute var-cov matrix of b\ncov_b = s2_e * solve(XtX)\ncov_b\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            [,1]            [,2]            [,3]         [,4]          [,5]\n[1,]  2.86183238 -0.021078176856 -0.018522600965  0.052341868  0.1280945885\n[2,] -0.02107818  0.000240314903 -0.000001964506 -0.000713772 -0.0009683908\n[3,] -0.01852260 -0.000001964506  0.000435428791 -0.000763097 -0.0002472826\n[4,]  0.05234187 -0.000713772031 -0.000763096999  0.014297546 -0.0047228461\n[5,]  0.12809459 -0.000968390764 -0.000247282552 -0.004722846  0.0473303248\n```\n:::\n\n```{.r .cell-code}\n# Compute SEs\nse = sqrt(diag(cov_b))\nse\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.69169512 0.01550209 0.02086693 0.11957235 0.21755534\n```\n:::\n:::\n\n\nThese are the standard errors for the intercept and each predictor. Here I add the coefficients and standard errors to a data frame and use them to compute *t*-values, associated *p*-values, and confidence intervals.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Load library\nlibrary(tidyverse)\n\n# Create regression table\ndata.frame(\n  Predictor = c(\"Intercept\", \"Ability\", \"Motivation\", \"Previous Coursework\", \"Family Background\"),\n  B = c(b_0, b),\n  SE = se\n) |>\n  mutate(\n    t = round(B /SE, 3),\n    p = round(2 * pt(-abs(t), df = 995), 5),\n    CI = paste0(\"(\", round(B + qt(.025, df = 995)*SE, 3), \", \", round(B + qt(.975, df = 995)*SE, 3), \")\")\n  )\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Predictor\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"B\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"t\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Intercept\",\"2\":\"6.43375597\",\"3\":\"1.69169512\",\"4\":\"3.803\",\"5\":\"0.00015\",\"6\":\"(3.114, 9.753)\"},{\"1\":\"Ability\",\"2\":\"0.36737330\",\"3\":\"0.01550209\",\"4\":\"23.698\",\"5\":\"0.00000\",\"6\":\"(0.337, 0.398)\"},{\"1\":\"Motivation\",\"2\":\"0.01257721\",\"3\":\"0.02086693\",\"4\":\"0.603\",\"5\":\"0.54665\",\"6\":\"(-0.028, 0.054)\"},{\"1\":\"Previous Coursework\",\"2\":\"1.55001342\",\"3\":\"0.11957235\",\"4\":\"12.963\",\"5\":\"0.00000\",\"6\":\"(1.315, 1.785)\"},{\"1\":\"Family Background\",\"2\":\"0.69497334\",\"3\":\"0.21755534\",\"4\":\"3.194\",\"5\":\"0.00145\",\"6\":\"(0.268, 1.122)\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n<br />\n\n\n# Standardized Regression from Summaries\n\nWe can also compute pertinent values from the standardized regression coefficients in a similar manner; in fact it is easier since there is no intercept to compute in a standardized regression. In a standardized regression, the coefficients are based on the centered and scaled data. Similarly, the correlation matrix is a scaled version of the covariance matrix (which represents the centered data). This allows us to also use the correlation matrices in the set of normal equations:\n\n$$\n\\mathrm{Cor}(X,X)\\mathbf{b^*} = \\mathrm{Cor}(X,y)\n$$\n\nHere we use the notation $\\mathbf{b^*}$ to differentiate these predictor estimates from the unstandardized estimates. We can solve this for $\\mathbf{b^*}$:\n\n$$\n\\mathbf{b^*} = \\mathrm{Cor}(X,X)^{-1}\\mathrm{Cor}(X,y)\n$$\n\n\nThis reminds us that the regression coefficients in a standardized regression are correlations (or partial correlations in the multiple regression) between a predictor and the outcome. Here we us the original correlation matrix to compute the standardized regression coefficients:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Compute standardized coefficients\nb_star = solve(corrs[-1 , -1]) %*% corrs[1 , 2:5]\nb_star\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           [,1]\n[1,] 0.55105995\n[2,] 0.01257721\n[3,] 0.31000268\n[4,] 0.06949733\n```\n:::\n:::\n\n\nWriting the fitted equation:\n\n$$\n\\begin{split}\n\\hat{z}_{\\mathrm{Achievement}_i} = &0.551(z_{\\mathrm{Ability}_i}) + 0.012(z_{\\mathrm{Motivation}_i}) + \\\\\n&0.310(z_{\\mathrm{Coursework~}_i}) + 0.069(z_{\\mathrm{Family~Background}_i})\n\\end{split}\n$$\n\nWe can also compute the associated standard errors using the following:\n\n$$\n\\mathrm{SE}_{\\mathrm{Std}} = \\mathrm{SE}_{\\mathrm{Unstd}} \\bigg(\\frac{b_{\\mathrm{Unstd}}}{b_{\\mathrm{Std}}}\\bigg)\n$$\n\nIn our example,\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Compute SEs\nse[-1] * b_star / b\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           [,1]\n[1,] 0.02325314\n[2,] 0.02086693\n[3,] 0.02391447\n[4,] 0.02175553\n```\n:::\n:::\n\n\nHere we had to remove the first element in the `se` object since it was related to the intercept. Using the estimates from the standardized regresion, the *t*-values and associated *p*-values are identical to those from the standardized model. In practice, if you are reporting standardized coefficients, it is typical to report the unstandardized estimates and standard errors, the standardized estimates, and the *t*- and *p*-values.\n\n\n::: {.cell layout-align=\"center\" tbl-cap='Unstandardized and standardized regression coefficients for fitting a model to predict variation in student achievement for n = 1,000 students.'}\n::: {.cell-output-display}\n`````{=html}\n<table style='width:60%; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;' class=\" lightable-classic\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;text-align: center;\"> Predictor </th>\n   <th style=\"text-align:center;text-align: center;\"> <i>B</i> </th>\n   <th style=\"text-align:center;text-align: center;\"> <i>SE</i> </th>\n   <th style=\"text-align:center;text-align: center;\"> Std. <i>B</i> </th>\n   <th style=\"text-align:center;text-align: center;\"> <i>t</i> </th>\n   <th style=\"text-align:center;text-align: center;\"> <i>p</i> </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Ability </td>\n   <td style=\"text-align:center;\"> 0.37 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> 0.551 </td>\n   <td style=\"text-align:center;\"> 18.50 </td>\n   <td style=\"text-align:center;\"> 0.00000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Motivation </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> 0.013 </td>\n   <td style=\"text-align:center;\"> 0.50 </td>\n   <td style=\"text-align:center;\"> 0.61719 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Previous Coursework </td>\n   <td style=\"text-align:center;\"> 1.55 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 0.310 </td>\n   <td style=\"text-align:center;\"> 12.92 </td>\n   <td style=\"text-align:center;\"> 0.00000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Family Background </td>\n   <td style=\"text-align:center;\"> 0.69 </td>\n   <td style=\"text-align:center;\"> 0.22 </td>\n   <td style=\"text-align:center;\"> 0.069 </td>\n   <td style=\"text-align:center;\"> 3.14 </td>\n   <td style=\"text-align:center;\"> 0.00174 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Intercept </td>\n   <td style=\"text-align:center;\"> 6.43 </td>\n   <td style=\"text-align:center;\"> 1.69 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 3.80 </td>\n   <td style=\"text-align:center;\"> 0.00015 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<span style=\"font-style: italic;\">Note: </span> <sup></sup> R-squared =0.629; Residual Standard Error = 6.10</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n<br />\n\n\n# Simulating Data Using Summary Values\n\nWe can also simulate a set of data that mimics the correlation matrix, means, and standard deviations that were reported in the summaries. To do this, we need to make an assumption that the variables are all multivariately normally distributed. If we make this strong assumption, then we can simulate using the `mvrnorm()` function from the `{MASS}` package. In this function we need to provide the sample size, the vector of means (for the outcome and predictors), and the variance-covariance matrix of all the variables.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nMASS::mvrnorm(n = 1000, mu = means, Sigma = covs)\n```\n:::\n\n\n\nThis will draw a sample from a population where the variables have those means and variance-covariance matrix. This means that the data we draw will likely not have the same means, SDs, or correlations. If we want the data to reproduce the summary values exactly, we add the argument `empirical=TRUE`. Here we do this and assign the data to the `sim_dat` object\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Set seed for reproducibility\nset.seed(1)\n\n# Simulate the data\nsim_dat = MASS::mvrnorm(n = 1000, mu = means, Sigma = covs, empirical = TRUE)\n```\n:::\n\n\nThis is a matrix object, so we convert it to a data frame and also assign column names so the data are easier to use in our functions.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Convert to data frame\nsim_dat = data.frame(sim_dat)\n\n# Change column names\nnames(sim_dat) = c(\"achieve\", \"ability\", \"motivation\", \"coursework\", \"fam_back\")\n\n# View data\nhead(sim_dat)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"achieve\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ability\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"motivation\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"coursework\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fam_back\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"48.88586\",\"2\":\"102.37781\",\"3\":\"38.93417\",\"4\":\"3.083245\",\"5\":\"-1.6098535\",\"_rn_\":\"1\"},{\"1\":\"42.18020\",\"2\":\"89.24882\",\"3\":\"31.89290\",\"4\":\"4.330611\",\"5\":\"-0.6601947\",\"_rn_\":\"2\"},{\"1\":\"58.85591\",\"2\":\"104.00995\",\"3\":\"50.52801\",\"4\":\"2.200933\",\"5\":\"1.1386242\",\"_rn_\":\"3\"},{\"1\":\"59.11396\",\"2\":\"120.42658\",\"3\":\"64.54716\",\"4\":\"7.279797\",\"5\":\"0.1060942\",\"_rn_\":\"4\"},{\"1\":\"47.21073\",\"2\":\"106.45108\",\"3\":\"65.29760\",\"4\":\"5.073872\",\"5\":\"-1.2985168\",\"_rn_\":\"5\"},{\"1\":\"54.01036\",\"2\":\"89.79483\",\"3\":\"52.66398\",\"4\":\"2.396018\",\"5\":\"0.6197709\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nNow we can check that the summaries are being reproduced.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Compute means and SDs\nsim_dat |>\n  summarize(\n    across(.cols = everything(), .fns = list(Mean = mean, SD = sd))\n  ) |>\n  round(3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"achieve_Mean\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"achieve_SD\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ability_Mean\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ability_SD\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"motivation_Mean\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"motivation_SD\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"coursework_Mean\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"coursework_SD\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fam_back_Mean\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fam_back_SD\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"50\",\"2\":\"10\",\"3\":\"100\",\"4\":\"15\",\"5\":\"50\",\"6\":\"10\",\"7\":\"4\",\"8\":\"2\",\"9\":\"0\",\"10\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Compute correlation matrix\nsim_dat |>\n  corrr::correlate()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"achieve\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ability\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"motivation\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"coursework\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fam_back\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"achieve\",\"2\":\"NA\",\"3\":\"0.737\",\"4\":\"0.255\",\"5\":\"0.615\",\"6\":\"0.417\"},{\"1\":\"ability\",\"2\":\"0.737\",\"3\":\"NA\",\"4\":\"0.205\",\"5\":\"0.498\",\"6\":\"0.417\"},{\"1\":\"motivation\",\"2\":\"0.255\",\"3\":\"0.205\",\"4\":\"NA\",\"5\":\"0.375\",\"6\":\"0.190\"},{\"1\":\"coursework\",\"2\":\"0.615\",\"3\":\"0.498\",\"4\":\"0.375\",\"5\":\"NA\",\"6\":\"0.372\"},{\"1\":\"fam_back\",\"2\":\"0.417\",\"3\":\"0.417\",\"4\":\"0.190\",\"5\":\"0.372\",\"6\":\"NA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nFinally, we should be able to reproduce the regression estimates we have computed.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Fit unstandardized model\nlm_unstd = lm(achieve ~ 1 + ability + motivation + coursework + fam_back, data = sim_dat)\n\n# Load broom library\nlibrary(broom)\n\n# Model-level output\nglance(lm_unstd) |>\n  print(width = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 Ã— 12\n  r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC\n      <dbl>         <dbl> <dbl>     <dbl>     <dbl> <dbl>  <dbl> <dbl> <dbl>\n1     0.629         0.627  6.10      422. 1.89e-212     4 -3225. 6463. 6492.\n  deviance df.residual  nobs\n     <dbl>       <int> <int>\n1   37066.         995  1000\n```\n:::\n\n```{.r .cell-code}\n# Coefficient-level output\ntidy(lm_unstd)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"6.43375597\",\"3\":\"1.69169512\",\"4\":\"3.8031415\",\"5\":\"1.515734e-04\"},{\"1\":\"ability\",\"2\":\"0.36737330\",\"3\":\"0.01550209\",\"4\":\"23.6983023\",\"5\":\"8.533216e-99\"},{\"1\":\"motivation\",\"2\":\"0.01257721\",\"3\":\"0.02086693\",\"4\":\"0.6027341\",\"5\":\"5.468229e-01\"},{\"1\":\"coursework\",\"2\":\"1.55001342\",\"3\":\"0.11957235\",\"4\":\"12.9629756\",\"5\":\"1.271593e-35\"},{\"1\":\"fam_back\",\"2\":\"0.69497334\",\"3\":\"0.21755534\",\"4\":\"3.1944670\",\"5\":\"1.444932e-03\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Standardized model\nsim_dat |>\n  scale() |>\n  data.frame() |>\n  lm(formula = achieve ~ 1 + ability + motivation + coursework + fam_back) |>\n  tidy() |>\n  filter(term != \"(Intercept)\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"ability\",\"2\":\"0.55105995\",\"3\":\"0.02325314\",\"4\":\"23.6983023\",\"5\":\"8.533216e-99\"},{\"1\":\"motivation\",\"2\":\"0.01257721\",\"3\":\"0.02086693\",\"4\":\"0.6027341\",\"5\":\"5.468229e-01\"},{\"1\":\"coursework\",\"2\":\"0.31000268\",\"3\":\"0.02391447\",\"4\":\"12.9629756\",\"5\":\"1.271593e-35\"},{\"1\":\"fam_back\",\"2\":\"0.06949733\",\"3\":\"0.02175553\",\"4\":\"3.1944670\",\"5\":\"1.444932e-03\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint/kePrint.js\"></script>\n<link href=\"../site_libs/lightable/lightable.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/pagedtable/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}